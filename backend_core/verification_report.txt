
*** SYSTEM VERIFICATION REPORT ***
DATE: 2026-01-03
TARGET: Student Resource Hub - Cognitive Core (Python Backend)

--------------------------------------------------------------------------------
SECTION A — VERIFIED FACTS
--------------------------------------------------------------------------------
1.  **ML Model is LIVE:**
    *   The API explicitly returns `"model_version": "v2-ml-sklearn"`.
    *   Inference is verified via `curl` tests returning correct intents (`problem_solving`, `concept_learning`).
    *   The heuristics are BYPASSED when the model is loaded (Logic: `if model:` block executes).

2.  **RAG Pipeline is IMPLEMENTED but UNTESTABLE:**
    *   **Verified:** The code (`engine.py`) correctly implements `get_embedding` (Vertex), `retrieve_context` (Firestore Vector), and `generate_response` (Gemini).
    *   **Unverified:** Actual execution fails due to `Unable to authenticate your request` (Expected in this environment without a service account key).
    *   **Conclusion:** The "plumbing" is correct, but the "water" (data) cannot flow until deployed to a Google Cloud environment with proper IAM roles.

--------------------------------------------------------------------------------
SECTION B — CONFIRMED ML BEHAVIOR
--------------------------------------------------------------------------------
*   **Input:** "debug my faulty loop code"
*   **Output:** `problem_solving` (Correct)
*   **Input:** "i am totally confused"
*   **Output:** `concept_learning` (Model Prediction) + `is_confused: true` (Rule-based augmentation)
*   **Input:** "unknowncontextxyz"
*   **Output:** `concept_learning` (Model Bias) -> *Risk: The model forces a classification even for nonsense. Needs a standard "Unknown" threshold.*

--------------------------------------------------------------------------------
SECTION C — RAG TRACE (PIN-TO-PIN)
--------------------------------------------------------------------------------
1.  **Incoming Request:** `POST /api/v1/chat/`
2.  **Auth:** `FirebaseAuthentication` verifies Token (ID Verified).
3.  **Intent Analysis:** `CognitiveEngine.analyze_intent(query)` -> Returns ML Prediction.
4.  **Embedding:** `CognitiveEngine.get_embedding(query)` -> *Fails locally (Auth)*.
5.  **Retrieval:** `Firestore.find_nearest` -> *Fails locally (Auth)*.
6.  **Generation:** `Gemini.generate_content` -> *Fails locally (Auth)*.

**Status:** LOGIC IS VALID. EXECUTION REQUIRES CLOUD.

--------------------------------------------------------------------------------
SECTION D — FAILURE MODE RESULTS
--------------------------------------------------------------------------------
1.  **Ambiguous Query:** Returns `concept_learning` by default (due to training data balance).
2.  **Short Query:** Works fine (`v2-ml-sklearn` handles it).
3.  **Low Confidence:** Currently hardcoded to `0.92` for the simulated model. In a real scenario, this should come from `model.predict_proba()`.

--------------------------------------------------------------------------------
SECTION E — RISKS & BOTTLENECKS
--------------------------------------------------------------------------------
1.  **Hardcoded Confidence:** The current simulated model returns a flat `0.92`. This mimics a high-confidence model but masks actual uncertainty.
2.  **Confusion Logic Split:** confusion detection is still Rule-Based (`if "confusing" in query`). This should eventually be moved to a Neural Network (LSTM/BERT).
3.  **Authentication Gap:** Local testing of RAG is impossible without a `service-account.json`. Deployment is the only way to verify end-to-end flow.

--------------------------------------------------------------------------------
SECTION F — NEXT REQUIRED ACTION
--------------------------------------------------------------------------------
**DECISION: A) RAG wiring is VERIFIED (Logic-wise)**

The logic is sound. Attempting to fix "Authentication" in this environment is futile and insecure (uploading keys is bad practice).

**Action:**
Integrate the Frontend. Point the Next.js app to the Python backend API.
Then, deploy the Python backend to Google Cloud Run where it will automatically inherit the necessary credentials.

*END OF REPORT*
