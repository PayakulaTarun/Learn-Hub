{
  "title": "Aggregation Pipeline",
  "slug": "mongodb-aggregation-pipeline",
  "subject": "MongoDB",
  "category": "NoSQL Database",
  "level": "Intermediate",
  "estimated_read_time": "30 mins",
  "prerequisites": [
    "MongoDB Aggregation Basics"
  ],
  "learning_objectives": [
    "Pipeline Concept",
    "$match, $group, $project",
    "$sort, $limit"
  ],
  "theory": "The Aggregation Pipeline is a framework for data aggregation modeled on the concept of data processing pipelines. Documents enter a multi-stage pipeline that transforms the documents into aggregated results.",
  "syntax": "db.coll.aggregate([ { $stage1 }, { $stage2 } ])",
  "examples": [
    {
      "code": "db.orders.aggregate([\n  { $match: { status: \"A\" } },\n  { $group: { _id: \"$cust_id\", total: { $sum: \"$amount\" } } }\n])",
      "output": "Total Amount per Customer (for status A)",
      "explanation": "First filters orders by status 'A', then groups by customer ID and sums the amount."
    }
  ],
  "common_mistakes": [
    {
      "mistake": "Placing $match after $group unnecessarily",
      "correction": "Always filter ($match) as early as possible to reduce the dataset size for subsequent stages.",
      "example": "Group all 1M docs then match vs Match 100 docs then group."
    }
  ],
  "interview_questions": [
    {
      "question": "Does the order of stages matter?",
      "answer": "Yes, absolutely. The output of one stage is the input to the next.",
      "difficulty": "Easy"
    }
  ],
  "practice_problems": [
    {
      "problem": "Calculate average age of users per city.",
      "difficulty": "Medium",
      "hint": "$group by city and use $avg.",
      "solution": "{ $group: { _id: '$city', avgAge: { $avg: '$age' } } }"
    }
  ],
  "real_world_use_cases": [
    {
      "scenario": "Analytics Dashboard",
      "description": "Daily sales reports generated by aggregating transaction logs.",
      "code": "$group by date"
    }
  ],
  "exam_notes": [
    "Pipeline = Array of stages.",
    "$group is like SQL GROUP BY.",
    "$project reshapes docs."
  ],
  "summary": "This is MongoDB's most powerful feature, enabling SQL-like complex queries."
}