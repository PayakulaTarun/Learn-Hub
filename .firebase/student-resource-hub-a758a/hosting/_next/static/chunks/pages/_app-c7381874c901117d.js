(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{9711:function(e,r,i){"use strict";i.d(r,{BH:function(){return Deferred},LL:function(){return ErrorFactory},ZR:function(){return FirebaseError},tV:function(){return base64Decode},L:function(){return base64urlEncodeWithoutPadding},Sg:function(){return createMockUserToken},ne:function(){return createSubscribe},vZ:function(){return deepEqual},pd:function(){return extractQuerystring},aH:function(){return getDefaultAppConfig},q4:function(){return getDefaultEmulatorHost},P0:function(){return getDefaultEmulatorHostnameAndPort},Pz:function(){return getExperimentalSetting},m9:function(){return getModularInstance},z$:function(){return getUA},ru:function(){return isBrowserExtension},Xx:function(){return isCloudWorkstation},L_:function(){return isCloudflareWorker},xb:function(){return isEmpty},w1:function(){return isIE},hl:function(){return isIndexedDBAvailable},uI:function(){return isMobileCordova},b$:function(){return isReactNative},G6:function(){return isSafari},Uo:function(){return pingServer},xO:function(){return querystring},zd:function(){return querystringDecode},dp:function(){return updateEmulatorBanner},eu:function(){return validateIndexedDBOpenable}});let getDefaultsFromPostinstall=()=>void 0;var o=i(3454);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let stringToByteArray$1=function(e){let r=[],i=0;for(let o=0;o<e.length;o++){let s=e.charCodeAt(o);s<128?r[i++]=s:(s<2048?r[i++]=s>>6|192:((64512&s)==55296&&o+1<e.length&&(64512&e.charCodeAt(o+1))==56320?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++o)),r[i++]=s>>18|240,r[i++]=s>>12&63|128):r[i++]=s>>12|224,r[i++]=s>>6&63|128),r[i++]=63&s|128)}return r},byteArrayToString=function(e){let r=[],i=0,o=0;for(;i<e.length;){let s=e[i++];if(s<128)r[o++]=String.fromCharCode(s);else if(s>191&&s<224){let l=e[i++];r[o++]=String.fromCharCode((31&s)<<6|63&l)}else if(s>239&&s<365){let l=e[i++],h=e[i++],d=e[i++],f=((7&s)<<18|(63&l)<<12|(63&h)<<6|63&d)-65536;r[o++]=String.fromCharCode(55296+(f>>10)),r[o++]=String.fromCharCode(56320+(1023&f))}else{let l=e[i++],h=e[i++];r[o++]=String.fromCharCode((15&s)<<12|(63&l)<<6|63&h)}}return r.join("")},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,r){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let i=r?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let r=0;r<e.length;r+=3){let s=e[r],l=r+1<e.length,h=l?e[r+1]:0,d=r+2<e.length,f=d?e[r+2]:0,_=s>>2,g=(3&s)<<4|h>>4,A=(15&h)<<2|f>>6,b=63&f;d||(b=64,l||(A=64)),o.push(i[_],i[g],i[A],i[b])}return o.join("")},encodeString(e,r){return this.HAS_NATIVE_SUPPORT&&!r?btoa(e):this.encodeByteArray(stringToByteArray$1(e),r)},decodeString(e,r){return this.HAS_NATIVE_SUPPORT&&!r?atob(e):byteArrayToString(this.decodeStringToByteArray(e,r))},decodeStringToByteArray(e,r){this.init_();let i=r?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let r=0;r<e.length;){let s=i[e.charAt(r++)],l=r<e.length,h=l?i[e.charAt(r)]:0;++r;let d=r<e.length,f=d?i[e.charAt(r)]:64;++r;let _=r<e.length,g=_?i[e.charAt(r)]:64;if(++r,null==s||null==h||null==f||null==g)throw new DecodeBase64StringError;let A=s<<2|h>>4;if(o.push(A),64!==f){let e=h<<4&240|f>>2;if(o.push(e),64!==g){let e=f<<6&192|g;o.push(e)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};let DecodeBase64StringError=class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};let base64Encode=function(e){let r=stringToByteArray$1(e);return s.encodeByteArray(r,!0)},base64urlEncodeWithoutPadding=function(e){return base64Encode(e).replace(/\./g,"")},base64Decode=function(e){try{return s.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==i.g)return i.g;throw Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(void 0===o||void 0===o.env)return;let e=o.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},getDefaultsFromCookie=()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let r=e&&base64Decode(e[1]);return r&&JSON.parse(r)},getDefaults=()=>{try{return getDefaultsFromPostinstall()||getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},getDefaultEmulatorHost=e=>getDefaults()?.emulatorHosts?.[e],getDefaultEmulatorHostnameAndPort=e=>{let r=getDefaultEmulatorHost(e);if(!r)return;let i=r.lastIndexOf(":");if(i<=0||i+1===r.length)throw Error(`Invalid host ${r} with no separate hostname and port!`);let o=parseInt(r.substring(i+1),10);return"["===r[0]?[r.substring(1,i-1),o]:[r.substring(0,i),o]},getDefaultAppConfig=()=>getDefaults()?.config,getExperimentalSetting=e=>getDefaults()?.[`_${e}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Deferred=class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,i)=>{r?this.reject(r):this.resolve(i),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(r):e(r,i))}}};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isCloudWorkstation(e){try{let r=e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e;return r.endsWith(".cloudworkstations.dev")}catch{return!1}}async function pingServer(e){let r=await fetch(e,{credentials:"include"});return r.ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(e,r){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let i=r||"demo-project",o=e.iat||0,s=e.sub||e.user_id;if(!s)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let l={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...e};return[base64urlEncodeWithoutPadding(JSON.stringify({alg:"none",type:"JWT"})),base64urlEncodeWithoutPadding(JSON.stringify(l)),""].join(".")}let l={};function getEmulatorSummary(){let e={prod:[],emulator:[]};for(let r of Object.keys(l))l[r]?e.emulator.push(r):e.prod.push(r);return e}function getOrCreateEl(e){let r=document.getElementById(e),i=!1;return r||((r=document.createElement("div")).setAttribute("id",e),i=!0),{created:i,element:r}}let h=!1;function updateEmulatorBanner(e,r){if("undefined"==typeof window||"undefined"==typeof document||!isCloudWorkstation(window.location.host)||l[e]===r||l[e]||h)return;function prefixedId(e){return`__firebase__banner__${e}`}l[e]=r;let i="__firebase__banner",o=getEmulatorSummary(),s=o.prod.length>0;function tearDown(){let e=document.getElementById(i);e&&e.remove()}function setupBannerStyles(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}function setupIconStyles(e,r){e.setAttribute("width","24"),e.setAttribute("id",r),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}function setupCloseBtn(){let e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{h=!0,tearDown()},e}function setupLinkStyles(e,r){e.setAttribute("id",r),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}function setupDom(){let e=getOrCreateEl(i),r=prefixedId("text"),o=document.getElementById(r)||document.createElement("span"),l=prefixedId("learnmore"),h=document.getElementById(l)||document.createElement("a"),d=prefixedId("preprendIcon"),f=document.getElementById(d)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){let r=e.element;setupBannerStyles(r),setupLinkStyles(h,l);let i=setupCloseBtn();setupIconStyles(f,d),r.append(f,o,h,i),document.body.appendChild(r)}s?(o.innerText="Preview backend disconnected.",f.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(f.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,o.innerText="Preview backend running in this workspace."),o.setAttribute("id",r)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",setupDom):setupDom()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function isMobileCordova(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isNode(){let e=getDefaults()?.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(i.g.process)}catch(e){return!1}}function isCloudflareWorker(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function isBrowserExtension(){let e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function isReactNative(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function isIE(){let e=getUA();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function isSafari(){return!isNode()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function isIndexedDBAvailable(){try{return"object"==typeof indexedDB}catch(e){return!1}}function validateIndexedDBOpenable(){return new Promise((e,r)=>{try{let i=!0,o="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(o);s.onsuccess=()=>{s.result.close(),i||self.indexedDB.deleteDatabase(o),e(!0)},s.onupgradeneeded=()=>{i=!1},s.onerror=()=>{r(s.error?.message||"")}}catch(e){r(e)}})}let FirebaseError=class FirebaseError extends Error{constructor(e,r,i){super(r),this.code=e,this.customData=i,this.name="FirebaseError",Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}};let ErrorFactory=class ErrorFactory{constructor(e,r,i){this.service=e,this.serviceName=r,this.errors=i}create(e,...r){let i=r[0]||{},o=`${this.service}/${e}`,s=this.errors[e],l=s?replaceTemplate(s,i):"Error",h=`${this.serviceName}: ${l} (${o}).`,d=new FirebaseError(o,h,i);return d}};function replaceTemplate(e,r){return e.replace(d,(e,i)=>{let o=r[i];return null!=o?String(o):`<${i}?>`})}let d=/\{\$([^}]+)}/g;function isEmpty(e){for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function deepEqual(e,r){if(e===r)return!0;let i=Object.keys(e),o=Object.keys(r);for(let s of i){if(!o.includes(s))return!1;let i=e[s],l=r[s];if(isObject(i)&&isObject(l)){if(!deepEqual(i,l))return!1}else if(i!==l)return!1}for(let e of o)if(!i.includes(e))return!1;return!0}function isObject(e){return null!==e&&"object"==typeof e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(e){let r=[];for(let[i,o]of Object.entries(e))Array.isArray(o)?o.forEach(e=>{r.push(encodeURIComponent(i)+"="+encodeURIComponent(e))}):r.push(encodeURIComponent(i)+"="+encodeURIComponent(o));return r.length?"&"+r.join("&"):""}function querystringDecode(e){let r={},i=e.replace(/^\?/,"").split("&");return i.forEach(e=>{if(e){let[i,o]=e.split("=");r[decodeURIComponent(i)]=decodeURIComponent(o)}}),r}function extractQuerystring(e){let r=e.indexOf("?");if(!r)return"";let i=e.indexOf("#",r);return e.substring(r,i>0?i:void 0)}function createSubscribe(e,r){let i=new ObserverProxy(e,r);return i.subscribe.bind(i)}let ObserverProxy=class ObserverProxy{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,i){let o;if(void 0===e&&void 0===r&&void 0===i)throw Error("Missing Observer.");void 0===(o=implementsAnyMethods(e,["next","error","complete"])?e:{next:e,error:r,complete:i}).next&&(o.next=noop),void 0===o.error&&(o.error=noop),void 0===o.complete&&(o.complete=noop);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch(e){}}),this.observers.push(o),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{r(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function implementsAnyMethods(e,r){if("object"!=typeof e||null===e)return!1;for(let i of r)if(i in e&&"function"==typeof e[i])return!0;return!1}function noop(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(e){return e&&e._delegate?e._delegate:e}},4470:function(e){"use strict";var r=Object.prototype.hasOwnProperty,i=Object.prototype.toString,o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,isArray=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===i.call(e)},isPlainObject=function(e){if(!e||"[object Object]"!==i.call(e))return!1;var o,s=r.call(e,"constructor"),l=e.constructor&&e.constructor.prototype&&r.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!s&&!l)return!1;for(o in e);return void 0===o||r.call(e,o)},setProperty=function(e,r){o&&"__proto__"===r.name?o(e,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):e[r.name]=r.newValue},getProperty=function(e,i){if("__proto__"===i){if(!r.call(e,i))return;if(s)return s(e,i).value}return e[i]};e.exports=function extend(){var e,r,i,o,s,l,h=arguments[0],d=1,f=arguments.length,_=!1;for("boolean"==typeof h&&(_=h,h=arguments[1]||{},d=2),(null==h||"object"!=typeof h&&"function"!=typeof h)&&(h={});d<f;++d)if(e=arguments[d],null!=e)for(r in e)i=getProperty(h,r),h!==(o=getProperty(e,r))&&(_&&o&&(isPlainObject(o)||(s=isArray(o)))?(s?(s=!1,l=i&&isArray(i)?i:[]):l=i&&isPlainObject(i)?i:{},setProperty(h,{name:r,newValue:extend(_,l,o)})):void 0!==o&&setProperty(h,{name:r,newValue:o}));return h}},5321:function(e){"use strict";var r=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,i=/\n/g,o=/^\s*/,s=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,l=/^:\s*/,h=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,d=/^[;\s]*/,f=/^\s+|\s+$/g;function index(e,f){if("string"!=typeof e)throw TypeError("First argument must be a string");if(!e)return[];f=f||{};var _=1,g=1;function updatePosition(e){var r=e.match(i);r&&(_+=r.length);var o=e.lastIndexOf("\n");g=~o?e.length-o:g+e.length}function position(){var e={line:_,column:g};return function(r){return r.position=new Position(e),match(o),r}}function Position(e){this.start=e,this.end={line:_,column:g},this.source=f.source}function error(r){var i=Error(f.source+":"+_+":"+g+": "+r);if(i.reason=r,i.filename=f.source,i.line=_,i.column=g,i.source=e,f.silent);else throw i}function match(r){var i=r.exec(e);if(i){var o=i[0];return updatePosition(o),e=e.slice(o.length),i}}function comments(e){var r;for(e=e||[];r=comment();)!1!==r&&e.push(r);return e}function comment(){var r=position();if("/"==e.charAt(0)&&"*"==e.charAt(1)){for(var i=2;""!=e.charAt(i)&&("*"!=e.charAt(i)||"/"!=e.charAt(i+1));)++i;if(i+=2,""===e.charAt(i-1))return error("End of comment missing");var o=e.slice(2,i-2);return g+=2,updatePosition(o),e=e.slice(i),g+=2,r({type:"comment",comment:o})}}function declaration(){var e=position(),i=match(s);if(i){if(comment(),!match(l))return error("property missing ':'");var o=match(h),f=e({type:"declaration",property:trim(i[0].replace(r,"")),value:o?trim(o[0].replace(r,"")):""});return match(d),f}}function declarations(){var e,r=[];for(comments(r);e=declaration();)!1!==e&&(r.push(e),comments(r));return r}return Position.prototype.content=e,match(o),declarations()}function trim(e){return e?e.replace(f,""):""}e.exports=index},4297:function(e,r,i){"use strict";i.d(r,{Z:function(){return createLucideIcon}});var o=i(7294),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),createLucideIcon=(e,r)=>{let i=(0,o.forwardRef)(({color:i="currentColor",size:l=24,strokeWidth:h=2,absoluteStrokeWidth:d,children:f,..._},g)=>(0,o.createElement)("svg",{ref:g,...s,width:l,height:l,stroke:i,strokeWidth:d?24*Number(h)/Number(l):h,className:`lucide lucide-${toKebabCase(e)}`,..._},[...r.map(([e,r])=>(0,o.createElement)(e,r)),...(Array.isArray(f)?f:[f])||[]]));return i.displayName=`${e}`,i}},1853:function(e,r,i){"use strict";i.d(r,{Z:function(){return s}});var o=i(4297);let s=(0,o.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},6279:function(e,r,i){"use strict";i.d(r,{Z:function(){return s}});var o=i(4297);let s=(0,o.Z)("Code2",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]])},1197:function(e,r,i){"use strict";i.d(r,{Z:function(){return s}});var o=i(4297);let s=(0,o.Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},1352:function(e,r,i){"use strict";i.d(r,{Z:function(){return s}});var o=i(4297);let s=(0,o.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3454:function(e,r,i){"use strict";var o,s;e.exports=(null==(o=i.g.process)?void 0:o.env)&&"object"==typeof(null==(s=i.g.process)?void 0:s.env)?i.g.process:i(7663)},6840:function(e,r,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return i(3865)}])},7498:function(e,r){"use strict";var i,o;Object.defineProperty(r,"__esModule",{value:!0}),function(e,r){for(var i in r)Object.defineProperty(e,i,{enumerable:!0,get:r[i]})}(r,{PrefetchKind:function(){return i},ACTION_REFRESH:function(){return s},ACTION_NAVIGATE:function(){return l},ACTION_RESTORE:function(){return h},ACTION_SERVER_PATCH:function(){return d},ACTION_PREFETCH:function(){return f},ACTION_FAST_REFRESH:function(){return _},ACTION_SERVER_ACTION:function(){return g}});let s="refresh",l="navigate",h="restore",d="server-patch",f="prefetch",_="fast-refresh",g="server-action";(o=i||(i={})).AUTO="auto",o.FULL="full",o.TEMPORARY="temporary",("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},30:function(e,r,i){"use strict";function getDomainLocale(e,r,i,o){return!1}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getDomainLocale",{enumerable:!0,get:function(){return getDomainLocale}}),i(2866),("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},5170:function(e,r,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return ee}});let o=i(8754),s=o._(i(7294)),l=i(4450),h=i(2227),d=i(4364),f=i(109),_=i(3607),g=i(1823),A=i(9031),b=i(920),k=i(30),M=i(7192),j=i(7498),q=new Set;function prefetch(e,r,i,o,s,l){if(!l&&!(0,h.isLocalURL)(r))return;if(!o.bypassPrefetchedCheck){let s=void 0!==o.locale?o.locale:"locale"in e?e.locale:void 0,l=r+"%"+i+"%"+s;if(q.has(l))return;q.add(l)}let d=l?e.prefetch(r,s):e.prefetch(r,i,o);Promise.resolve(d).catch(e=>{})}function isModifiedEvent(e){let r=e.currentTarget,i=r.getAttribute("target");return i&&"_self"!==i||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}function linkClicked(e,r,i,o,l,d,f,_,g,A){let{nodeName:b}=e.currentTarget,k="A"===b.toUpperCase();if(k&&(isModifiedEvent(e)||!g&&!(0,h.isLocalURL)(i)))return;e.preventDefault();let navigate=()=>{let e=null==f||f;"beforePopState"in r?r[l?"replace":"push"](i,o,{shallow:d,locale:_,scroll:e}):r[l?"replace":"push"](o||i,{forceOptimisticNavigation:!A,scroll:e})};g?s.default.startTransition(navigate):navigate()}function formatStringOrUrl(e){return"string"==typeof e?e:(0,d.formatUrl)(e)}let $=s.default.forwardRef(function(e,r){let i,o;let{href:h,as:d,children:q,prefetch:$=null,passHref:ee,replace:et,shallow:en,scroll:er,locale:ei,onClick:eo,onMouseEnter:es,onTouchStart:ea,legacyBehavior:el=!1,...eu}=e;i=q,el&&("string"==typeof i||"number"==typeof i)&&(i=s.default.createElement("a",null,i));let eh=s.default.useContext(g.RouterContext),ed=s.default.useContext(A.AppRouterContext),ef=null!=eh?eh:ed,ep=!eh,em=!1!==$,e_=null===$?j.PrefetchKind.AUTO:j.PrefetchKind.FULL,{href:eg,as:ey}=s.default.useMemo(()=>{if(!eh){let e=formatStringOrUrl(h);return{href:e,as:d?formatStringOrUrl(d):e}}let[e,r]=(0,l.resolveHref)(eh,h,!0);return{href:e,as:d?(0,l.resolveHref)(eh,d):r||e}},[eh,h,d]),eE=s.default.useRef(eg),eI=s.default.useRef(ey);el&&(o=s.default.Children.only(i));let eT=el?o&&"object"==typeof o&&o.ref:r,[ev,eA,eP]=(0,b.useIntersection)({rootMargin:"200px"}),eR=s.default.useCallback(e=>{(eI.current!==ey||eE.current!==eg)&&(eP(),eI.current=ey,eE.current=eg),ev(e),eT&&("function"==typeof eT?eT(e):"object"==typeof eT&&(eT.current=e))},[ey,eT,eg,eP,ev]);s.default.useEffect(()=>{ef&&eA&&em&&prefetch(ef,eg,ey,{locale:ei},{kind:e_},ep)},[ey,eg,eA,ei,em,null==eh?void 0:eh.locale,ef,ep,e_]);let ew={ref:eR,onClick(e){el||"function"!=typeof eo||eo(e),el&&o.props&&"function"==typeof o.props.onClick&&o.props.onClick(e),ef&&!e.defaultPrevented&&linkClicked(e,ef,eg,ey,et,en,er,ei,ep,em)},onMouseEnter(e){el||"function"!=typeof es||es(e),el&&o.props&&"function"==typeof o.props.onMouseEnter&&o.props.onMouseEnter(e),ef&&(em||!ep)&&prefetch(ef,eg,ey,{locale:ei,priority:!0,bypassPrefetchedCheck:!0},{kind:e_},ep)},onTouchStart(e){el||"function"!=typeof ea||ea(e),el&&o.props&&"function"==typeof o.props.onTouchStart&&o.props.onTouchStart(e),ef&&(em||!ep)&&prefetch(ef,eg,ey,{locale:ei,priority:!0,bypassPrefetchedCheck:!0},{kind:e_},ep)}};if((0,f.isAbsoluteUrl)(ey))ew.href=ey;else if(!el||ee||"a"===o.type&&!("href"in o.props)){let e=void 0!==ei?ei:null==eh?void 0:eh.locale,r=(null==eh?void 0:eh.isLocaleDomain)&&(0,k.getDomainLocale)(ey,e,null==eh?void 0:eh.locales,null==eh?void 0:eh.domainLocales);ew.href=r||(0,M.addBasePath)((0,_.addLocale)(ey,e,null==eh?void 0:eh.defaultLocale))}return el?s.default.cloneElement(o,ew):s.default.createElement("a",{...eu,...ew},i)}),ee=$;("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},920:function(e,r,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useIntersection",{enumerable:!0,get:function(){return useIntersection}});let o=i(7294),s=i(3436),l="function"==typeof IntersectionObserver,h=new Map,d=[];function createObserver(e){let r;let i={root:e.root||null,margin:e.rootMargin||""},o=d.find(e=>e.root===i.root&&e.margin===i.margin);if(o&&(r=h.get(o)))return r;let s=new Map,l=new IntersectionObserver(e=>{e.forEach(e=>{let r=s.get(e.target),i=e.isIntersecting||e.intersectionRatio>0;r&&i&&r(i)})},e);return r={id:i,observer:l,elements:s},d.push(i),h.set(i,r),r}function observe(e,r,i){let{id:o,observer:s,elements:l}=createObserver(i);return l.set(e,r),s.observe(e),function(){if(l.delete(e),s.unobserve(e),0===l.size){s.disconnect(),h.delete(o);let e=d.findIndex(e=>e.root===o.root&&e.margin===o.margin);e>-1&&d.splice(e,1)}}}function useIntersection(e){let{rootRef:r,rootMargin:i,disabled:h}=e,d=h||!l,[f,_]=(0,o.useState)(!1),g=(0,o.useRef)(null),A=(0,o.useCallback)(e=>{g.current=e},[]);(0,o.useEffect)(()=>{if(l){if(d||f)return;let e=g.current;if(e&&e.tagName){let o=observe(e,e=>e&&_(e),{root:null==r?void 0:r.current,rootMargin:i});return o}}else if(!f){let e=(0,s.requestIdleCallback)(()=>_(!0));return()=>(0,s.cancelIdleCallback)(e)}},[d,i,r,f,g.current]);let b=(0,o.useCallback)(()=>{_(!1)},[]);return[A,f,b]}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},6114:function(e,r,i){"use strict";i.d(r,{L:function(){return AIProvider},l:function(){return useAI}});var o=i(5893),s=i(7294),l=i(1163),h=i(6813);let d=(0,s.createContext)(void 0);function AIProvider(e){let{children:r}=e,[i,f]=(0,s.useState)(!1),[_,g]=(0,s.useState)([{role:"assistant",content:"Hi! I am your AI Tutor. Ask me anything about your code or the platform."}]),[A,b]=(0,s.useState)(!1),[k,M]=(0,s.useState)({});(0,l.useRouter)();let sendMessage=async e=>{let r={role:"user",content:e};g(e=>[...e,r]),b(!0);try{let e=h.I.currentUser?await h.I.currentUser.getIdToken():"",i=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({messages:[..._,r],context:k})});if(!i.ok){let e=i.statusText;try{let r=await i.json();e=r.error||i.statusText}catch(e){}throw Error(e||"Server Error ".concat(i.status))}if(!i.body)throw Error("No body");g(e=>[...e,{role:"assistant",content:""}]);let o=i.body.getReader(),s=new TextDecoder,l=!1;for(;!l;){let{value:e,done:r}=await o.read();l=r;let i=s.decode(e);g(e=>{let r=[...e],o=r[r.length-1];return"assistant"===o.role&&(o.content+=i),r})}}catch(r){console.error("AI Stream Error:",r);let e=r.message||"Unknown Error";g(r=>{let i=r[r.length-1];if("assistant"===i.role&&""===i.content){let i=[...r];return i[i.length-1].content="⚠️ **Connection Error:** ".concat(e,". \n\n*Using offline knowledge base where available.*"),i}return[...r,{role:"assistant",content:"⚠️ **Connection Error:** ".concat(e)}]})}finally{b(!1)}};return(0,o.jsx)(d.Provider,{value:{isOpen:i,toggleChat:()=>f(e=>!e),messages:_,sendMessage,isTyping:A,contextData:k,updateContext:e=>{M(r=>({...r,...e}))},clearChat:()=>{g([{role:"assistant",content:"Chat history cleared. How can I help?"}])}},children:r})}let useAI=()=>{let e=(0,s.useContext)(d);if(!e)throw Error("useAI must be used within AIProvider");return e}},1503:function(e,r,i){"use strict";i.d(r,{H:function(){return AuthProvider},a:function(){return useAuth}});var o=i(5893),s=i(7294),l=i(2753),h=i(6813),d=i(1163);let f=(0,s.createContext)(void 0);function AuthProvider(e){let{children:r}=e,[i,_]=(0,s.useState)(null),[g,A]=(0,s.useState)(!0),b=(0,d.useRouter)();(0,s.useEffect)(()=>{let e=(0,l.Aj)(h.I,e=>{_(e),A(!1)});return()=>e()},[]);let signInWithGoogle=async()=>{let e=new l.hJ;try{await (0,l.rh)(h.I,e),b.push("/profile")}catch(e){console.error("Login Failed",e)}},logout=async()=>{await (0,l.w7)(h.I),b.push("/")};return(0,o.jsx)(f.Provider,{value:{user:i,loading:g,signInWithGoogle,logout},children:r})}let useAuth=()=>{let e=(0,s.useContext)(f);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},6813:function(e,r,i){"use strict";i.d(r,{I:function(){return d},db:function(){return f}});var o=i(6771);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(0,o.KN)("firebase","12.7.0","app");var s=i(2753),l=i(9724);let h=(0,o.C6)().length?(0,o.Mq)():(0,o.ZF)({apiKey:"AIzaSyDCQGH2Y2dASDO3PkIg1yai0j_xs4ZWiyI",authDomain:"student-resource-hub-a758a.firebaseapp.com",projectId:"student-resource-hub-a758a",storageBucket:"student-resource-hub-a758a.firebasestorage.app",messagingSenderId:"783493453804",appId:"1:783493453804:web:2a56100885f7be9f3a92c9"}),d=(0,s.v0)(h),f=(0,l.ad)(h)},3865:function(e,r,i){"use strict";i.r(r),i.d(r,{default:function(){return App}});var o=i(5893);i(2352);var s=i(1503),l=i(7294),h=i(1853),d=i(4297);let f=(0,d.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var _=i(1197),g=i(1664),A=i.n(g);let ErrorBoundary=class ErrorBoundary extends l.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,r){console.error("Uncaught error:",e,r),this.setState({errorInfo:r})}render(){return this.state.hasError?(0,o.jsx)("div",{className:"min-h-screen bg-[#0A1A2F] text-[#EAF1FF] flex items-center justify-center p-4",children:(0,o.jsxs)("div",{className:"max-w-xl w-full bg-[#112240] border border-rose-500/20 rounded-2xl p-8 shadow-2xl relative overflow-hidden",children:[(0,o.jsx)("div",{className:"absolute top-0 right-0 p-8 opacity-5",children:(0,o.jsx)(h.Z,{size:120})}),(0,o.jsxs)("div",{className:"relative z-10",children:[(0,o.jsx)("div",{className:"w-16 h-16 bg-rose-500/10 rounded-2xl flex items-center justify-center mb-6 border border-rose-500/20",children:(0,o.jsx)(h.Z,{className:"w-8 h-8 text-rose-500"})}),(0,o.jsx)("h1",{className:"text-3xl font-black mb-4 tracking-tight",children:"System Critical Failure"}),(0,o.jsx)("p",{className:"text-[#8892b0] mb-8 leading-relaxed",children:"The application encountered an unexpected state and activated the safety mechanism to prevent data corruption."}),this.state.error&&(0,o.jsx)("div",{className:"bg-[#0A1A2F] rounded-lg p-4 font-mono text-xs text-rose-300 mb-8 border border-white/5 overflow-auto max-h-32",children:this.state.error.toString()}),(0,o.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,o.jsxs)("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-rose-500 hover:bg-rose-600 text-white font-bold rounded-xl transition-all shadow-lg shadow-rose-900/20 flex items-center justify-center gap-2",children:[(0,o.jsx)(f,{size:18})," Reboot System"]}),(0,o.jsxs)(A(),{href:"/",className:"px-6 py-3 bg-[#1D3557] hover:bg-[#233A5E] text-[#EAF1FF] font-bold rounded-xl transition-all border border-[#233A5E] flex items-center justify-center gap-2",children:[(0,o.jsx)(_.Z,{size:18})," Return to Base"]})]})]})]})}):this.props.children}constructor(...e){super(...e),this.state={hasError:!1,error:null,errorInfo:null}}};var b=i(6114);let k=(0,d.Z)("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),M=(0,d.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),j=(0,d.Z)("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),q=(0,d.Z)("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);var $=i(1352),ee=i(6279);let et=(0,d.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);var en=i(8885);function ChatWidget(){let{isOpen:e,toggleChat:r,messages:i,sendMessage:s,isTyping:h,contextData:d,clearChat:f}=(0,b.l)(),[_,g]=(0,l.useState)(""),[A,er]=(0,l.useState)(!1),ei=(0,l.useRef)(null);return((0,l.useEffect)(()=>{var e;null===(e=ei.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[i,e]),e)?(0,o.jsxs)("div",{className:"fixed bottom-6 right-6 bg-ui-card border border-ui-border shadow-2xl z-50 flex flex-col transition-all duration-300 ".concat(A?"w-[90vw] h-[80vh] rounded-3xl":"w-[380px] h-[600px] rounded-2xl"),children:[(0,o.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-ui-border bg-ui-dark/50 rounded-t-2xl backdrop-blur-md",children:[(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsx)("div",{className:"p-2 bg-gradient-to-br from-rose-500 to-orange-500 rounded-xl",children:(0,o.jsx)(k,{className:"w-5 h-5 text-white"})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"font-bold text-sm",children:"AI Tutor"}),d.problemTitle&&(0,o.jsxs)("p",{className:"text-[10px] text-text-muted truncate max-w-[150px]",children:["Context: ",d.problemTitle]})]})]}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("button",{onClick:f,className:"p-2 hover:bg-ui-border rounded-lg text-text-muted hover:text-rose-400 transition-colors",title:"Clear Chat",children:(0,o.jsx)(M,{className:"w-4 h-4"})}),(0,o.jsx)("button",{onClick:()=>er(!A),className:"p-2 hover:bg-ui-border rounded-lg text-text-muted transition-colors",children:A?(0,o.jsx)(j,{className:"w-4 h-4"}):(0,o.jsx)(q,{className:"w-4 h-4"})}),(0,o.jsx)("button",{onClick:r,className:"p-2 hover:bg-rose-500/20 rounded-lg text-text-muted hover:text-rose-500 transition-colors",children:(0,o.jsx)($.Z,{className:"w-4 h-4"})})]})]}),(0,o.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[i.map((e,r)=>(0,o.jsxs)("div",{className:"flex gap-3 ".concat("user"===e.role?"justify-end":"justify-start"),children:["assistant"===e.role&&(0,o.jsx)("div",{className:"w-8 h-8 rounded-full bg-ui-border flex flex-shrink-0 items-center justify-center",children:(0,o.jsx)(k,{className:"w-4 h-4 text-text-muted"})}),(0,o.jsx)("div",{className:"max-w-[85%] p-3 rounded-2xl text-sm leading-relaxed ".concat("user"===e.role?"bg-primary text-text-primary rounded-tr-none border border-ui-border":"bg-ui-dark text-text-secondary rounded-tl-none border border-ui-border"),children:(0,o.jsx)("div",{className:"prose prose-invert prose-sm max-w-none",children:(0,o.jsx)(en.UG,{components:{code(e){let{node:r,inline:i,className:s,children:l,...h}=e;return i?(0,o.jsx)("code",{className:"bg-black/30 px-1 py-0.5 rounded text-rose-300 font-mono text-xs",...h,children:l}):(0,o.jsx)("div",{className:"bg-black/30 p-2 rounded-lg my-2 border border-ui-border font-mono text-xs overflow-x-auto",children:l})}},children:e.content})})})]},r)),h&&(0,o.jsxs)("div",{className:"flex gap-3",children:[(0,o.jsx)("div",{className:"w-8 h-8 rounded-full bg-ui-border flex flex-shrink-0 items-center justify-center",children:(0,o.jsx)(k,{className:"w-4 h-4 text-text-muted"})}),(0,o.jsx)("div",{className:"bg-ui-dark p-4 rounded-2xl rounded-tl-none border border-ui-border",children:(0,o.jsxs)("div",{className:"flex gap-1",children:[(0,o.jsx)("span",{className:"w-2 h-2 bg-text-muted rounded-full animate-bounce"}),(0,o.jsx)("span",{className:"w-2 h-2 bg-text-muted rounded-full animate-bounce delay-75"}),(0,o.jsx)("span",{className:"w-2 h-2 bg-text-muted rounded-full animate-bounce delay-150"})]})})]}),(0,o.jsx)("div",{ref:ei})]}),(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault(),_.trim()&&(s(_),g(""))},className:"p-4 border-t border-ui-border bg-ui-dark/30",children:[d.currentCode&&(0,o.jsxs)("div",{className:"mb-2 flex gap-2 overflow-x-auto pb-2",children:[(0,o.jsxs)("button",{type:"button",onClick:()=>s("Explain my current code logic."),className:"px-3 py-1.5 bg-primary/50 hover:bg-primary border border-ui-border rounded-full text-[10px] font-bold text-text-muted whitespace-nowrap transition-colors flex items-center gap-1",children:[(0,o.jsx)(ee.Z,{className:"w-3 h-3"})," Explain Code"]}),(0,o.jsx)("button",{type:"button",onClick:()=>s("Why is my code failing?"),className:"px-3 py-1.5 bg-primary/50 hover:bg-primary border border-ui-border rounded-full text-[10px] font-bold text-text-muted whitespace-nowrap transition-colors",children:"\uD83D\uDC1E Debug Help"}),(0,o.jsx)("button",{type:"button",onClick:()=>s("Optimize this solution for time complexity."),className:"px-3 py-1.5 bg-primary/50 hover:bg-primary border border-ui-border rounded-full text-[10px] font-bold text-text-muted whitespace-nowrap transition-colors",children:"⚡ Optimize"})]}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("input",{type:"text",value:_,onChange:e=>g(e.target.value),placeholder:"Ask anything...",className:"flex-1 bg-ui-dark border border-ui-border rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-rose-500 transition-colors placeholder:text-text-muted/50"}),(0,o.jsx)("button",{type:"submit",disabled:!_.trim()||h,className:"p-3 bg-rose-500 text-white rounded-xl hover:bg-rose-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-glow-rose",children:(0,o.jsx)(et,{className:"w-5 h-5"})})]})]})]}):(0,o.jsxs)("button",{onClick:r,className:"fixed bottom-6 right-6 p-4 bg-gradient-to-r from-rose-500 to-orange-500 rounded-full shadow-glow-rose hover:scale-110 transition-transform z-50 group",children:[(0,o.jsx)(k,{className:"w-8 h-8 text-white animate-pulse-slow"}),(0,o.jsx)("span",{className:"absolute right-full mr-4 top-1/2 -translate-y-1/2 px-3 py-1 bg-ui-card border border-ui-border rounded-lg text-xs font-bold whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity",children:"Ask AI Tutor"})]})}function App(e){let{Component:r,pageProps:i}=e;return(0,l.useEffect)(()=>{fetch("/version.json").then(e=>e.json()).then(e=>{console.log("\uD83D\uDE80 System Version: ".concat(e.version," (").concat(e.commit,")"))}).catch(()=>console.warn("Build version info missing"))},[]),(0,o.jsx)(ErrorBoundary,{children:(0,o.jsx)(s.H,{children:(0,o.jsxs)(b.L,{children:[(0,o.jsx)(r,{...i}),(0,o.jsx)(ChatWidget,{})]})})})}},1876:function(e){!function(){var r={675:function(e,r){"use strict";r.byteLength=byteLength,r.toByteArray=toByteArray,r.fromByteArray=fromByteArray;for(var i=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,d=l.length;h<d;++h)i[h]=l[h],o[l.charCodeAt(h)]=h;function getLens(e){var r=e.length;if(r%4>0)throw Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");-1===i&&(i=r);var o=i===r?0:4-i%4;return[i,o]}function byteLength(e){var r=getLens(e),i=r[0],o=r[1];return(i+o)*3/4-o}function _byteLength(e,r,i){return(r+i)*3/4-i}function toByteArray(e){var r,i,l=getLens(e),h=l[0],d=l[1],f=new s(_byteLength(e,h,d)),_=0,g=d>0?h-4:h;for(i=0;i<g;i+=4)r=o[e.charCodeAt(i)]<<18|o[e.charCodeAt(i+1)]<<12|o[e.charCodeAt(i+2)]<<6|o[e.charCodeAt(i+3)],f[_++]=r>>16&255,f[_++]=r>>8&255,f[_++]=255&r;return 2===d&&(r=o[e.charCodeAt(i)]<<2|o[e.charCodeAt(i+1)]>>4,f[_++]=255&r),1===d&&(r=o[e.charCodeAt(i)]<<10|o[e.charCodeAt(i+1)]<<4|o[e.charCodeAt(i+2)]>>2,f[_++]=r>>8&255,f[_++]=255&r),f}function tripletToBase64(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}function encodeChunk(e,r,i){for(var o=[],s=r;s<i;s+=3)o.push(tripletToBase64((e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2])));return o.join("")}function fromByteArray(e){for(var r,o=e.length,s=o%3,l=[],h=0,d=o-s;h<d;h+=16383)l.push(encodeChunk(e,h,h+16383>d?d:h+16383));return 1===s?l.push(i[(r=e[o-1])>>2]+i[r<<4&63]+"=="):2===s&&l.push(i[(r=(e[o-2]<<8)+e[o-1])>>10]+i[r>>4&63]+i[r<<2&63]+"="),l.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},72:function(e,r,i){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var o=i(675),s=i(783),l="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function typedArraySupport(){try{var e=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(e,r),42===e.foo()}catch(e){return!1}}function createBuffer(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');var r=new Uint8Array(e);return Object.setPrototypeOf(r,Buffer.prototype),r}function Buffer(e,r,i){if("number"==typeof e){if("string"==typeof r)throw TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(e)}return from(e,r,i)}function from(e,r,i){if("string"==typeof e)return fromString(e,r);if(ArrayBuffer.isView(e))return fromArrayLike(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(isInstance(e,ArrayBuffer)||e&&isInstance(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(isInstance(e,SharedArrayBuffer)||e&&isInstance(e.buffer,SharedArrayBuffer)))return fromArrayBuffer(e,r,i);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var o=e.valueOf&&e.valueOf();if(null!=o&&o!==e)return Buffer.from(o,r,i);var s=fromObject(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return Buffer.from(e[Symbol.toPrimitive]("string"),r,i);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function assertSize(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function alloc(e,r,i){return(assertSize(e),e<=0)?createBuffer(e):void 0!==r?"string"==typeof i?createBuffer(e).fill(r,i):createBuffer(e).fill(r):createBuffer(e)}function allocUnsafe(e){return assertSize(e),createBuffer(e<0?0:0|checked(e))}function fromString(e,r){if(("string"!=typeof r||""===r)&&(r="utf8"),!Buffer.isEncoding(r))throw TypeError("Unknown encoding: "+r);var i=0|byteLength(e,r),o=createBuffer(i),s=o.write(e,r);return s!==i&&(o=o.slice(0,s)),o}function fromArrayLike(e){for(var r=e.length<0?0:0|checked(e.length),i=createBuffer(r),o=0;o<r;o+=1)i[o]=255&e[o];return i}function fromArrayBuffer(e,r,i){var o;if(r<0||e.byteLength<r)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<r+(i||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(o=void 0===r&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,r):new Uint8Array(e,r,i),Buffer.prototype),o}function fromObject(e){if(Buffer.isBuffer(e)){var r,i=0|checked(e.length),o=createBuffer(i);return 0===o.length||e.copy(o,0,0,i),o}return void 0!==e.length?"number"!=typeof e.length||(r=e.length)!=r?createBuffer(0):fromArrayLike(e):"Buffer"===e.type&&Array.isArray(e.data)?fromArrayLike(e.data):void 0}function checked(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function SlowBuffer(e){return+e!=e&&(e=0),Buffer.alloc(+e)}function byteLength(e,r){if(Buffer.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||isInstance(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var i=e.length,o=arguments.length>2&&!0===arguments[2];if(!o&&0===i)return 0;for(var s=!1;;)switch(r){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return base64ToBytes(e).length;default:if(s)return o?-1:utf8ToBytes(e).length;r=(""+r).toLowerCase(),s=!0}}function slowToString(e,r,i){var o=!1;if((void 0===r||r<0)&&(r=0),r>this.length||((void 0===i||i>this.length)&&(i=this.length),i<=0||(i>>>=0)<=(r>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,r,i);case"utf8":case"utf-8":return utf8Slice(this,r,i);case"ascii":return asciiSlice(this,r,i);case"latin1":case"binary":return latin1Slice(this,r,i);case"base64":return base64Slice(this,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,r,i);default:if(o)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function swap(e,r,i){var o=e[r];e[r]=e[i],e[i]=o}function bidirectionalIndexOf(e,r,i,o,s){var l;if(0===e.length)return -1;if("string"==typeof i?(o=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),(l=i=+i)!=l&&(i=s?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(s)return -1;i=e.length-1}else if(i<0){if(!s)return -1;i=0}if("string"==typeof r&&(r=Buffer.from(r,o)),Buffer.isBuffer(r))return 0===r.length?-1:arrayIndexOf(e,r,i,o,s);if("number"==typeof r)return(r&=255,"function"==typeof Uint8Array.prototype.indexOf)?s?Uint8Array.prototype.indexOf.call(e,r,i):Uint8Array.prototype.lastIndexOf.call(e,r,i):arrayIndexOf(e,[r],i,o,s);throw TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,r,i,o,s){var l,h=1,d=e.length,f=r.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(e.length<2||r.length<2)return -1;h=2,d/=2,f/=2,i/=2}function read(e,r){return 1===h?e[r]:e.readUInt16BE(r*h)}if(s){var _=-1;for(l=i;l<d;l++)if(read(e,l)===read(r,-1===_?0:l-_)){if(-1===_&&(_=l),l-_+1===f)return _*h}else -1!==_&&(l-=l-_),_=-1}else for(i+f>d&&(i=d-f),l=i;l>=0;l--){for(var g=!0,A=0;A<f;A++)if(read(e,l+A)!==read(r,A)){g=!1;break}if(g)return l}return -1}function hexWrite(e,r,i,o){i=Number(i)||0;var s=e.length-i;o?(o=Number(o))>s&&(o=s):o=s;var l=r.length;o>l/2&&(o=l/2);for(var h=0;h<o;++h){var d=parseInt(r.substr(2*h,2),16);if(d!=d)break;e[i+h]=d}return h}function utf8Write(e,r,i,o){return blitBuffer(utf8ToBytes(r,e.length-i),e,i,o)}function latin1Write(e,r,i,o){return blitBuffer(asciiToBytes(r),e,i,o)}function base64Write(e,r,i,o){return blitBuffer(base64ToBytes(r),e,i,o)}function ucs2Write(e,r,i,o){return blitBuffer(utf16leToBytes(r,e.length-i),e,i,o)}function base64Slice(e,r,i){return 0===r&&i===e.length?o.fromByteArray(e):o.fromByteArray(e.slice(r,i))}function utf8Slice(e,r,i){i=Math.min(e.length,i);for(var o=[],s=r;s<i;){var l,h,d,f,_=e[s],g=null,A=_>239?4:_>223?3:_>191?2:1;if(s+A<=i)switch(A){case 1:_<128&&(g=_);break;case 2:(192&(l=e[s+1]))==128&&(f=(31&_)<<6|63&l)>127&&(g=f);break;case 3:l=e[s+1],h=e[s+2],(192&l)==128&&(192&h)==128&&(f=(15&_)<<12|(63&l)<<6|63&h)>2047&&(f<55296||f>57343)&&(g=f);break;case 4:l=e[s+1],h=e[s+2],d=e[s+3],(192&l)==128&&(192&h)==128&&(192&d)==128&&(f=(15&_)<<18|(63&l)<<12|(63&h)<<6|63&d)>65535&&f<1114112&&(g=f)}null===g?(g=65533,A=1):g>65535&&(g-=65536,o.push(g>>>10&1023|55296),g=56320|1023&g),o.push(g),s+=A}return decodeCodePointsArray(o)}function decodeCodePointsArray(e){var r=e.length;if(r<=4096)return String.fromCharCode.apply(String,e);for(var i="",o=0;o<r;)i+=String.fromCharCode.apply(String,e.slice(o,o+=4096));return i}function asciiSlice(e,r,i){var o="";i=Math.min(e.length,i);for(var s=r;s<i;++s)o+=String.fromCharCode(127&e[s]);return o}function latin1Slice(e,r,i){var o="";i=Math.min(e.length,i);for(var s=r;s<i;++s)o+=String.fromCharCode(e[s]);return o}function hexSlice(e,r,i){var o=e.length;(!r||r<0)&&(r=0),(!i||i<0||i>o)&&(i=o);for(var s="",l=r;l<i;++l)s+=d[e[l]];return s}function utf16leSlice(e,r,i){for(var o=e.slice(r,i),s="",l=0;l<o.length;l+=2)s+=String.fromCharCode(o[l]+256*o[l+1]);return s}function checkOffset(e,r,i){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+r>i)throw RangeError("Trying to access beyond buffer length")}function checkInt(e,r,i,o,s,l){if(!Buffer.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(r>s||r<l)throw RangeError('"value" argument is out of bounds');if(i+o>e.length)throw RangeError("Index out of range")}function checkIEEE754(e,r,i,o,s,l){if(i+o>e.length||i<0)throw RangeError("Index out of range")}function writeFloat(e,r,i,o,l){return r=+r,i>>>=0,l||checkIEEE754(e,r,i,4,34028234663852886e22,-34028234663852886e22),s.write(e,r,i,o,23,4),i+4}function writeDouble(e,r,i,o,l){return r=+r,i>>>=0,l||checkIEEE754(e,r,i,8,17976931348623157e292,-17976931348623157e292),s.write(e,r,i,o,52,8),i+8}r.Buffer=Buffer,r.SlowBuffer=SlowBuffer,r.INSPECT_MAX_BYTES=50,r.kMaxLength=2147483647,Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),Buffer.poolSize=8192,Buffer.from=function(e,r,i){return from(e,r,i)},Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(e,r,i){return alloc(e,r,i)},Buffer.allocUnsafe=function(e){return allocUnsafe(e)},Buffer.allocUnsafeSlow=function(e){return allocUnsafe(e)},Buffer.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==Buffer.prototype},Buffer.compare=function(e,r){if(isInstance(e,Uint8Array)&&(e=Buffer.from(e,e.offset,e.byteLength)),isInstance(r,Uint8Array)&&(r=Buffer.from(r,r.offset,r.byteLength)),!Buffer.isBuffer(e)||!Buffer.isBuffer(r))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;for(var i=e.length,o=r.length,s=0,l=Math.min(i,o);s<l;++s)if(e[s]!==r[s]){i=e[s],o=r[s];break}return i<o?-1:o<i?1:0},Buffer.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(e,r){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer.alloc(0);if(void 0===r)for(i=0,r=0;i<e.length;++i)r+=e[i].length;var i,o=Buffer.allocUnsafe(r),s=0;for(i=0;i<e.length;++i){var l=e[i];if(isInstance(l,Uint8Array)&&(l=Buffer.from(l)),!Buffer.isBuffer(l))throw TypeError('"list" argument must be an Array of Buffers');l.copy(o,s),s+=l.length}return o},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)swap(this,r,r+1);return this},Buffer.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)swap(this,r,r+3),swap(this,r+1,r+2);return this},Buffer.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)swap(this,r,r+7),swap(this,r+1,r+6),swap(this,r+2,r+5),swap(this,r+3,r+4);return this},Buffer.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?utf8Slice(this,0,e):slowToString.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function(e){if(!Buffer.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===Buffer.compare(this,e)},Buffer.prototype.inspect=function(){var e="",i=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(e+=" ... "),"<Buffer "+e+">"},l&&(Buffer.prototype[l]=Buffer.prototype.inspect),Buffer.prototype.compare=function(e,r,i,o,s){if(isInstance(e,Uint8Array)&&(e=Buffer.from(e,e.offset,e.byteLength)),!Buffer.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=0),void 0===i&&(i=e?e.length:0),void 0===o&&(o=0),void 0===s&&(s=this.length),r<0||i>e.length||o<0||s>this.length)throw RangeError("out of range index");if(o>=s&&r>=i)return 0;if(o>=s)return -1;if(r>=i)return 1;if(r>>>=0,i>>>=0,o>>>=0,s>>>=0,this===e)return 0;for(var l=s-o,h=i-r,d=Math.min(l,h),f=this.slice(o,s),_=e.slice(r,i),g=0;g<d;++g)if(f[g]!==_[g]){l=f[g],h=_[g];break}return l<h?-1:h<l?1:0},Buffer.prototype.includes=function(e,r,i){return -1!==this.indexOf(e,r,i)},Buffer.prototype.indexOf=function(e,r,i){return bidirectionalIndexOf(this,e,r,i,!0)},Buffer.prototype.lastIndexOf=function(e,r,i){return bidirectionalIndexOf(this,e,r,i,!1)},Buffer.prototype.write=function(e,r,i,o){if(void 0===r)o="utf8",i=this.length,r=0;else if(void 0===i&&"string"==typeof r)o=r,i=this.length,r=0;else if(isFinite(r))r>>>=0,isFinite(i)?(i>>>=0,void 0===o&&(o="utf8")):(o=i,i=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s,l,h=this.length-r;if((void 0===i||i>h)&&(i=h),e.length>0&&(i<0||r<0)||r>this.length)throw RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var d=!1;;)switch(o){case"hex":return hexWrite(this,e,r,i);case"utf8":case"utf-8":return utf8Write(this,e,r,i);case"ascii":return s=r,l=i,blitBuffer(asciiToBytes(e),this,s,l);case"latin1":case"binary":return latin1Write(this,e,r,i);case"base64":return base64Write(this,e,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,e,r,i);default:if(d)throw TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),d=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(e,r){var i=this.length;e=~~e,r=void 0===r?i:~~r,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),r<0?(r+=i)<0&&(r=0):r>i&&(r=i),r<e&&(r=e);var o=this.subarray(e,r);return Object.setPrototypeOf(o,Buffer.prototype),o},Buffer.prototype.readUIntLE=function(e,r,i){e>>>=0,r>>>=0,i||checkOffset(e,r,this.length);for(var o=this[e],s=1,l=0;++l<r&&(s*=256);)o+=this[e+l]*s;return o},Buffer.prototype.readUIntBE=function(e,r,i){e>>>=0,r>>>=0,i||checkOffset(e,r,this.length);for(var o=this[e+--r],s=1;r>0&&(s*=256);)o+=this[e+--r]*s;return o},Buffer.prototype.readUInt8=function(e,r){return e>>>=0,r||checkOffset(e,1,this.length),this[e]},Buffer.prototype.readUInt16LE=function(e,r){return e>>>=0,r||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer.prototype.readUInt16BE=function(e,r){return e>>>=0,r||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer.prototype.readUInt32LE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer.prototype.readUInt32BE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer.prototype.readIntLE=function(e,r,i){e>>>=0,r>>>=0,i||checkOffset(e,r,this.length);for(var o=this[e],s=1,l=0;++l<r&&(s*=256);)o+=this[e+l]*s;return o>=(s*=128)&&(o-=Math.pow(2,8*r)),o},Buffer.prototype.readIntBE=function(e,r,i){e>>>=0,r>>>=0,i||checkOffset(e,r,this.length);for(var o=r,s=1,l=this[e+--o];o>0&&(s*=256);)l+=this[e+--o]*s;return l>=(s*=128)&&(l-=Math.pow(2,8*r)),l},Buffer.prototype.readInt8=function(e,r){return(e>>>=0,r||checkOffset(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},Buffer.prototype.readInt16LE=function(e,r){e>>>=0,r||checkOffset(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},Buffer.prototype.readInt16BE=function(e,r){e>>>=0,r||checkOffset(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},Buffer.prototype.readInt32LE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer.prototype.readInt32BE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer.prototype.readFloatLE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),s.read(this,e,!0,23,4)},Buffer.prototype.readFloatBE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),s.read(this,e,!1,23,4)},Buffer.prototype.readDoubleLE=function(e,r){return e>>>=0,r||checkOffset(e,8,this.length),s.read(this,e,!0,52,8)},Buffer.prototype.readDoubleBE=function(e,r){return e>>>=0,r||checkOffset(e,8,this.length),s.read(this,e,!1,52,8)},Buffer.prototype.writeUIntLE=function(e,r,i,o){if(e=+e,r>>>=0,i>>>=0,!o){var s=Math.pow(2,8*i)-1;checkInt(this,e,r,i,s,0)}var l=1,h=0;for(this[r]=255&e;++h<i&&(l*=256);)this[r+h]=e/l&255;return r+i},Buffer.prototype.writeUIntBE=function(e,r,i,o){if(e=+e,r>>>=0,i>>>=0,!o){var s=Math.pow(2,8*i)-1;checkInt(this,e,r,i,s,0)}var l=i-1,h=1;for(this[r+l]=255&e;--l>=0&&(h*=256);)this[r+l]=e/h&255;return r+i},Buffer.prototype.writeUInt8=function(e,r,i){return e=+e,r>>>=0,i||checkInt(this,e,r,1,255,0),this[r]=255&e,r+1},Buffer.prototype.writeUInt16LE=function(e,r,i){return e=+e,r>>>=0,i||checkInt(this,e,r,2,65535,0),this[r]=255&e,this[r+1]=e>>>8,r+2},Buffer.prototype.writeUInt16BE=function(e,r,i){return e=+e,r>>>=0,i||checkInt(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=255&e,r+2},Buffer.prototype.writeUInt32LE=function(e,r,i){return e=+e,r>>>=0,i||checkInt(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=255&e,r+4},Buffer.prototype.writeUInt32BE=function(e,r,i){return e=+e,r>>>=0,i||checkInt(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e,r+4},Buffer.prototype.writeIntLE=function(e,r,i,o){if(e=+e,r>>>=0,!o){var s=Math.pow(2,8*i-1);checkInt(this,e,r,i,s-1,-s)}var l=0,h=1,d=0;for(this[r]=255&e;++l<i&&(h*=256);)e<0&&0===d&&0!==this[r+l-1]&&(d=1),this[r+l]=(e/h>>0)-d&255;return r+i},Buffer.prototype.writeIntBE=function(e,r,i,o){if(e=+e,r>>>=0,!o){var s=Math.pow(2,8*i-1);checkInt(this,e,r,i,s-1,-s)}var l=i-1,h=1,d=0;for(this[r+l]=255&e;--l>=0&&(h*=256);)e<0&&0===d&&0!==this[r+l+1]&&(d=1),this[r+l]=(e/h>>0)-d&255;return r+i},Buffer.prototype.writeInt8=function(e,r,i){return e=+e,r>>>=0,i||checkInt(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=255&e,r+1},Buffer.prototype.writeInt16LE=function(e,r,i){return e=+e,r>>>=0,i||checkInt(this,e,r,2,32767,-32768),this[r]=255&e,this[r+1]=e>>>8,r+2},Buffer.prototype.writeInt16BE=function(e,r,i){return e=+e,r>>>=0,i||checkInt(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=255&e,r+2},Buffer.prototype.writeInt32LE=function(e,r,i){return e=+e,r>>>=0,i||checkInt(this,e,r,4,2147483647,-2147483648),this[r]=255&e,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4},Buffer.prototype.writeInt32BE=function(e,r,i){return e=+e,r>>>=0,i||checkInt(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e,r+4},Buffer.prototype.writeFloatLE=function(e,r,i){return writeFloat(this,e,r,!0,i)},Buffer.prototype.writeFloatBE=function(e,r,i){return writeFloat(this,e,r,!1,i)},Buffer.prototype.writeDoubleLE=function(e,r,i){return writeDouble(this,e,r,!0,i)},Buffer.prototype.writeDoubleBE=function(e,r,i){return writeDouble(this,e,r,!1,i)},Buffer.prototype.copy=function(e,r,i,o){if(!Buffer.isBuffer(e))throw TypeError("argument should be a Buffer");if(i||(i=0),o||0===o||(o=this.length),r>=e.length&&(r=e.length),r||(r=0),o>0&&o<i&&(o=i),o===i||0===e.length||0===this.length)return 0;if(r<0)throw RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw RangeError("Index out of range");if(o<0)throw RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-r<o-i&&(o=e.length-r+i);var s=o-i;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,i,o);else if(this===e&&i<r&&r<o)for(var l=s-1;l>=0;--l)e[l+r]=this[l+i];else Uint8Array.prototype.set.call(e,this.subarray(i,o),r);return s},Buffer.prototype.fill=function(e,r,i,o){if("string"==typeof e){if("string"==typeof r?(o=r,r=0,i=this.length):"string"==typeof i&&(o=i,i=this.length),void 0!==o&&"string"!=typeof o)throw TypeError("encoding must be a string");if("string"==typeof o&&!Buffer.isEncoding(o))throw TypeError("Unknown encoding: "+o);if(1===e.length){var s,l=e.charCodeAt(0);("utf8"===o&&l<128||"latin1"===o)&&(e=l)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(r<0||this.length<r||this.length<i)throw RangeError("Out of range index");if(i<=r)return this;if(r>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(s=r;s<i;++s)this[s]=e;else{var h=Buffer.isBuffer(e)?e:Buffer.from(e,o),d=h.length;if(0===d)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-r;++s)this[s+r]=h[s%d]}return this};var h=/[^+/0-9A-Za-z-_]/g;function base64clean(e){if((e=(e=e.split("=")[0]).trim().replace(h,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function utf8ToBytes(e,r){r=r||1/0;for(var i,o=e.length,s=null,l=[],h=0;h<o;++h){if((i=e.charCodeAt(h))>55295&&i<57344){if(!s){if(i>56319||h+1===o){(r-=3)>-1&&l.push(239,191,189);continue}s=i;continue}if(i<56320){(r-=3)>-1&&l.push(239,191,189),s=i;continue}i=(s-55296<<10|i-56320)+65536}else s&&(r-=3)>-1&&l.push(239,191,189);if(s=null,i<128){if((r-=1)<0)break;l.push(i)}else if(i<2048){if((r-=2)<0)break;l.push(i>>6|192,63&i|128)}else if(i<65536){if((r-=3)<0)break;l.push(i>>12|224,i>>6&63|128,63&i|128)}else if(i<1114112){if((r-=4)<0)break;l.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}else throw Error("Invalid code point")}return l}function asciiToBytes(e){for(var r=[],i=0;i<e.length;++i)r.push(255&e.charCodeAt(i));return r}function utf16leToBytes(e,r){for(var i,o,s=[],l=0;l<e.length&&!((r-=2)<0);++l)o=(i=e.charCodeAt(l))>>8,s.push(i%256),s.push(o);return s}function base64ToBytes(e){return o.toByteArray(base64clean(e))}function blitBuffer(e,r,i,o){for(var s=0;s<o&&!(s+i>=r.length)&&!(s>=e.length);++s)r[s+i]=e[s];return s}function isInstance(e,r){return e instanceof r||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===r.name}var d=function(){for(var e="0123456789abcdef",r=Array(256),i=0;i<16;++i)for(var o=16*i,s=0;s<16;++s)r[o+s]=e[i]+e[s];return r}()},783:function(e,r){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */r.read=function(e,r,i,o,s){var l,h,d=8*s-o-1,f=(1<<d)-1,_=f>>1,g=-7,A=i?s-1:0,b=i?-1:1,k=e[r+A];for(A+=b,l=k&(1<<-g)-1,k>>=-g,g+=d;g>0;l=256*l+e[r+A],A+=b,g-=8);for(h=l&(1<<-g)-1,l>>=-g,g+=o;g>0;h=256*h+e[r+A],A+=b,g-=8);if(0===l)l=1-_;else{if(l===f)return h?NaN:(k?-1:1)*(1/0);h+=Math.pow(2,o),l-=_}return(k?-1:1)*h*Math.pow(2,l-o)},r.write=function(e,r,i,o,s,l){var h,d,f,_=8*l-s-1,g=(1<<_)-1,A=g>>1,b=23===s?5960464477539062e-23:0,k=o?0:l-1,M=o?1:-1,j=r<0||0===r&&1/r<0?1:0;for(isNaN(r=Math.abs(r))||r===1/0?(d=isNaN(r)?1:0,h=g):(h=Math.floor(Math.log(r)/Math.LN2),r*(f=Math.pow(2,-h))<1&&(h--,f*=2),h+A>=1?r+=b/f:r+=b*Math.pow(2,1-A),r*f>=2&&(h++,f/=2),h+A>=g?(d=0,h=g):h+A>=1?(d=(r*f-1)*Math.pow(2,s),h+=A):(d=r*Math.pow(2,A-1)*Math.pow(2,s),h=0));s>=8;e[i+k]=255&d,k+=M,d/=256,s-=8);for(h=h<<s|d,_+=s;_>0;e[i+k]=255&h,k+=M,h/=256,_-=8);e[i+k-M]|=128*j}}},i={};function __nccwpck_require__(e){var o=i[e];if(void 0!==o)return o.exports;var s=i[e]={exports:{}},l=!0;try{r[e](s,s.exports,__nccwpck_require__),l=!1}finally{l&&delete i[e]}return s.exports}__nccwpck_require__.ab="//";var o=__nccwpck_require__(72);e.exports=o}()},2352:function(){},7663:function(e){!function(){var r={229:function(e){var r,i,o,s=e.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(e){if(r===setTimeout)return setTimeout(e,0);if((r===defaultSetTimout||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(i){try{return r.call(null,e,0)}catch(i){return r.call(this,e,0)}}}function runClearTimeout(e){if(i===clearTimeout)return clearTimeout(e);if((i===defaultClearTimeout||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{return i(e)}catch(r){try{return i.call(null,e)}catch(r){return i.call(this,e)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){r=defaultSetTimout}try{i="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){i=defaultClearTimeout}}();var l=[],h=!1,d=-1;function cleanUpNextTick(){h&&o&&(h=!1,o.length?l=o.concat(l):d=-1,l.length&&drainQueue())}function drainQueue(){if(!h){var e=runTimeout(cleanUpNextTick);h=!0;for(var r=l.length;r;){for(o=l,l=[];++d<r;)o&&o[d].run();d=-1,r=l.length}o=null,h=!1,runClearTimeout(e)}}function Item(e,r){this.fun=e,this.array=r}function noop(){}s.nextTick=function(e){var r=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)r[i-1]=arguments[i];l.push(new Item(e,r)),1!==l.length||h||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=noop,s.addListener=noop,s.once=noop,s.off=noop,s.removeListener=noop,s.removeAllListeners=noop,s.emit=noop,s.prependListener=noop,s.prependOnceListener=noop,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},i={};function __nccwpck_require__(e){var o=i[e];if(void 0!==o)return o.exports;var s=i[e]={exports:{}},l=!0;try{r[e](s,s.exports,__nccwpck_require__),l=!1}finally{l&&delete i[e]}return s.exports}__nccwpck_require__.ab="//";var o=__nccwpck_require__(229);e.exports=o}()},1664:function(e,r,i){e.exports=i(5170)},1163:function(e,r,i){e.exports=i(9974)},1476:function(e,r,i){"use strict";var o=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(i(5174)),s=i(6678);function StyleToJS(e,r){var i={};return e&&"string"==typeof e&&(0,o.default)(e,function(e,o){e&&o&&(i[(0,s.camelCase)(e,r)]=o)}),i}StyleToJS.default=StyleToJS,e.exports=StyleToJS},6678:function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.camelCase=void 0;var i=/^--[a-zA-Z0-9_-]+$/,o=/-([a-z])/g,s=/^[^-]+$/,l=/^-(webkit|moz|ms|o|khtml)-/,h=/^-(ms)-/,capitalize=function(e,r){return r.toUpperCase()},trimHyphen=function(e,r){return"".concat(r,"-")};r.camelCase=function(e,r){var d;return(void 0===r&&(r={}),!(d=e)||s.test(d)||i.test(d))?e:(e=e.toLowerCase(),(e=r.reactCompat?e.replace(h,trimHyphen):e.replace(l,trimHyphen)).replace(o,capitalize))}},5174:function(e,r,i){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.default=StyleToObject;let s=o(i(5321));function StyleToObject(e,r){let i=null;if(!e||"string"!=typeof e)return i;let o=(0,s.default)(e),l="function"==typeof r;return o.forEach(e=>{if("declaration"!==e.type)return;let{property:o,value:s}=e;l?r(o,s,e):s&&((i=i||{})[o]=s)}),i}},6771:function(e,r,i){"use strict";let o,s;i.d(r,{Jn:function(){return el},qX:function(){return _getProvider},rh:function(){return _isFirebaseServerApp},Xd:function(){return _registerComponent},Mq:function(){return getApp},C6:function(){return getApps},ZF:function(){return initializeApp},KN:function(){return registerVersion}});var l=i(75),h=i(4645),d=i(9711);let instanceOfAny=(e,r)=>r.some(r=>e instanceof r);function getIdbProxyableTypes(){return o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let f=new WeakMap,_=new WeakMap,g=new WeakMap,A=new WeakMap,b=new WeakMap;function promisifyRequest(e){let r=new Promise((r,i)=>{let unlisten=()=>{e.removeEventListener("success",success),e.removeEventListener("error",error)},success=()=>{r(wrap_idb_value_wrap(e.result)),unlisten()},error=()=>{i(e.error),unlisten()};e.addEventListener("success",success),e.addEventListener("error",error)});return r.then(r=>{r instanceof IDBCursor&&f.set(r,e)}).catch(()=>{}),b.set(r,e),r}function cacheDonePromiseForTransaction(e){if(_.has(e))return;let r=new Promise((r,i)=>{let unlisten=()=>{e.removeEventListener("complete",complete),e.removeEventListener("error",error),e.removeEventListener("abort",error)},complete=()=>{r(),unlisten()},error=()=>{i(e.error||new DOMException("AbortError","AbortError")),unlisten()};e.addEventListener("complete",complete),e.addEventListener("error",error),e.addEventListener("abort",error)});_.set(e,r)}let k={get(e,r,i){if(e instanceof IDBTransaction){if("done"===r)return _.get(e);if("objectStoreNames"===r)return e.objectStoreNames||g.get(e);if("store"===r)return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return wrap_idb_value_wrap(e[r])},set:(e,r,i)=>(e[r]=i,!0),has:(e,r)=>e instanceof IDBTransaction&&("done"===r||"store"===r)||r in e};function replaceTraps(e){k=e(k)}function wrapFunction(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?getCursorAdvanceMethods().includes(e)?function(...r){return e.apply(unwrap(this),r),wrap_idb_value_wrap(f.get(this))}:function(...r){return wrap_idb_value_wrap(e.apply(unwrap(this),r))}:function(r,...i){let o=e.call(unwrap(this),r,...i);return g.set(o,r.sort?r.sort():[r]),wrap_idb_value_wrap(o)}}function transformCachableValue(e){return"function"==typeof e?wrapFunction(e):(e instanceof IDBTransaction&&cacheDonePromiseForTransaction(e),instanceOfAny(e,getIdbProxyableTypes()))?new Proxy(e,k):e}function wrap_idb_value_wrap(e){if(e instanceof IDBRequest)return promisifyRequest(e);if(A.has(e))return A.get(e);let r=transformCachableValue(e);return r!==e&&(A.set(e,r),b.set(r,e)),r}let unwrap=e=>b.get(e);function openDB(e,r,{blocked:i,upgrade:o,blocking:s,terminated:l}={}){let h=indexedDB.open(e,r),d=wrap_idb_value_wrap(h);return o&&h.addEventListener("upgradeneeded",e=>{o(wrap_idb_value_wrap(h.result),e.oldVersion,e.newVersion,wrap_idb_value_wrap(h.transaction),e)}),i&&h.addEventListener("blocked",e=>i(e.oldVersion,e.newVersion,e)),d.then(e=>{l&&e.addEventListener("close",()=>l()),s&&e.addEventListener("versionchange",e=>s(e.oldVersion,e.newVersion,e))}).catch(()=>{}),d}let M=["get","getKey","getAll","getAllKeys","count"],j=["put","add","delete","clear"],q=new Map;function getMethod(e,r){if(!(e instanceof IDBDatabase&&!(r in e)&&"string"==typeof r))return;if(q.get(r))return q.get(r);let i=r.replace(/FromIndex$/,""),o=r!==i,s=j.includes(i);if(!(i in(o?IDBIndex:IDBObjectStore).prototype)||!(s||M.includes(i)))return;let method=async function(e,...r){let l=this.transaction(e,s?"readwrite":"readonly"),h=l.store;return o&&(h=h.index(r.shift())),(await Promise.all([h[i](...r),s&&l.done]))[0]};return q.set(r,method),method}replaceTraps(e=>({...e,get:(r,i,o)=>getMethod(r,i)||e.get(r,i,o),has:(r,i)=>!!getMethod(r,i)||e.has(r,i)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PlatformLoggerServiceImpl=class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){let e=this.container.getProviders();return e.map(e=>{if(!isVersionServiceProvider(e))return null;{let r=e.getImmediate();return`${r.library}/${r.version}`}}).filter(e=>e).join(" ")}};function isVersionServiceProvider(e){let r=e.getComponent();return r?.type==="VERSION"}let $="@firebase/app",ee="0.14.6",et=new h.Yd("@firebase/app"),en="[DEFAULT]",er={[$]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},ei=new Map,eo=new Map,es=new Map;function _addComponent(e,r){try{e.container.addComponent(r)}catch(i){et.debug(`Component ${r.name} failed to register with FirebaseApp ${e.name}`,i)}}function _registerComponent(e){let r=e.name;if(es.has(r))return et.debug(`There were multiple attempts to register component ${r}.`),!1;for(let i of(es.set(r,e),ei.values()))_addComponent(i,e);for(let r of eo.values())_addComponent(r,e);return!0}function _getProvider(e,r){let i=e.container.getProvider("heartbeat").getImmediate({optional:!0});return i&&i.triggerHeartbeat(),e.container.getProvider(r)}function _isFirebaseServerApp(e){return null!=e&&void 0!==e.settings}let ea=new d.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FirebaseAppImpl=class FirebaseAppImpl{constructor(e,r,i){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new l.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ea.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let el="12.6.0";function initializeApp(e,r={}){let i=e;if("object"!=typeof r){let e=r;r={name:e}}let o={name:en,automaticDataCollectionEnabled:!0,...r},s=o.name;if("string"!=typeof s||!s)throw ea.create("bad-app-name",{appName:String(s)});if(i||(i=(0,d.aH)()),!i)throw ea.create("no-options");let h=ei.get(s);if(h){if((0,d.vZ)(i,h.options)&&(0,d.vZ)(o,h.config))return h;throw ea.create("duplicate-app",{appName:s})}let f=new l.H0(s);for(let e of es.values())f.addComponent(e);let _=new FirebaseAppImpl(i,o,f);return ei.set(s,_),_}function getApp(e=en){let r=ei.get(e);if(!r&&e===en&&(0,d.aH)())return initializeApp();if(!r)throw ea.create("no-app",{appName:e});return r}function getApps(){return Array.from(ei.values())}function registerVersion(e,r,i){let o=er[e]??e;i&&(o+=`-${i}`);let s=o.match(/\s|\//),h=r.match(/\s|\//);if(s||h){let e=[`Unable to register library "${o}" with version "${r}":`];s&&e.push(`library name "${o}" contains illegal characters (whitespace or "/")`),s&&h&&e.push("and"),h&&e.push(`version name "${r}" contains illegal characters (whitespace or "/")`),et.warn(e.join(" "));return}_registerComponent(new l.wA(`${o}-version`,()=>({library:o,version:r}),"VERSION"))}let eu="firebase-heartbeat-store",eh=null;function getDbPromise(){return eh||(eh=openDB("firebase-heartbeat-database",1,{upgrade:(e,r)=>{if(0===r)try{e.createObjectStore(eu)}catch(e){console.warn(e)}}}).catch(e=>{throw ea.create("idb-open",{originalErrorMessage:e.message})})),eh}async function readHeartbeatsFromIndexedDB(e){try{let r=await getDbPromise(),i=r.transaction(eu),o=await i.objectStore(eu).get(computeKey(e));return await i.done,o}catch(e){if(e instanceof d.ZR)et.warn(e.message);else{let r=ea.create("idb-get",{originalErrorMessage:e?.message});et.warn(r.message)}}}async function writeHeartbeatsToIndexedDB(e,r){try{let i=await getDbPromise(),o=i.transaction(eu,"readwrite"),s=o.objectStore(eu);await s.put(r,computeKey(e)),await o.done}catch(e){if(e instanceof d.ZR)et.warn(e.message);else{let r=ea.create("idb-set",{originalErrorMessage:e?.message});et.warn(r.message)}}}function computeKey(e){return`${e.name}!${e.options.appId}`}let HeartbeatServiceImpl=class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;let r=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(r),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider("platform-logger").getImmediate(),r=e.getPlatformInfoString(),i=getUTCDateString();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(e=>e.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>30){let e=getEarliestHeartbeatIdx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){et.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let e=getUTCDateString(),{heartbeatsToSend:r,unsentEntries:i}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),o=(0,d.L)(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return et.warn(e),""}}};function getUTCDateString(){let e=new Date;return e.toISOString().substring(0,10)}function extractHeartbeatsForHeader(e,r=1024){let i=[],o=e.slice();for(let s of e){let e=i.find(e=>e.agent===s.agent);if(e){if(e.dates.push(s.date),countBytes(i)>r){e.dates.pop();break}}else if(i.push({agent:s.agent,dates:[s.date]}),countBytes(i)>r){i.pop();break}o=o.slice(1)}return{heartbeatsToSend:i,unsentEntries:o}}let HeartbeatStorageImpl=class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,d.hl)()&&(0,d.eu)().then(()=>!0).catch(()=>!1)}async read(){let e=await this._canUseIndexedDBPromise;if(!e)return{heartbeats:[]};{let e=await readHeartbeatsFromIndexedDB(this.app);return e?.heartbeats?e:{heartbeats:[]}}}async overwrite(e){let r=await this._canUseIndexedDBPromise;if(r){let r=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){let r=await this._canUseIndexedDBPromise;if(r){let r=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}};function countBytes(e){return(0,d.L)(JSON.stringify({version:2,heartbeats:e})).length}function getEarliestHeartbeatIdx(e){if(0===e.length)return -1;let r=0,i=e[0].date;for(let o=1;o<e.length;o++)e[o].date<i&&(i=e[o].date,r=o);return r}_registerComponent(new l.wA("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new l.wA("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion($,ee,""),registerVersion($,ee,"esm2020"),registerVersion("fire-js","")},75:function(e,r,i){"use strict";i.d(r,{H0:function(){return ComponentContainer},wA:function(){return Component}});var o=i(9711);let Component=class Component{constructor(e,r,i){this.name=e,this.instanceFactory=r,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let s="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Provider=class Provider{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){let e=new o.BH;if(this.instancesDeferred.set(r,e),this.isInitialized(r)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:r});i&&e.resolve(i)}catch(e){}}return this.instancesDeferred.get(r).promise}getImmediate(e){let r=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(e){if(i)return null;throw e}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(isComponentEager(e))try{this.getOrInitializeService({instanceIdentifier:s})}catch(e){}for(let[e,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:i});r.resolve(e)}catch(e){}}}}clearInstance(e=s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=s){return this.instances.has(e)}getOptions(e=s){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:r={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let o=this.getOrInitializeService({instanceIdentifier:i,options:r});for(let[e,r]of this.instancesDeferred.entries()){let s=this.normalizeInstanceIdentifier(e);i===s&&r.resolve(o)}return o}onInit(e,r){let i=this.normalizeInstanceIdentifier(r),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);let s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){let i=this.onInitCallbacks.get(r);if(i)for(let o of i)try{o(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(e),options:r}),this.instances.set(e,i),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=s){return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}};function normalizeIdentifierForFactory(e){return e===s?void 0:e}function isComponentEager(e){return"EAGER"===e.instantiationMode}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ComponentContainer=class ComponentContainer{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let r=this.getProvider(e.name);if(r.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){let r=this.getProvider(e.name);r.isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let r=new Provider(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}},4645:function(e,r,i){"use strict";var o,s;i.d(r,{Yd:function(){return Logger},in:function(){return o}});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l=[];(s=o||(o={}))[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT";let h={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},d=o.INFO,f={[o.DEBUG]:"log",[o.VERBOSE]:"log",[o.INFO]:"info",[o.WARN]:"warn",[o.ERROR]:"error"},defaultLogHandler=(e,r,...i)=>{if(r<e.logLevel)return;let o=new Date().toISOString(),s=f[r];if(s)console[s](`[${o}]  ${e.name}:`,...i);else throw Error(`Attempted to log a message with an invalid logType (value: ${r})`)};let Logger=class Logger{constructor(e){this.name=e,this._logLevel=d,this._logHandler=defaultLogHandler,this._userLogHandler=null,l.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in o))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?h[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,o.DEBUG,...e),this._logHandler(this,o.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,o.VERBOSE,...e),this._logHandler(this,o.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,o.INFO,...e),this._logHandler(this,o.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,o.WARN,...e),this._logHandler(this,o.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,o.ERROR,...e),this._logHandler(this,o.ERROR,...e)}}},2753:function(e,r,i){"use strict";i.d(r,{hJ:function(){return GoogleAuthProvider},v0:function(){return getAuth},Aj:function(){return onAuthStateChanged},rh:function(){return signInWithPopup},w7:function(){return signOut}});var o=i(6771),s=i(9711),l=i(4645),h=i(75);function _prodErrorMap(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let d=_prodErrorMap,f=new s.LL("auth","Firebase",_prodErrorMap()),_=new l.Yd("@firebase/auth");function _logWarn(e,...r){_.logLevel<=l.in.WARN&&_.warn(`Auth (${o.Jn}): ${e}`,...r)}function _logError(e,...r){_.logLevel<=l.in.ERROR&&_.error(`Auth (${o.Jn}): ${e}`,...r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(e,...r){throw createErrorInternal(e,...r)}function _createError(e,...r){return createErrorInternal(e,...r)}function _errorWithCustomMessage(e,r,i){let o={...d(),[r]:i},l=new s.LL("auth","Firebase",o);return l.create(r,{appName:e.name})}function _serverAppCurrentUserOperationNotSupportedError(e){return _errorWithCustomMessage(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _assertInstanceOf(e,r,i){if(!(r instanceof i))throw i.name!==r.constructor.name&&_fail(e,"argument-error"),_errorWithCustomMessage(e,"argument-error",`Type of ${r.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function createErrorInternal(e,...r){if("string"!=typeof e){let i=r[0],o=[...r.slice(1)];return o[0]&&(o[0].appName=e.name),e._errorFactory.create(i,...o)}return f.create(e,...r)}function _assert(e,r,...i){if(!e)throw createErrorInternal(r,...i)}function debugFail(e){let r="INTERNAL ASSERTION FAILED: "+e;throw _logError(r),Error(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){return"undefined"!=typeof self&&self.location?.href||""}function _isHttpOrHttps(){return"http:"===_getCurrentScheme()||"https:"===_getCurrentScheme()}function _getCurrentScheme(){return"undefined"!=typeof self&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isOnline(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(_isHttpOrHttps()||(0,s.ru)()||"connection"in navigator))||navigator.onLine}function _getUserLanguage(){if("undefined"==typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Delay=class Delay{constructor(e,r){this.shortDelay=e,this.longDelay=r,r>e||debugFail("Short delay should be less than long delay!"),this.isMobile=(0,s.uI)()||(0,s.b$)()}get(){return _isOnline()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(e,r){e.emulator||debugFail("Emulator should always be set here");let{url:i}=e.emulator;return r?`${i}${r.startsWith("/")?r.slice(1):r}`:i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FetchProvider=class FetchProvider{static initialize(e,r,i){this.fetchImpl=e,r&&(this.headersImpl=r),i&&(this.responseImpl=i)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let g={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},A=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],b=new Delay(3e4,6e4);function _addTidIfNecessary(e,r){return e.tenantId&&!r.tenantId?{...r,tenantId:e.tenantId}:r}async function _performApiRequest(e,r,i,o,l={}){return _performFetchWithErrorHandling(e,l,async()=>{let l={},h={};o&&("GET"===r?h=o:l={body:JSON.stringify(o)});let d=(0,s.xO)({key:e.config.apiKey,...h}).slice(1),f=await e._getAdditionalHeaders();f["Content-Type"]="application/json",e.languageCode&&(f["X-Firebase-Locale"]=e.languageCode);let _={method:r,headers:f,...l};return(0,s.L_)()||(_.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,s.Xx)(e.emulatorConfig.host)&&(_.credentials="include"),FetchProvider.fetch()(await _getFinalTarget(e,e.config.apiHost,i,d),_)})}async function _performFetchWithErrorHandling(e,r,i){e._canInitEmulator=!1;let o={...g,...r};try{let r=new NetworkTimeout(e),s=await Promise.race([i(),r.promise]);r.clearNetworkTimeout();let l=await s.json();if("needConfirmation"in l)throw _makeTaggedError(e,"account-exists-with-different-credential",l);if(s.ok&&!("errorMessage"in l))return l;{let r=s.ok?l.errorMessage:l.error.message,[i,h]=r.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===i)throw _makeTaggedError(e,"credential-already-in-use",l);if("EMAIL_EXISTS"===i)throw _makeTaggedError(e,"email-already-in-use",l);if("USER_DISABLED"===i)throw _makeTaggedError(e,"user-disabled",l);let d=o[i]||i.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw _errorWithCustomMessage(e,d,h);_fail(e,d)}}catch(r){if(r instanceof s.ZR)throw r;_fail(e,"network-request-failed",{message:String(r)})}}async function _performSignInRequest(e,r,i,o,s={}){let l=await _performApiRequest(e,r,i,o,s);return"mfaPendingCredential"in l&&_fail(e,"multi-factor-auth-required",{_serverResponse:l}),l}async function _getFinalTarget(e,r,i,o){let s=`${r}${i}?${o}`,l=e.config.emulator?_emulatorUrl(e.config,s):`${e.config.apiScheme}://${s}`;if(A.includes(i)&&(await e._persistenceManagerAvailable,"COOKIE"===e._getPersistenceType())){let r=e._getPersistence();return r._getFinalTarget(l).toString()}return l}function _parseEnforcementState(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}let NetworkTimeout=class NetworkTimeout{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(_createError(this.auth,"network-request-failed")),b.get())})}};function _makeTaggedError(e,r,i){let o={appName:e.name};i.email&&(o.email=i.email),i.phoneNumber&&(o.phoneNumber=i.phoneNumber);let s=_createError(e,r,o);return s.customData._tokenResponse=i,s}function isEnterprise(e){return void 0!==e&&void 0!==e.enterprise}let RecaptchaConfig=class RecaptchaConfig{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return _parseEnforcementState(r.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};async function getRecaptchaConfig(e,r){return _performApiRequest(e,"GET","/v2/recaptchaConfig",_addTidIfNecessary(e,r))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function deleteAccount(e,r){return _performApiRequest(e,"POST","/v1/accounts:delete",r)}async function getAccountInfo(e,r){return _performApiRequest(e,"POST","/v1/accounts:lookup",r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(e){if(e)try{let r=new Date(Number(e));if(!isNaN(r.getTime()))return r.toUTCString()}catch(e){}}async function getIdTokenResult(e,r=!1){let i=(0,s.m9)(e),o=await i.getIdToken(r),l=_parseToken(o);_assert(l&&l.exp&&l.auth_time&&l.iat,i.auth,"internal-error");let h="object"==typeof l.firebase?l.firebase:void 0,d=h?.sign_in_provider;return{claims:l,token:o,authTime:utcTimestampToDateString(secondsStringToMilliseconds(l.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(l.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(l.exp)),signInProvider:d||null,signInSecondFactor:h?.sign_in_second_factor||null}}function secondsStringToMilliseconds(e){return 1e3*Number(e)}function _parseToken(e){let[r,i,o]=e.split(".");if(void 0===r||void 0===i||void 0===o)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{let e=(0,s.tV)(i);if(!e)return _logError("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(e){return _logError("Caught error parsing JWT payload as JSON",e?.toString()),null}}function _tokenExpiresIn(e){let r=_parseToken(e);return _assert(r,"internal-error"),_assert(void 0!==r.exp,"internal-error"),_assert(void 0!==r.iat,"internal-error"),Number(r.exp)-Number(r.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _logoutIfInvalidated(e,r,i=!1){if(i)return r;try{return await r}catch(r){throw r instanceof s.ZR&&isUserInvalidated(r)&&e.auth.currentUser===e&&await e.auth.signOut(),r}}function isUserInvalidated({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ProactiveRefresh=class ProactiveRefresh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){let e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;let e=this.user.stsTokenManager.expirationTime??0,r=e-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let UserMetadata=class UserMetadata{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reloadWithoutSaving(e){let r=e.auth,i=await e.getIdToken(),o=await _logoutIfInvalidated(e,getAccountInfo(r,{idToken:i}));_assert(o?.users.length,r,"internal-error");let s=o.users[0];e._notifyReloadListener(s);let l=s.providerUserInfo?.length?extractProviderData(s.providerUserInfo):[],h=mergeProviderData(e.providerData,l),d=e.isAnonymous,f=!(e.email&&s.passwordHash)&&!h?.length,_={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:h,metadata:new UserMetadata(s.createdAt,s.lastLoginAt),isAnonymous:!!d&&f};Object.assign(e,_)}async function reload(e){let r=(0,s.m9)(e);await _reloadWithoutSaving(r),await r.auth._persistUserIfCurrent(r),r.auth._notifyListenersIfCurrent(r)}function mergeProviderData(e,r){let i=e.filter(e=>!r.some(r=>r.providerId===e.providerId));return[...i,...r]}function extractProviderData(e){return e.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function requestStsToken(e,r){let i=await _performFetchWithErrorHandling(e,{},async()=>{let i=(0,s.xO)({grant_type:"refresh_token",refresh_token:r}).slice(1),{tokenApiHost:o,apiKey:l}=e.config,h=await _getFinalTarget(e,o,"/v1/token",`key=${l}`),d=await e._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";let f={method:"POST",headers:d,body:i};return e.emulatorConfig&&(0,s.Xx)(e.emulatorConfig.host)&&(f.credentials="include"),FetchProvider.fetch()(h,f)});return{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token}}async function revokeToken(e,r){return _performApiRequest(e,"POST","/v2/accounts:revokeToken",_addTidIfNecessary(e,r))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let StsTokenManager=class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_assert(e.idToken,"internal-error"),_assert(void 0!==e.idToken,"internal-error"),_assert(void 0!==e.refreshToken,"internal-error");let r="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):_tokenExpiresIn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){_assert(0!==e.length,"internal-error");let r=_tokenExpiresIn(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return r||!this.accessToken||this.isExpired?(_assert(this.refreshToken,e,"user-token-expired"),this.refreshToken)?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){let{accessToken:i,refreshToken:o,expiresIn:s}=await requestStsToken(e,r);this.updateTokensAndExpiration(i,o,Number(s))}updateTokensAndExpiration(e,r,i){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*i}static fromJSON(e,r){let{refreshToken:i,accessToken:o,expirationTime:s}=r,l=new StsTokenManager;return i&&(_assert("string"==typeof i,"internal-error",{appName:e}),l.refreshToken=i),o&&(_assert("string"==typeof o,"internal-error",{appName:e}),l.accessToken=o),s&&(_assert("number"==typeof s,"internal-error",{appName:e}),l.expirationTime=s),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(e,r){_assert("string"==typeof e||void 0===e,"internal-error",{appName:r})}let UserImpl=class UserImpl{constructor({uid:e,auth:r,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new UserMetadata(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){let r=await _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,e));return _assert(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return getIdTokenResult(this,e)}reload(){return reload(this)}_assign(e){this!==e&&(_assert(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let r=new UserImpl({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){_assert(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),r&&await _reloadWithoutSaving(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,o.rh)(this.auth.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this.auth));let e=await this.getIdToken();return await _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){let i=r.displayName??void 0,o=r.email??void 0,s=r.phoneNumber??void 0,l=r.photoURL??void 0,h=r.tenantId??void 0,d=r._redirectEventId??void 0,f=r.createdAt??void 0,_=r.lastLoginAt??void 0,{uid:g,emailVerified:A,isAnonymous:b,providerData:k,stsTokenManager:M}=r;_assert(g&&M,e,"internal-error");let j=StsTokenManager.fromJSON(this.name,M);_assert("string"==typeof g,e,"internal-error"),assertStringOrUndefined(i,e.name),assertStringOrUndefined(o,e.name),_assert("boolean"==typeof A,e,"internal-error"),_assert("boolean"==typeof b,e,"internal-error"),assertStringOrUndefined(s,e.name),assertStringOrUndefined(l,e.name),assertStringOrUndefined(h,e.name),assertStringOrUndefined(d,e.name),assertStringOrUndefined(f,e.name),assertStringOrUndefined(_,e.name);let q=new UserImpl({uid:g,auth:e,email:o,emailVerified:A,displayName:i,isAnonymous:b,photoURL:l,phoneNumber:s,tenantId:h,stsTokenManager:j,createdAt:f,lastLoginAt:_});return k&&Array.isArray(k)&&(q.providerData=k.map(e=>({...e}))),d&&(q._redirectEventId=d),q}static async _fromIdTokenResponse(e,r,i=!1){let o=new StsTokenManager;o.updateFromServerResponse(r);let s=new UserImpl({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await _reloadWithoutSaving(s),s}static async _fromGetAccountInfoResponse(e,r,i){let o=r.users[0];_assert(void 0!==o.localId,"internal-error");let s=void 0!==o.providerUserInfo?extractProviderData(o.providerUserInfo):[],l=!(o.email&&o.passwordHash)&&!s?.length,h=new StsTokenManager;h.updateFromIdToken(i);let d=new UserImpl({uid:o.localId,auth:e,stsTokenManager:h,isAnonymous:l}),f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:s,metadata:new UserMetadata(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!s?.length};return Object.assign(d,f),d}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let k=new Map;function _getInstance(e){e instanceof Function||debugFail("Expected a class definition");let r=k.get(e);return r?r instanceof e||debugFail("Instance stored in cache mismatched with class"):(r=new e,k.set(e,r)),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let InMemoryPersistence=class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){let r=this.storage[e];return void 0===r?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(e,r,i){return`firebase:${e}:${r}:${i}`}InMemoryPersistence.type="NONE";let PersistenceUserManager=class PersistenceUserManager{constructor(e,r,i){this.persistence=e,this.auth=r,this.userKey=i;let{config:o,name:s}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,o.apiKey,s),this.fullPersistenceKey=_persistenceKeyName("persistence",o.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){let r=await getAccountInfo(this.auth,{idToken:e}).catch(()=>void 0);return r?UserImpl._fromGetAccountInfoResponse(this.auth,r,e):null}return UserImpl._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,i="authUser"){if(!r.length)return new PersistenceUserManager(_getInstance(InMemoryPersistence),e,i);let o=(await Promise.all(r.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),s=o[0]||_getInstance(InMemoryPersistence),l=_persistenceKeyName(i,e.config.apiKey,e.name),h=null;for(let i of r)try{let r=await i._get(l);if(r){let o;if("string"==typeof r){let i=await getAccountInfo(e,{idToken:r}).catch(()=>void 0);if(!i)break;o=await UserImpl._fromGetAccountInfoResponse(e,i,r)}else o=UserImpl._fromJSON(e,r);i!==s&&(h=o),s=i;break}}catch{}let d=o.filter(e=>e._shouldAllowMigration);return s._shouldAllowMigration&&d.length&&(s=d[0],h&&await s._set(l,h.toJSON()),await Promise.all(r.map(async e=>{if(e!==s)try{await e._remove(l)}catch{}}))),new PersistenceUserManager(s,e,i)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(e){let r=e.toLowerCase();if(r.includes("opera/")||r.includes("opr/")||r.includes("opios/"))return"Opera";if(_isIEMobile(r))return"IEMobile";if(r.includes("msie")||r.includes("trident/"))return"IE";{if(r.includes("edge/"))return"Edge";if(_isFirefox(r))return"Firefox";if(r.includes("silk/"))return"Silk";if(_isBlackBerry(r))return"Blackberry";if(_isWebOS(r))return"Webos";if(_isSafari(r))return"Safari";if((r.includes("chrome/")||_isChromeIOS(r))&&!r.includes("edge/"))return"Chrome";if(_isAndroid(r))return"Android";let i=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(i?.length===2)return i[1]}return"Other"}function _isFirefox(e=(0,s.z$)()){return/firefox\//i.test(e)}function _isSafari(e=(0,s.z$)()){let r=e.toLowerCase();return r.includes("safari/")&&!r.includes("chrome/")&&!r.includes("crios/")&&!r.includes("android")}function _isChromeIOS(e=(0,s.z$)()){return/crios\//i.test(e)}function _isIEMobile(e=(0,s.z$)()){return/iemobile/i.test(e)}function _isAndroid(e=(0,s.z$)()){return/android/i.test(e)}function _isBlackBerry(e=(0,s.z$)()){return/blackberry/i.test(e)}function _isWebOS(e=(0,s.z$)()){return/webos/i.test(e)}function _isIOS(e=(0,s.z$)()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function _isIOSStandalone(e=(0,s.z$)()){return _isIOS(e)&&!!window.navigator?.standalone}function _isIE10(){return(0,s.w1)()&&10===document.documentMode}function _isMobileBrowser(e=(0,s.z$)()){return _isIOS(e)||_isAndroid(e)||_isWebOS(e)||_isBlackBerry(e)||/windows phone/i.test(e)||_isIEMobile(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(e,r=[]){let i;switch(e){case"Browser":i=_getBrowserName((0,s.z$)());break;case"Worker":i=`${_getBrowserName((0,s.z$)())}-${e}`;break;default:i=e}let l=r.length?r.join(","):"FirebaseCore-web";return`${i}/JsCore/${o.Jn}/${l}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AuthMiddlewareQueue=class AuthMiddlewareQueue{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){let wrappedCallback=r=>new Promise((i,o)=>{try{let o=e(r);i(o)}catch(e){o(e)}});wrappedCallback.onAbort=r,this.queue.push(wrappedCallback);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let r=[];try{for(let i of this.queue)await i(e),i.onAbort&&r.push(i.onAbort)}catch(e){for(let e of(r.reverse(),r))try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:e?.message})}}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getPasswordPolicy(e,r={}){return _performApiRequest(e,"GET","/v2/passwordPolicy",_addTidIfNecessary(e,r))}let PasswordPolicyImpl=class PasswordPolicyImpl{constructor(e){let r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??6,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),void 0!==r.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),void 0!==r.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),void 0!==r.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),void 0!==r.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){let i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(r.meetsMinPasswordLength=e.length>=i),o&&(r.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,r){let i;this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(r,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,r,i,o,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AuthImpl=class AuthImpl{constructor(e,r,i,o){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription(this),this.idTokenSubscription=new Subscription(this),this.beforeStateQueue=new AuthMiddlewareQueue(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=f,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=_getInstance(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await PersistenceUserManager.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let r=await getAccountInfo(this,{idToken:e}),i=await UserImpl._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(i)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if((0,o.rh)(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(r=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(r,r))}):this.directlySetCurrentUser(null)}let r=await this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let r=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!r||r===o)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return(_assert(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId)?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await _reloadWithoutSaving(e)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_getUserLanguage()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,o.rh)(this.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this));let r=e?(0,s.m9)(e):null;return r&&_assert(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&_assert(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,o.rh)(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,o.rh)(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_getInstance(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await _getPasswordPolicy(this),r=new PasswordPolicyImpl(e);null===this.tenantId?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new s.LL("auth","Firebase",e())}onAuthStateChanged(e,r,i){return this.registerStateListener(this.authStateSubscription,e,r,i)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,i){return this.registerStateListener(this.idTokenSubscription,e,r,i)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){let r=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};null!=this.tenantId&&(i.tenantId=this.tenantId),await revokeToken(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){let i=await this.getOrInitRedirectPersistenceManager(r);return null===e?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let r=e&&_getInstance(e)||this._popupRedirectResolver;_assert(r,this,"argument-error"),this.redirectPersistenceManager=await PersistenceUserManager.create(this,[_getInstance(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return(this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e)?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,i,o){if(this._deleted)return()=>{};let s="function"==typeof r?r:r.next.bind(r),l=!1,h=this._isInitialized?Promise.resolve():this._initializationPromise;if(_assert(h,this,"internal-error"),h.then(()=>{l||s(this.currentUser)}),"function"==typeof r){let s=e.addObserver(r,i,o);return()=>{l=!0,s()}}{let i=e.addObserver(r);return()=>{l=!0,i()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _assert(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);let i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if((0,o.rh)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&_logWarn(`Error while retrieving App Check token: ${e.error}`),e?.token}};function _castAuth(e){return(0,s.m9)(e)}let Subscription=class Subscription{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,s.ne)(e=>this.observer=e)}get next(){return _assert(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let M={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _setExternalJSProvider(e){M=e}function _recaptchaEnterpriseScriptUrl(){return M.recaptchaEnterpriseScript}function _gapiScriptUrl(){return M.gapiScript}function _generateCallbackName(e){return`__${e}${Math.floor(1e6*Math.random())}`}let MockGreCAPTCHATopLevel=class MockGreCAPTCHATopLevel{constructor(){this.enterprise=new MockGreCAPTCHA}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}};let MockGreCAPTCHA=class MockGreCAPTCHA{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}};let j="NO_RECAPTCHA";let RecaptchaEnterpriseVerifier=class RecaptchaEnterpriseVerifier{constructor(e){this.type="recaptcha-enterprise",this.auth=_castAuth(e)}async verify(e="verify",r=!1){async function retrieveSiteKey(e){if(!r){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(r,i)=>{getRecaptchaConfig(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(o=>{if(void 0===o.recaptchaKey)i(Error("recaptcha Enterprise site key undefined"));else{let i=new RecaptchaConfig(o);return null==e.tenantId?e._agentRecaptchaConfig=i:e._tenantRecaptchaConfigs[e.tenantId]=i,r(i.siteKey)}}).catch(e=>{i(e)})})}function retrieveRecaptchaToken(r,i,o){let s=window.grecaptcha;isEnterprise(s)?s.enterprise.ready(()=>{s.enterprise.execute(r,{action:e}).then(e=>{i(e)}).catch(()=>{i(j)})}):o(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){let e=new MockGreCAPTCHATopLevel;return e.execute("siteKey",{action:"verify"})}return new Promise((e,i)=>{retrieveSiteKey(this.auth).then(o=>{if(!r&&isEnterprise(window.grecaptcha))retrieveRecaptchaToken(o,e,i);else{var s;if("undefined"==typeof window){i(Error("RecaptchaVerifier is only supported in browser"));return}let r=_recaptchaEnterpriseScriptUrl();0!==r.length&&(r+=o),(s=r,M.loadJS(s)).then(()=>{retrieveRecaptchaToken(o,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}};async function injectRecaptchaFields(e,r,i,o=!1,s=!1){let l;let h=new RecaptchaEnterpriseVerifier(e);if(s)l=j;else try{l=await h.verify(i)}catch(e){l=await h.verify(i,!0)}let d={...r};if("mfaSmsEnrollment"===i||"mfaSmsSignIn"===i){if("phoneEnrollmentInfo"in d){let e=d.phoneEnrollmentInfo.phoneNumber,r=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){let e=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return o?Object.assign(d,{captchaResp:l}):Object.assign(d,{captchaResponse:l}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function handleRecaptchaFlow(e,r,i,o,s){if("EMAIL_PASSWORD_PROVIDER"===s){if(!e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return o(e,r).catch(async s=>{if("auth/missing-recaptcha-token"!==s.code)return Promise.reject(s);{console.log(`${i} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let s=await injectRecaptchaFields(e,r,i,"getOobCode"===i);return o(e,s)}});{let s=await injectRecaptchaFields(e,r,i,"getOobCode"===i);return o(e,s)}}if("PHONE_PROVIDER"!==s)return Promise.reject(s+" provider is not supported.");if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let s=await injectRecaptchaFields(e,r,i);return o(e,s).catch(async s=>{if(e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&("auth/missing-recaptcha-token"===s.code||"auth/invalid-app-credential"===s.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${i} flow.`);let s=await injectRecaptchaFields(e,r,i,!1,!0);return o(e,s)}return Promise.reject(s)})}{let s=await injectRecaptchaFields(e,r,i,!1,!0);return o(e,s)}}async function _initializeRecaptchaConfig(e){let r=_castAuth(e),i=await getRecaptchaConfig(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),o=new RecaptchaConfig(i);if(null==r.tenantId?r._agentRecaptchaConfig=o:r._tenantRecaptchaConfigs[r.tenantId]=o,o.isAnyProviderEnabled()){let e=new RecaptchaEnterpriseVerifier(r);e.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initializeAuth(e,r){let i=(0,o.qX)(e,"auth");if(i.isInitialized()){let e=i.getImmediate(),o=i.getOptions();if((0,s.vZ)(o,r??{}))return e;_fail(e,"already-initialized")}let l=i.initialize({options:r});return l}function _initializeAuthInstance(e,r){let i=r?.persistence||[],o=(Array.isArray(i)?i:[i]).map(_getInstance);r?.errorMap&&e._updateErrorMap(r.errorMap),e._initializeWithPersistence(o,r?.popupRedirectResolver)}function connectAuthEmulator(e,r,i){let o=_castAuth(e);_assert(/^https?:\/\//.test(r),o,"invalid-emulator-scheme");let l=!!i?.disableWarnings,h=extractProtocol(r),{host:d,port:f}=extractHostAndPort(r),_=null===f?"":`:${f}`,g={url:`${h}//${d}${_}/`},A=Object.freeze({host:d,port:f,protocol:h.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!o._canInitEmulator){_assert(o.config.emulator&&o.emulatorConfig,o,"emulator-config-failed"),_assert((0,s.vZ)(g,o.config.emulator)&&(0,s.vZ)(A,o.emulatorConfig),o,"emulator-config-failed");return}o.config.emulator=g,o.emulatorConfig=A,o.settings.appVerificationDisabledForTesting=!0,(0,s.Xx)(d)?((0,s.Uo)(`${h}//${d}${_}`),(0,s.dp)("Auth",!0)):l||emitEmulatorWarning()}function extractProtocol(e){let r=e.indexOf(":");return r<0?"":e.substr(0,r+1)}function extractHostAndPort(e){let r=extractProtocol(e),i=/(\/\/)?([^?#/]+)/.exec(e.substr(r.length));if(!i)return{host:"",port:null};let o=i[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(o);if(s){let e=s[1];return{host:e,port:parsePort(o.substr(e.length+1))}}{let[e,r]=o.split(":");return{host:e,port:parsePort(r)}}}function parsePort(e){if(!e)return null;let r=Number(e);return isNaN(r)?null:r}function emitEmulatorWarning(){function attachBanner(){let e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",attachBanner):attachBanner())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AuthCredential=class AuthCredential{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return debugFail("not implemented")}_getIdTokenResponse(e){return debugFail("not implemented")}_linkToIdToken(e,r){return debugFail("not implemented")}_getReauthenticationResolver(e){return debugFail("not implemented")}};async function linkEmailPassword(e,r){return _performApiRequest(e,"POST","/v1/accounts:signUp",r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithPassword(e,r){return _performSignInRequest(e,"POST","/v1/accounts:signInWithPassword",_addTidIfNecessary(e,r))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithEmailLink$1(e,r){return _performSignInRequest(e,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(e,r))}async function signInWithEmailLinkForLinking(e,r){return _performSignInRequest(e,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(e,r))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EmailAuthCredential=class EmailAuthCredential extends AuthCredential{constructor(e,r,i,o=null){super("password",i),this._email=e,this._password=r,this._tenantId=o}static _fromEmailAndPassword(e,r){return new EmailAuthCredential(e,r,"password")}static _fromEmailAndCode(e,r,i=null){return new EmailAuthCredential(e,r,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let r="string"==typeof e?JSON.parse(e):e;if(r?.email&&r?.password){if("password"===r.signInMethod)return this._fromEmailAndPassword(r.email,r.password);if("emailLink"===r.signInMethod)return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":let r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return handleRecaptchaFlow(e,r,"signInWithPassword",signInWithPassword,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return signInWithEmailLink$1(e,{email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":let i={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return handleRecaptchaFlow(e,i,"signUpPassword",linkEmailPassword,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return signInWithEmailLinkForLinking(e,{idToken:r,email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithIdp(e,r){return _performSignInRequest(e,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(e,r))}let OAuthCredential=class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let r=new OAuthCredential(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):_fail("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let r="string"==typeof e?JSON.parse(e):e,{providerId:i,signInMethod:o,...s}=r;if(!i||!o)return null;let l=new OAuthCredential(i,o);return l.idToken=s.idToken||void 0,l.accessToken=s.accessToken||void 0,l.secret=s.secret,l.nonce=s.nonce,l.pendingToken=s.pendingToken||null,l}_getIdTokenResponse(e){let r=this.buildRequest();return signInWithIdp(e,r)}_linkToIdToken(e,r){let i=this.buildRequest();return i.idToken=r,signInWithIdp(e,i)}_getReauthenticationResolver(e){let r=this.buildRequest();return r.autoCreate=!1,signInWithIdp(e,r)}buildRequest(){let e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=(0,s.xO)(r)}return e}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sendPhoneVerificationCode(e,r){return _performApiRequest(e,"POST","/v1/accounts:sendVerificationCode",_addTidIfNecessary(e,r))}async function signInWithPhoneNumber$1(e,r){return _performSignInRequest(e,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(e,r))}async function linkWithPhoneNumber$1(e,r){let i=await _performSignInRequest(e,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(e,r));if(i.temporaryProof)throw _makeTaggedError(e,"account-exists-with-different-credential",i);return i}let q={USER_NOT_FOUND:"user-not-found"};async function verifyPhoneNumberForExisting(e,r){let i={...r,operation:"REAUTH"};return _performSignInRequest(e,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(e,i),q)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PhoneAuthCredential=class PhoneAuthCredential extends AuthCredential{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,r){return new PhoneAuthCredential({verificationId:e,verificationCode:r})}static _fromTokenResponse(e,r){return new PhoneAuthCredential({phoneNumber:e,temporaryProof:r})}_getIdTokenResponse(e){return signInWithPhoneNumber$1(e,this._makeVerificationRequest())}_linkToIdToken(e,r){return linkWithPhoneNumber$1(e,{idToken:r,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return verifyPhoneNumberForExisting(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:r,verificationId:i,verificationCode:o}=this.params;return e&&r?{temporaryProof:e,phoneNumber:r}:{sessionInfo:i,code:o}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));let{verificationId:r,verificationCode:i,phoneNumber:o,temporaryProof:s}=e;return i||r||o||s?new PhoneAuthCredential({verificationId:r,verificationCode:i,phoneNumber:o,temporaryProof:s}):null}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parseMode(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function parseDeepLink(e){let r=(0,s.zd)((0,s.pd)(e)).link,i=r?(0,s.zd)((0,s.pd)(r)).deep_link_id:null,o=(0,s.zd)((0,s.pd)(e)).deep_link_id,l=o?(0,s.zd)((0,s.pd)(o)).link:null;return l||o||i||r||e}let ActionCodeURL=class ActionCodeURL{constructor(e){let r=(0,s.zd)((0,s.pd)(e)),i=r.apiKey??null,o=r.oobCode??null,l=parseMode(r.mode??null);_assert(i&&o&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=o,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){let r=parseDeepLink(e);try{return new ActionCodeURL(r)}catch{return null}}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EmailAuthProvider=class EmailAuthProvider{constructor(){this.providerId=EmailAuthProvider.PROVIDER_ID}static credential(e,r){return EmailAuthCredential._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){let i=ActionCodeURL.parseLink(r);return _assert(i,"argument-error"),EmailAuthCredential._fromEmailAndCode(e,i.code,i.tenantId)}};EmailAuthProvider.PROVIDER_ID="password",EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD="password",EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FederatedAuthProvider=class FederatedAuthProvider{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let BaseOAuthProvider=class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FacebookAuthProvider=class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential(e){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return FacebookAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return FacebookAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return FacebookAuthProvider.credential(e.oauthAccessToken)}catch{return null}}};FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com",FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GoogleAuthProvider=class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return GoogleAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GoogleAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:r,oauthAccessToken:i}=e;if(!r&&!i)return null;try{return GoogleAuthProvider.credential(r,i)}catch{return null}}};GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com",GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GithubAuthProvider=class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential(e){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return GithubAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GithubAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return GithubAuthProvider.credential(e.oauthAccessToken)}catch{return null}}};GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com",GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TwitterAuthProvider=class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential(e,r){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return TwitterAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return TwitterAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=e;if(!r||!i)return null;try{return TwitterAuthProvider.credential(r,i)}catch{return null}}};TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com",TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let UserCredentialImpl=class UserCredentialImpl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,i,o=!1){let s=await UserImpl._fromIdTokenResponse(e,i,o),l=providerIdForResponse(i),h=new UserCredentialImpl({user:s,providerId:l,_tokenResponse:i,operationType:r});return h}static async _forOperation(e,r,i){await e._updateTokensIfNecessary(i,!0);let o=providerIdForResponse(i);return new UserCredentialImpl({user:e,providerId:o,_tokenResponse:i,operationType:r})}};function providerIdForResponse(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MultiFactorError=class MultiFactorError extends s.ZR{constructor(e,r,i,o){super(r.code,r.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,MultiFactorError.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,r,i,o){return new MultiFactorError(e,r,i,o)}};function _processCredentialSavingMfaContextIfNecessary(e,r,i,o){let s="reauthenticate"===r?i._getReauthenticationResolver(e):i._getIdTokenResponse(e);return s.catch(i=>{if("auth/multi-factor-auth-required"===i.code)throw MultiFactorError._fromErrorAndOperation(e,i,r,o);throw i})}async function _link$1(e,r,i=!1){let o=await _logoutIfInvalidated(e,r._linkToIdToken(e.auth,await e.getIdToken()),i);return UserCredentialImpl._forOperation(e,"link",o)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reauthenticate(e,r,i=!1){let{auth:s}=e;if((0,o.rh)(s.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(s));let l="reauthenticate";try{let o=await _logoutIfInvalidated(e,_processCredentialSavingMfaContextIfNecessary(s,l,r,e),i);_assert(o.idToken,s,"internal-error");let h=_parseToken(o.idToken);_assert(h,s,"internal-error");let{sub:d}=h;return _assert(e.uid===d,s,"user-mismatch"),UserCredentialImpl._forOperation(e,l,o)}catch(e){throw e?.code==="auth/user-not-found"&&_fail(s,"user-mismatch"),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _signInWithCredential(e,r,i=!1){if((0,o.rh)(e.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(e));let s="signIn",l=await _processCredentialSavingMfaContextIfNecessary(e,s,r),h=await UserCredentialImpl._fromIdTokenResponse(e,s,l);return i||await e._updateCurrentUser(h.user),h}function onIdTokenChanged(e,r,i,o){return(0,s.m9)(e).onIdTokenChanged(r,i,o)}function beforeAuthStateChanged(e,r,i){return(0,s.m9)(e).beforeAuthStateChanged(r,i)}function onAuthStateChanged(e,r,i,o){return(0,s.m9)(e).onAuthStateChanged(r,i,o)}function signOut(e){return(0,s.m9)(e).signOut()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function startEnrollPhoneMfa(e,r){return _performApiRequest(e,"POST","/v2/accounts/mfaEnrollment:start",_addTidIfNecessary(e,r))}function finalizeEnrollPhoneMfa(e,r){return _performApiRequest(e,"POST","/v2/accounts/mfaEnrollment:finalize",_addTidIfNecessary(e,r))}function startEnrollTotpMfa(e,r){return _performApiRequest(e,"POST","/v2/accounts/mfaEnrollment:start",_addTidIfNecessary(e,r))}function finalizeEnrollTotpMfa(e,r){return _performApiRequest(e,"POST","/v2/accounts/mfaEnrollment:finalize",_addTidIfNecessary(e,r))}new WeakMap;let $="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let BrowserPersistenceClass=class BrowserPersistenceClass{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem($,"1"),this.storage.removeItem($),Promise.resolve(!0)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){let r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};let BrowserLocalPersistence=class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&e(r,o,i)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((e,r,i)=>{this.notifyListeners(e,i)});return}let i=e.key;r?this.detachListener():this.stopPolling();let triggerListeners=()=>{let e=this.storage.getItem(i);(r||this.localCache[i]!==e)&&this.notifyListeners(i,e)},o=this.storage.getItem(i);_isIE10()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(triggerListeners,10):triggerListeners()}notifyListeners(e,r){this.localCache[e]=r;let i=this.listeners[e];if(i)for(let e of Array.from(i))e(r?JSON.parse(r):r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){let r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}};function getDocumentCookie(e){let r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=RegExp(`${r}=([^;]+)`);return document.cookie.match(i)?.[1]??null}function getCookieName(e){let r="http:"===window.location.protocol;return`${r?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}BrowserLocalPersistence.type="LOCAL";let CookiePersistence=class CookiePersistence{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){let r=new URL(`${window.location.origin}/__cookies__`);return r.searchParams.set("finalTarget",e),r}async _isAvailable(){return!!("boolean"!=typeof isSecureContext||isSecureContext)&&"undefined"!=typeof navigator&&"undefined"!=typeof document&&(navigator.cookieEnabled??!0)}async _set(e,r){}async _get(e){if(!this._isAvailable())return null;let r=getCookieName(e);if(window.cookieStore){let e=await window.cookieStore.get(r);return e?.value}return getDocumentCookie(r)}async _remove(e){if(!this._isAvailable())return;let r=await this._get(e);if(!r)return;let i=getCookieName(e);document.cookie=`${i}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>void 0)}_addListener(e,r){if(!this._isAvailable())return;let i=getCookieName(e);if(window.cookieStore){let cb=e=>{let o=e.changed.find(e=>e.name===i);o&&r(o.value);let s=e.deleted.find(e=>e.name===i);s&&r(null)};return this.listenerUnsubscribes.set(r,()=>window.cookieStore.removeEventListener("change",cb)),window.cookieStore.addEventListener("change",cb)}let o=getDocumentCookie(i),s=setInterval(()=>{let e=getDocumentCookie(i);e!==o&&(r(e),o=e)},1e3);this.listenerUnsubscribes.set(r,()=>clearInterval(s))}_removeListener(e,r){let i=this.listenerUnsubscribes.get(r);i&&(i(),this.listenerUnsubscribes.delete(r))}};CookiePersistence.type="COOKIE";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let BrowserSessionPersistence=class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _allSettled(e){return Promise.all(e.map(async e=>{try{let r=await e;return{fulfilled:!0,value:r}}catch(e){return{fulfilled:!1,reason:e}}}))}BrowserSessionPersistence.type="SESSION";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Receiver=class Receiver{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let r=this.receivers.find(r=>r.isListeningto(e));if(r)return r;let i=new Receiver(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let{eventId:r,eventType:i,data:o}=e.data,s=this.handlersMap[i];if(!s?.size)return;e.ports[0].postMessage({status:"ack",eventId:r,eventType:i});let l=Array.from(s).map(async r=>r(e.origin,o)),h=await _allSettled(l);e.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),r&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(e="",r=10){let i="";for(let e=0;e<r;e++)i+=Math.floor(10*Math.random());return e+i}Receiver.receivers=[];/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sender=class Sender{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,i=50){let o,s;let l="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!l)throw Error("connection_unavailable");return new Promise((h,d)=>{let f=_generateEventId("",20);l.port1.start();let _=setTimeout(()=>{d(Error("unsupported_event"))},i);s={messageChannel:l,onMessage(e){if(e.data.eventId===f)switch(e.data.status){case"ack":clearTimeout(_),o=setTimeout(()=>{d(Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(e.data.response);break;default:clearTimeout(_),clearTimeout(o),d(Error("invalid_response"))}}},this.handlers.add(s),l.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:f,data:r},[l.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window(){return window}function _setWindowLocation(e){_window().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker(){return void 0!==_window().WorkerGlobalScope&&"function"==typeof _window().importScripts}async function _getActiveServiceWorker(){if(!navigator?.serviceWorker)return null;try{let e=await navigator.serviceWorker.ready;return e.active}catch{return null}}function _getServiceWorkerController(){return navigator?.serviceWorker?.controller||null}function _getWorkerGlobalScope(){return _isWorker()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ee="firebaseLocalStorageDb",et="firebaseLocalStorage",en="fbase_key";let DBPromise=class DBPromise{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}};function getObjectStore(e,r){return e.transaction([et],r?"readwrite":"readonly").objectStore(et)}function _deleteDatabase(){let e=indexedDB.deleteDatabase(ee);return new DBPromise(e).toPromise()}function _openDatabase(){let e=indexedDB.open(ee,1);return new Promise((r,i)=>{e.addEventListener("error",()=>{i(e.error)}),e.addEventListener("upgradeneeded",()=>{let r=e.result;try{r.createObjectStore(et,{keyPath:en})}catch(e){i(e)}}),e.addEventListener("success",async()=>{let i=e.result;i.objectStoreNames.contains(et)?r(i):(i.close(),await _deleteDatabase(),r(await _openDatabase()))})})}async function _putObject(e,r,i){let o=getObjectStore(e,!0).put({[en]:r,value:i});return new DBPromise(o).toPromise()}async function getObject(e,r){let i=getObjectStore(e,!1).get(r),o=await new DBPromise(i).toPromise();return void 0===o?null:o.value}function _deleteObject(e,r){let i=getObjectStore(e,!0).delete(r);return new DBPromise(i).toPromise()}let IndexedDBLocalPersistence=class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await _openDatabase()),this.db}async _withRetries(e){let r=0;for(;;)try{let r=await this._openDb();return await e(r)}catch(e){if(r++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _isWorker()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Receiver._getInstance(_getWorkerGlobalScope()),this.receiver._subscribe("keyChanged",async(e,r)=>{let i=await this._poll();return{keyProcessed:i.includes(r.key)}}),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);let e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&_getServiceWorkerController()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await _openDatabase();return await _putObject(e,$,"1"),await _deleteObject(e,$),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>_putObject(i,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){let r=await this._withRetries(r=>getObject(r,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>_deleteObject(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>{let r=getObjectStore(e,!1).getAll();return new DBPromise(r).toPromise()});if(!e||0!==this.pendingWrites)return[];let r=[],i=new Set;if(0!==e.length)for(let{fbase_key:o,value:s}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),r.push(o));for(let e of Object.keys(this.localCache))this.localCache[e]&&!i.has(e)&&(this.notifyListeners(e,null),r.push(e));return r}notifyListeners(e,r){this.localCache[e]=r;let i=this.listeners[e];if(i)for(let e of Array.from(i))e(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function startSignInPhoneMfa(e,r){return _performApiRequest(e,"POST","/v2/accounts/mfaSignIn:start",_addTidIfNecessary(e,r))}function finalizeSignInPhoneMfa(e,r){return _performApiRequest(e,"POST","/v2/accounts/mfaSignIn:finalize",_addTidIfNecessary(e,r))}function finalizeSignInTotpMfa(e,r){return _performApiRequest(e,"POST","/v2/accounts/mfaSignIn:finalize",_addTidIfNecessary(e,r))}IndexedDBLocalPersistence.type="LOCAL",_generateCallbackName("rcb"),new Delay(3e4,6e4);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let er="recaptcha";async function _verifyPhoneNumber(e,r,i){if(!e._getRecaptchaConfig())try{await _initializeRecaptchaConfig(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let o;if(o="string"==typeof r?{phoneNumber:r}:r,"session"in o){let r=o.session;if("phoneNumber"in o){_assert("enroll"===r.type,e,"internal-error");let s={idToken:r.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},startEnrollPhoneMfaActionCallback=async(e,r)=>{if(r.phoneEnrollmentInfo.captchaResponse===j){_assert(i?.type===er,e,"argument-error");let o=await injectRecaptchaV2Token(e,r,i);return startEnrollPhoneMfa(e,o)}return startEnrollPhoneMfa(e,r)},l=handleRecaptchaFlow(e,s,"mfaSmsEnrollment",startEnrollPhoneMfaActionCallback,"PHONE_PROVIDER"),h=await l.catch(e=>Promise.reject(e));return h.phoneSessionInfo.sessionInfo}{_assert("signin"===r.type,e,"internal-error");let s=o.multiFactorHint?.uid||o.multiFactorUid;_assert(s,e,"missing-multi-factor-info");let l={mfaPendingCredential:r.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},startSignInPhoneMfaActionCallback=async(e,r)=>{if(r.phoneSignInInfo.captchaResponse===j){_assert(i?.type===er,e,"argument-error");let o=await injectRecaptchaV2Token(e,r,i);return startSignInPhoneMfa(e,o)}return startSignInPhoneMfa(e,r)},h=handleRecaptchaFlow(e,l,"mfaSmsSignIn",startSignInPhoneMfaActionCallback,"PHONE_PROVIDER"),d=await h.catch(e=>Promise.reject(e));return d.phoneResponseInfo.sessionInfo}}{let r={phoneNumber:o.phoneNumber,clientType:"CLIENT_TYPE_WEB"},sendPhoneVerificationCodeActionCallback=async(e,r)=>{if(r.captchaResponse===j){_assert(i?.type===er,e,"argument-error");let o=await injectRecaptchaV2Token(e,r,i);return sendPhoneVerificationCode(e,o)}return sendPhoneVerificationCode(e,r)},s=handleRecaptchaFlow(e,r,"sendVerificationCode",sendPhoneVerificationCodeActionCallback,"PHONE_PROVIDER"),l=await s.catch(e=>Promise.reject(e));return l.sessionInfo}}finally{i?._reset()}}async function injectRecaptchaV2Token(e,r,i){_assert(i.type===er,e,"argument-error");let o=await i.verify();_assert("string"==typeof o,e,"argument-error");let s={...r};if("phoneEnrollmentInfo"in s){let e=s.phoneEnrollmentInfo.phoneNumber,r=s.phoneEnrollmentInfo.captchaResponse,i=s.phoneEnrollmentInfo.clientType,l=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:o,captchaResponse:r,clientType:i,recaptchaVersion:l}}),s}if(!("phoneSignInInfo"in s))return Object.assign(s,{recaptchaToken:o}),s;{let e=s.phoneSignInInfo.captchaResponse,r=s.phoneSignInInfo.clientType,i=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:o,captchaResponse:e,clientType:r,recaptchaVersion:i}}),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PhoneAuthProvider=class PhoneAuthProvider{constructor(e){this.providerId=PhoneAuthProvider.PROVIDER_ID,this.auth=_castAuth(e)}verifyPhoneNumber(e,r){return _verifyPhoneNumber(this.auth,e,(0,s.m9)(r))}static credential(e,r){return PhoneAuthCredential._fromVerification(e,r)}static credentialFromResult(e){return PhoneAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return PhoneAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:r,temporaryProof:i}=e;return r&&i?PhoneAuthCredential._fromTokenResponse(r,i):null}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _withDefaultResolver(e,r){return r?_getInstance(r):(_assert(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}PhoneAuthProvider.PROVIDER_ID="phone",PhoneAuthProvider.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let IdpCredential=class IdpCredential extends AuthCredential{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return signInWithIdp(e,this._buildIdpRequest())}_linkToIdToken(e,r){return signInWithIdp(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return signInWithIdp(e,this._buildIdpRequest())}_buildIdpRequest(e){let r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}};function _signIn(e){return _signInWithCredential(e.auth,new IdpCredential(e),e.bypassAuthState)}function _reauth(e){let{auth:r,user:i}=e;return _assert(i,r,"internal-error"),_reauthenticate(i,new IdpCredential(e),e.bypassAuthState)}async function _link(e){let{auth:r,user:i}=e;return _assert(i,r,"internal-error"),_link$1(i,new IdpCredential(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AbstractPopupRedirectOperation=class AbstractPopupRedirectOperation{constructor(e,r,i,o,s=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){let{urlResponse:r,sessionId:i,postBody:o,tenantId:s,error:l,type:h}=e;if(l){this.reject(l);return}let d={auth:this.auth,requestUri:r,sessionId:i,tenantId:s||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(d))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve(e){this.pendingPromise||debugFail("Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){this.pendingPromise||debugFail("Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ei=new Delay(2e3,1e4);async function signInWithPopup(e,r,i){if((0,o.rh)(e.app))return Promise.reject(_createError(e,"operation-not-supported-in-this-environment"));let s=_castAuth(e);_assertInstanceOf(e,r,FederatedAuthProvider);let l=_withDefaultResolver(s,i),h=new PopupOperation(s,"signInViaPopup",r,l);return h.executeNotNull()}let PopupOperation=class PopupOperation extends AbstractPopupRedirectOperation{constructor(e,r,i,o,s){super(e,r,o,s),this.provider=i,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return _assert(e,this.auth,"internal-error"),e}async onExecution(){1===this.filter.length||debugFail("Popup operations only handle one event");let e=_generateEventId();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){let poll=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(poll,ei.get())};poll()}};PopupOperation.currentPopupAction=null;let eo=new Map;let RedirectAction=class RedirectAction extends AbstractPopupRedirectOperation{constructor(e,r,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,i),this.eventId=null}async execute(){let e=eo.get(this.auth._key());if(!e){try{let r=await _getAndClearPendingRedirectStatus(this.resolver,this.auth),i=r?await super.execute():null;e=()=>Promise.resolve(i)}catch(r){e=()=>Promise.reject(r)}eo.set(this.auth._key(),e)}return this.bypassAuthState||eo.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"===e.type){this.resolve(null);return}if(e.eventId){let r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function _getAndClearPendingRedirectStatus(e,r){let i=pendingRedirectKey(r),o=resolverPersistence(e);if(!await o._isAvailable())return!1;let s=await o._get(i)==="true";return await o._remove(i),s}function _overrideRedirectResult(e,r){eo.set(e._key(),r)}function resolverPersistence(e){return _getInstance(e._redirectPersistence)}function pendingRedirectKey(e){return _persistenceKeyName("pendingRedirect",e.config.apiKey,e.name)}async function _getRedirectResult(e,r,i=!1){if((0,o.rh)(e.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(e));let s=_castAuth(e),l=_withDefaultResolver(s,r),h=new RedirectAction(s,l,i),d=await h.execute();return d&&!i&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,r)),d}let AuthEventManager=class AuthEventManager{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(r=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!isRedirectEvent(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!isNullRedirectEvent(e)){let i=e.error.code?.split("auth/")[1]||"internal-error";r.onError(_createError(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){let i=null===r.eventId||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid(e))}saveEventToCache(e){this.cachedEventUids.add(eventUid(e)),this.lastProcessedEventTime=Date.now()}};function eventUid(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function isNullRedirectEvent({type:e,error:r}){return"unknown"===e&&r?.code==="auth/no-auth-event"}function isRedirectEvent(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getProjectConfig(e,r={}){return _performApiRequest(e,"GET","/v1/projects",r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let es=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ea=/^https?/;async function _validateOrigin(e){if(e.config.emulator)return;let{authorizedDomains:r}=await _getProjectConfig(e);for(let e of r)try{if(matchDomain(e))return}catch{}_fail(e,"unauthorized-domain")}function matchDomain(e){let r=_getCurrentUrl(),{protocol:i,hostname:o}=new URL(r);if(e.startsWith("chrome-extension://")){let s=new URL(e);return""===s.hostname&&""===o?"chrome-extension:"===i&&e.replace("chrome-extension://","")===r.replace("chrome-extension://",""):"chrome-extension:"===i&&s.hostname===o}if(!ea.test(i))return!1;if(es.test(e))return o===e;let s=e.replace(/\./g,"\\."),l=RegExp("^(.+\\."+s+"|"+s+")$","i");return l.test(o)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let el=new Delay(3e4,6e4);function resetUnloadedGapiModules(){let e=_window().___jsl;if(e?.H){for(let r of Object.keys(e.H))if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=[...e.H[r].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function loadGapi(e){return new Promise((r,i)=>{function loadGapiIframe(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{r(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),i(_createError(e,"network-request-failed"))},timeout:el.get()})}if(_window().gapi?.iframes?.Iframe)r(gapi.iframes.getContext());else if(_window().gapi?.load)loadGapiIframe();else{var o;let r=_generateCallbackName("iframefcb");return _window()[r]=()=>{gapi.load?loadGapiIframe():i(_createError(e,"network-request-failed"))},(o=`${_gapiScriptUrl()}?onload=${r}`,M.loadJS(o)).catch(e=>i(e))}}).catch(e=>{throw eu=null,e})}let eu=null;function _loadGapi(e){return eu=eu||loadGapi(e)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eh=new Delay(5e3,15e3),ed={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ef=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function getIframeUrl(e){let r=e.config;_assert(r.authDomain,e,"auth-domain-config-required");let i=r.emulator?_emulatorUrl(r,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,l={apiKey:r.apiKey,appName:e.name,v:o.Jn},h=ef.get(e.config.apiHost);h&&(l.eid=h);let d=e._getFrameworks();return d.length&&(l.fw=d.join(",")),`${i}?${(0,s.xO)(l).slice(1)}`}async function _openIframe(e){let r=await _loadGapi(e),i=_window().gapi;return _assert(i,e,"internal-error"),r.open({where:document.body,url:getIframeUrl(e),messageHandlersFilter:i.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ed,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});let s=_createError(e,"network-request-failed"),l=_window().setTimeout(()=>{o(s)},eh.get());function clearTimerAndResolve(){_window().clearTimeout(l),i(r)}r.ping(clearTimerAndResolve).then(clearTimerAndResolve,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ep={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};let AuthPopup=class AuthPopup{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}};function _open(e,r,i,o=500,l=600){let h=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-o)/2,0).toString(),f="",_={...ep,width:o.toString(),height:l.toString(),top:h,left:d},g=(0,s.z$)().toLowerCase();i&&(f=_isChromeIOS(g)?"_blank":i),_isFirefox(g)&&(r=r||"http://localhost",_.scrollbars="yes");let A=Object.entries(_).reduce((e,[r,i])=>`${e}${r}=${i},`,"");if(_isIOSStandalone(g)&&"_self"!==f)return openAsNewWindowIOS(r||"",f),new AuthPopup(null);let b=window.open(r||"",f,A);_assert(b,e,"popup-blocked");try{b.focus()}catch(e){}return new AuthPopup(b)}function openAsNewWindowIOS(e,r){let i=document.createElement("a");i.href=e,i.target=r;let o=document.createEvent("MouseEvent");o.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),i.dispatchEvent(o)}let em=encodeURIComponent("fac");async function _getRedirectUrl(e,r,i,l,h,d){_assert(e.config.authDomain,e,"auth-domain-config-required"),_assert(e.config.apiKey,e,"invalid-api-key");let f={apiKey:e.config.apiKey,appName:e.name,authType:i,redirectUrl:l,v:o.Jn,eventId:h};if(r instanceof FederatedAuthProvider)for(let[i,o]of(r.setDefaultLanguage(e.languageCode),f.providerId=r.providerId||"",(0,s.xb)(r.getCustomParameters())||(f.customParameters=JSON.stringify(r.getCustomParameters())),Object.entries(d||{})))f[i]=o;if(r instanceof BaseOAuthProvider){let e=r.getScopes().filter(e=>""!==e);e.length>0&&(f.scopes=e.join(","))}for(let r of(e.tenantId&&(f.tid=e.tenantId),Object.keys(f)))void 0===f[r]&&delete f[r];let _=await e._getAppCheckToken(),g=_?`#${em}=${encodeURIComponent(_)}`:"";return`${getHandlerBase(e)}?${(0,s.xO)(f).slice(1)}${g}`}function getHandlerBase({config:e}){return e.emulator?_emulatorUrl(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e_="webStorageSupport";let BrowserPopupRedirectResolver=class BrowserPopupRedirectResolver{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=BrowserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _openPopup(e,r,i,o){this.eventManagers[e._key()]?.manager||debugFail("_initialize() not called before _openPopup()");let s=await _getRedirectUrl(e,r,i,_getCurrentUrl(),o);return _open(e,s,_generateEventId())}async _openRedirect(e,r,i,o){await this._originValidation(e);let s=await _getRedirectUrl(e,r,i,_getCurrentUrl(),o);return _setWindowLocation(s),new Promise(()=>{})}_initialize(e){let r=e._key();if(this.eventManagers[r]){let{manager:e,promise:i}=this.eventManagers[r];return e?Promise.resolve(e):(i||debugFail("If manager is not set, promise should be"),i)}let i=this.initAndGetManager(e);return this.eventManagers[r]={promise:i},i.catch(()=>{delete this.eventManagers[r]}),i}async initAndGetManager(e){let r=await _openIframe(e),i=new AuthEventManager(e);return r.register("authEvent",r=>{_assert(r?.authEvent,e,"invalid-auth-event");let o=i.onEvent(r.authEvent);return{status:o?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=r,i}_isIframeWebStorageSupported(e,r){let i=this.iframes[e._key()];i.send(e_,{type:e_},i=>{let o=i?.[0]?.[e_];void 0!==o&&r(!!o),_fail(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=_validateOrigin(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}};let MultiFactorAssertionImpl=class MultiFactorAssertionImpl{constructor(e){this.factorId=e}_process(e,r,i){switch(r.type){case"enroll":return this._finalizeEnroll(e,r.credential,i);case"signin":return this._finalizeSignIn(e,r.credential);default:return debugFail("unexpected MultiFactorSessionType")}}};let PhoneMultiFactorAssertionImpl=class PhoneMultiFactorAssertionImpl extends MultiFactorAssertionImpl{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new PhoneMultiFactorAssertionImpl(e)}_finalizeEnroll(e,r,i){return finalizeEnrollPhoneMfa(e,{idToken:r,displayName:i,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,r){return finalizeSignInPhoneMfa(e,{mfaPendingCredential:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}};let PhoneMultiFactorGenerator=class PhoneMultiFactorGenerator{constructor(){}static assertion(e){return PhoneMultiFactorAssertionImpl._fromCredential(e)}};PhoneMultiFactorGenerator.FACTOR_ID="phone";let TotpMultiFactorGenerator=class TotpMultiFactorGenerator{static assertionForEnrollment(e,r){return TotpMultiFactorAssertionImpl._fromSecret(e,r)}static assertionForSignIn(e,r){return TotpMultiFactorAssertionImpl._fromEnrollmentId(e,r)}static async generateSecret(e){_assert(void 0!==e.user?.auth,"internal-error");let r=await startEnrollTotpMfa(e.user.auth,{idToken:e.credential,totpEnrollmentInfo:{}});return TotpSecret._fromStartTotpMfaEnrollmentResponse(r,e.user.auth)}};TotpMultiFactorGenerator.FACTOR_ID="totp";let TotpMultiFactorAssertionImpl=class TotpMultiFactorAssertionImpl extends MultiFactorAssertionImpl{constructor(e,r,i){super("totp"),this.otp=e,this.enrollmentId=r,this.secret=i}static _fromSecret(e,r){return new TotpMultiFactorAssertionImpl(r,void 0,e)}static _fromEnrollmentId(e,r){return new TotpMultiFactorAssertionImpl(r,e)}async _finalizeEnroll(e,r,i){return _assert(void 0!==this.secret,e,"argument-error"),finalizeEnrollTotpMfa(e,{idToken:r,displayName:i,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,r){_assert(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");let i={verificationCode:this.otp};return finalizeSignInTotpMfa(e,{mfaPendingCredential:r,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:i})}};let TotpSecret=class TotpSecret{constructor(e,r,i,o,s,l,h){this.sessionInfo=l,this.auth=h,this.secretKey=e,this.hashingAlgorithm=r,this.codeLength=i,this.codeIntervalSeconds=o,this.enrollmentCompletionDeadline=s}static _fromStartTotpMfaEnrollmentResponse(e,r){return new TotpSecret(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,r)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,r){let i=!1;return(_isEmptyString(e)||_isEmptyString(r))&&(i=!0),i&&(_isEmptyString(e)&&(e=this.auth.currentUser?.email||"unknownuser"),_isEmptyString(r)&&(r=this.auth.name)),`otpauth://totp/${r}:${e}?secret=${this.secretKey}&issuer=${r}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}};function _isEmptyString(e){return void 0===e||e?.length===0}var eg="@firebase/auth",ey="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AuthInterop=class AuthInterop{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;let r=await this.auth.currentUser.getIdToken(e);return{accessToken:r}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let r=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getVersionForPlatform(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function registerAuth(e){(0,o.Xd)(new h.wA("auth",(r,{options:i})=>{let o=r.getProvider("app").getImmediate(),s=r.getProvider("heartbeat"),l=r.getProvider("app-check-internal"),{apiKey:h,authDomain:d}=o.options;_assert(h&&!h.includes(":"),"invalid-api-key",{appName:o.name});let f={apiKey:h,authDomain:d,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(e)},_=new AuthImpl(o,s,l,f);return _initializeAuthInstance(_,i),_},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,i)=>{let o=e.getProvider("auth-internal");o.initialize()})),(0,o.Xd)(new h.wA("auth-internal",e=>{let r=_castAuth(e.getProvider("auth").getImmediate());return new AuthInterop(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,o.KN)(eg,ey,getVersionForPlatform(e)),(0,o.KN)(eg,ey,"esm2020")}let eE=(0,s.Pz)("authIdTokenMaxAge")||300,eI=null,mintCookieFactory=e=>async r=>{let i=r&&await r.getIdTokenResult(),o=i&&(new Date().getTime()-Date.parse(i.issuedAtTime))/1e3;if(o&&o>eE)return;let s=i?.token;eI!==s&&(eI=s,await fetch(e,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function getAuth(e=(0,o.Mq)()){let r=(0,o.qX)(e,"auth");if(r.isInitialized())return r.getImmediate();let i=initializeAuth(e,{popupRedirectResolver:BrowserPopupRedirectResolver,persistence:[IndexedDBLocalPersistence,BrowserLocalPersistence,BrowserSessionPersistence]}),l=(0,s.Pz)("authTokenSyncURL");if(l&&"boolean"==typeof isSecureContext&&isSecureContext){let e=new URL(l,location.origin);if(location.origin===e.origin){let r=mintCookieFactory(e.toString());beforeAuthStateChanged(i,r,()=>r(i.currentUser)),onIdTokenChanged(i,e=>r(e))}}let h=(0,s.q4)("auth");return h&&connectAuthEmulator(i,`http://${h}`),i}function getScriptParentElement(){return document.getElementsByTagName("head")?.[0]??document}_setExternalJSProvider({loadJS:e=>new Promise((r,i)=>{let o=document.createElement("script");o.setAttribute("src",e),o.onload=r,o.onerror=e=>{let r=_createError("internal-error");r.customData=e,i(r)},o.type="text/javascript",o.charset="UTF-8",getScriptParentElement().appendChild(o)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),registerAuth("Browser")},9724:function(e,r,i){"use strict";i.d(r,{ET:function(){return addDoc},hJ:function(){return collection},JU:function(){return doc},QT:function(){return getDoc},ad:function(){return getFirestore},Bt:function(){return serverTimestamp},pl:function(){return setDoc}});var o,s,l,h,d,f,_,g,A,b,k,M,j,q,$=i(6771),ee=i(75),et=i(4645),en=i(9711),er="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ei={};(function(){function m(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,r,i){i||(i=0);let o=Array(16);if("string"==typeof r)for(var s=0;s<16;++s)o[s]=r.charCodeAt(i++)|r.charCodeAt(i++)<<8|r.charCodeAt(i++)<<16|r.charCodeAt(i++)<<24;else for(s=0;s<16;++s)o[s]=r[i++]|r[i++]<<8|r[i++]<<16|r[i++]<<24;r=e.g[0],i=e.g[1],s=e.g[2];let l=e.g[3],h;h=r+(l^i&(s^l))+o[0]+3614090360&4294967295,h=l+(s^(r=i+(h<<7&4294967295|h>>>25))&(i^s))+o[1]+3905402710&4294967295,h=s+(i^(l=r+(h<<12&4294967295|h>>>20))&(r^i))+o[2]+606105819&4294967295,h=i+(r^(s=l+(h<<17&4294967295|h>>>15))&(l^r))+o[3]+3250441966&4294967295,h=r+(l^(i=s+(h<<22&4294967295|h>>>10))&(s^l))+o[4]+4118548399&4294967295,h=l+(s^(r=i+(h<<7&4294967295|h>>>25))&(i^s))+o[5]+1200080426&4294967295,h=s+(i^(l=r+(h<<12&4294967295|h>>>20))&(r^i))+o[6]+2821735955&4294967295,h=i+(r^(s=l+(h<<17&4294967295|h>>>15))&(l^r))+o[7]+4249261313&4294967295,h=r+(l^(i=s+(h<<22&4294967295|h>>>10))&(s^l))+o[8]+1770035416&4294967295,h=l+(s^(r=i+(h<<7&4294967295|h>>>25))&(i^s))+o[9]+2336552879&4294967295,h=s+(i^(l=r+(h<<12&4294967295|h>>>20))&(r^i))+o[10]+4294925233&4294967295,h=i+(r^(s=l+(h<<17&4294967295|h>>>15))&(l^r))+o[11]+2304563134&4294967295,h=r+(l^(i=s+(h<<22&4294967295|h>>>10))&(s^l))+o[12]+1804603682&4294967295,h=l+(s^(r=i+(h<<7&4294967295|h>>>25))&(i^s))+o[13]+4254626195&4294967295,h=s+(i^(l=r+(h<<12&4294967295|h>>>20))&(r^i))+o[14]+2792965006&4294967295,h=i+(r^(s=l+(h<<17&4294967295|h>>>15))&(l^r))+o[15]+1236535329&4294967295,i=s+(h<<22&4294967295|h>>>10),h=r+(s^l&(i^s))+o[1]+4129170786&4294967295,r=i+(h<<5&4294967295|h>>>27),h=l+(i^s&(r^i))+o[6]+3225465664&4294967295,l=r+(h<<9&4294967295|h>>>23),h=s+(r^i&(l^r))+o[11]+643717713&4294967295,s=l+(h<<14&4294967295|h>>>18),h=i+(l^r&(s^l))+o[0]+3921069994&4294967295,i=s+(h<<20&4294967295|h>>>12),h=r+(s^l&(i^s))+o[5]+3593408605&4294967295,r=i+(h<<5&4294967295|h>>>27),h=l+(i^s&(r^i))+o[10]+38016083&4294967295,l=r+(h<<9&4294967295|h>>>23),h=s+(r^i&(l^r))+o[15]+3634488961&4294967295,s=l+(h<<14&4294967295|h>>>18),h=i+(l^r&(s^l))+o[4]+3889429448&4294967295,i=s+(h<<20&4294967295|h>>>12),h=r+(s^l&(i^s))+o[9]+568446438&4294967295,r=i+(h<<5&4294967295|h>>>27),h=l+(i^s&(r^i))+o[14]+3275163606&4294967295,l=r+(h<<9&4294967295|h>>>23),h=s+(r^i&(l^r))+o[3]+4107603335&4294967295,s=l+(h<<14&4294967295|h>>>18),h=i+(l^r&(s^l))+o[8]+1163531501&4294967295,i=s+(h<<20&4294967295|h>>>12),h=r+(s^l&(i^s))+o[13]+2850285829&4294967295,r=i+(h<<5&4294967295|h>>>27),h=l+(i^s&(r^i))+o[2]+4243563512&4294967295,l=r+(h<<9&4294967295|h>>>23),h=s+(r^i&(l^r))+o[7]+1735328473&4294967295,s=l+(h<<14&4294967295|h>>>18),h=i+(l^r&(s^l))+o[12]+2368359562&4294967295,h=r+((i=s+(h<<20&4294967295|h>>>12))^s^l)+o[5]+4294588738&4294967295,h=l+((r=i+(h<<4&4294967295|h>>>28))^i^s)+o[8]+2272392833&4294967295,h=s+((l=r+(h<<11&4294967295|h>>>21))^r^i)+o[11]+1839030562&4294967295,h=i+((s=l+(h<<16&4294967295|h>>>16))^l^r)+o[14]+4259657740&4294967295,h=r+((i=s+(h<<23&4294967295|h>>>9))^s^l)+o[1]+2763975236&4294967295,h=l+((r=i+(h<<4&4294967295|h>>>28))^i^s)+o[4]+1272893353&4294967295,h=s+((l=r+(h<<11&4294967295|h>>>21))^r^i)+o[7]+4139469664&4294967295,h=i+((s=l+(h<<16&4294967295|h>>>16))^l^r)+o[10]+3200236656&4294967295,h=r+((i=s+(h<<23&4294967295|h>>>9))^s^l)+o[13]+681279174&4294967295,h=l+((r=i+(h<<4&4294967295|h>>>28))^i^s)+o[0]+3936430074&4294967295,h=s+((l=r+(h<<11&4294967295|h>>>21))^r^i)+o[3]+3572445317&4294967295,h=i+((s=l+(h<<16&4294967295|h>>>16))^l^r)+o[6]+76029189&4294967295,h=r+((i=s+(h<<23&4294967295|h>>>9))^s^l)+o[9]+3654602809&4294967295,h=l+((r=i+(h<<4&4294967295|h>>>28))^i^s)+o[12]+3873151461&4294967295,h=s+((l=r+(h<<11&4294967295|h>>>21))^r^i)+o[15]+530742520&4294967295,h=i+((s=l+(h<<16&4294967295|h>>>16))^l^r)+o[2]+3299628645&4294967295,i=s+(h<<23&4294967295|h>>>9),h=r+(s^(i|~l))+o[0]+4096336452&4294967295,r=i+(h<<6&4294967295|h>>>26),h=l+(i^(r|~s))+o[7]+1126891415&4294967295,l=r+(h<<10&4294967295|h>>>22),h=s+(r^(l|~i))+o[14]+2878612391&4294967295,s=l+(h<<15&4294967295|h>>>17),h=i+(l^(s|~r))+o[5]+4237533241&4294967295,i=s+(h<<21&4294967295|h>>>11),h=r+(s^(i|~l))+o[12]+1700485571&4294967295,r=i+(h<<6&4294967295|h>>>26),h=l+(i^(r|~s))+o[3]+2399980690&4294967295,l=r+(h<<10&4294967295|h>>>22),h=s+(r^(l|~i))+o[10]+4293915773&4294967295,s=l+(h<<15&4294967295|h>>>17),h=i+(l^(s|~r))+o[1]+2240044497&4294967295,i=s+(h<<21&4294967295|h>>>11),h=r+(s^(i|~l))+o[8]+1873313359&4294967295,r=i+(h<<6&4294967295|h>>>26),h=l+(i^(r|~s))+o[15]+4264355552&4294967295,l=r+(h<<10&4294967295|h>>>22),h=s+(r^(l|~i))+o[6]+2734768916&4294967295,s=l+(h<<15&4294967295|h>>>17),h=i+(l^(s|~r))+o[13]+1309151649&4294967295,i=s+(h<<21&4294967295|h>>>11),h=r+(s^(i|~l))+o[4]+4149444226&4294967295,r=i+(h<<6&4294967295|h>>>26),h=l+(i^(r|~s))+o[11]+3174756917&4294967295,l=r+(h<<10&4294967295|h>>>22),h=s+(r^(l|~i))+o[2]+718787259&4294967295,s=l+(h<<15&4294967295|h>>>17),h=i+(l^(s|~r))+o[9]+3951481745&4294967295,e.g[0]=e.g[0]+r&4294967295,e.g[1]=e.g[1]+(s+(h<<21&4294967295|h>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+l&4294967295}function p(e,i){return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=i(e)}function t(e,r){this.h=r;let i=[],o=!0;for(let s=e.length-1;s>=0;s--){let l=0|e[s];o&&l==r||(i[s]=l,o=!1)}this.g=i}(function(e,r){function c(){}c.prototype=r.prototype,e.F=r.prototype,e.prototype=new c,e.prototype.constructor=e,e.D=function(e,i,o){for(var s=Array(arguments.length-2),l=2;l<arguments.length;l++)s[l-2]=arguments[l];return r.prototype[i].apply(e,s)}})(m,function(){this.blockSize=-1}),m.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},m.prototype.v=function(e,r){void 0===r&&(r=e.length);let i=r-this.blockSize,o=this.C,s=this.h,l=0;for(;l<r;){if(0==s)for(;l<=i;)n(this,e,l),l+=this.blockSize;if("string"==typeof e){for(;l<r;)if(o[s++]=e.charCodeAt(l++),s==this.blockSize){n(this,o),s=0;break}}else for(;l<r;)if(o[s++]=e[l++],s==this.blockSize){n(this,o),s=0;break}}this.h=s,this.o+=r},m.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var r=1;r<e.length-8;++r)e[r]=0;r=8*this.o;for(var i=e.length-8;i<e.length;++i)e[i]=255&r,r/=256;for(this.v(e),e=Array(16),r=0,i=0;i<4;++i)for(let o=0;o<32;o+=8)e[r++]=this.g[i]>>>o&255;return e};var e,r={};function u(e){return -128<=e&&e<128?p(e,function(e){return new t([0|e],e<0?-1:0)}):new t([0|e],e<0?-1:0)}function v(e){if(isNaN(e)||!isFinite(e))return i;if(e<0)return x(v(-e));let r=[],o=1;for(let i=0;e>=o;i++)r[i]=e/o|0,o*=4294967296;return new t(r,0)}function y(e,r){if(0==e.length)throw Error("number format error: empty string");if((r=r||10)<2||36<r)throw Error("radix out of range: "+r);if("-"==e.charAt(0))return x(y(e.substring(1),r));if(e.indexOf("-")>=0)throw Error('number format error: interior "-" character');let o=v(Math.pow(r,8)),s=i;for(let i=0;i<e.length;i+=8){var l=Math.min(8,e.length-i);let h=parseInt(e.substring(i,i+l),r);l<8?(l=v(Math.pow(r,l)),s=s.j(l).add(v(h))):s=(s=s.j(o)).add(v(h))}return s}var i=u(0),l=u(1),h=u(16777216);function C(e){if(0!=e.h)return!1;for(let r=0;r<e.g.length;r++)if(0!=e.g[r])return!1;return!0}function B(e){return -1==e.h}function x(e){let r=e.g.length,i=[];for(let o=0;o<r;o++)i[o]=~e.g[o];return new t(i,~e.h).add(l)}function F(e,r){return e.add(x(r))}function G(e,r){for(;(65535&e[r])!=e[r];)e[r+1]+=e[r]>>>16,e[r]&=65535,r++}function H(e,r){this.g=e,this.h=r}function D(e,r){if(C(r))throw Error("division by zero");if(C(e))return new H(i,i);if(B(e))return r=D(x(e),r),new H(x(r.g),x(r.h));if(B(r))return r=D(e,x(r)),new H(x(r.g),r.h);if(e.g.length>30){if(B(e)||B(r))throw Error("slowDivide_ only works with positive integers.");for(var o=l,s=r;0>=s.l(e);)o=I(o),s=I(s);var h=J(o,1),d=J(s,1);for(s=J(s,2),o=J(o,2);!C(s);){var f=d.add(s);0>=f.l(e)&&(h=h.add(o),d=f),s=J(s,1),o=J(o,1)}return r=F(e,h.j(r)),new H(h,r)}for(h=i;e.l(r)>=0;){for(s=(s=Math.ceil(Math.log(o=Math.max(1,Math.floor(e.m()/r.m())))/Math.LN2))<=48?1:Math.pow(2,s-48),f=(d=v(o)).j(r);B(f)||f.l(e)>0;)o-=s,f=(d=v(o)).j(r);C(d)&&(d=l),h=h.add(d),e=F(e,f)}return new H(h,e)}function I(e){let r=e.g.length+1,i=[];for(let o=0;o<r;o++)i[o]=e.i(o)<<1|e.i(o-1)>>>31;return new t(i,e.h)}function J(e,r){let i=r>>5;r%=32;let o=e.g.length-i,s=[];for(let l=0;l<o;l++)s[l]=r>0?e.i(l+i)>>>r|e.i(l+i+1)<<32-r:e.i(l+i);return new t(s,e.h)}(e=t.prototype).m=function(){if(B(this))return-x(this).m();let e=0,r=1;for(let i=0;i<this.g.length;i++){let o=this.i(i);e+=(o>=0?o:4294967296+o)*r,r*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(C(this))return"0";if(B(this))return"-"+x(this).toString(e);let r=v(Math.pow(e,6));var i=this;let o="";for(;;){let s=D(i,r).g,l=(((i=F(i,s.j(r))).g.length>0?i.g[0]:i.h)>>>0).toString(e);if(C(i=s))return l+o;for(;l.length<6;)l="0"+l;o=l+o}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return B(e=F(this,e))?-1:C(e)?0:1},e.abs=function(){return B(this)?x(this):this},e.add=function(e){let r=Math.max(this.g.length,e.g.length),i=[],o=0;for(let s=0;s<=r;s++){let r=o+(65535&this.i(s))+(65535&e.i(s)),l=(r>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);o=l>>>16,r&=65535,l&=65535,i[s]=l<<16|r}return new t(i,-2147483648&i[i.length-1]?-1:0)},e.j=function(e){if(C(this)||C(e))return i;if(B(this))return B(e)?x(this).j(x(e)):x(x(this).j(e));if(B(e))return x(this.j(x(e)));if(0>this.l(h)&&0>e.l(h))return v(this.m()*e.m());let r=this.g.length+e.g.length,o=[];for(var s=0;s<2*r;s++)o[s]=0;for(s=0;s<this.g.length;s++)for(let r=0;r<e.g.length;r++){let i=this.i(s)>>>16,l=65535&this.i(s),h=e.i(r)>>>16,d=65535&e.i(r);o[2*s+2*r]+=l*d,G(o,2*s+2*r),o[2*s+2*r+1]+=i*d,G(o,2*s+2*r+1),o[2*s+2*r+1]+=l*h,G(o,2*s+2*r+1),o[2*s+2*r+2]+=i*h,G(o,2*s+2*r+2)}for(e=0;e<r;e++)o[e]=o[2*e+1]<<16|o[2*e];for(e=r;e<2*r;e++)o[e]=0;return new t(o,0)},e.B=function(e){return D(this,e).h},e.and=function(e){let r=Math.max(this.g.length,e.g.length),i=[];for(let o=0;o<r;o++)i[o]=this.i(o)&e.i(o);return new t(i,this.h&e.h)},e.or=function(e){let r=Math.max(this.g.length,e.g.length),i=[];for(let o=0;o<r;o++)i[o]=this.i(o)|e.i(o);return new t(i,this.h|e.h)},e.xor=function(e){let r=Math.max(this.g.length,e.g.length),i=[];for(let o=0;o<r;o++)i[o]=this.i(o)^e.i(o);return new t(i,this.h^e.h)},m.prototype.digest=m.prototype.A,m.prototype.reset=m.prototype.u,m.prototype.update=m.prototype.v,s=ei.Md5=m,t.prototype.add=t.prototype.add,t.prototype.multiply=t.prototype.j,t.prototype.modulo=t.prototype.B,t.prototype.compare=t.prototype.l,t.prototype.toNumber=t.prototype.m,t.prototype.toString=t.prototype.toString,t.prototype.getBits=t.prototype.i,t.fromNumber=v,t.fromString=y,o=ei.Integer=t}).apply(void 0!==er?er:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var eo="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},es={};(function(){var e,r,i=Object.defineProperty,o=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof eo&&eo];for(var r=0;r<e.length;++r){var i=e[r];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);function da(e,r){if(r)e:{var s=o;e=e.split(".");for(var l=0;l<e.length-1;l++){var h=e[l];if(!(h in s))break e;s=s[h]}(r=r(l=s[e=e[e.length-1]]))!=l&&null!=r&&i(s,e,{configurable:!0,writable:!0,value:r})}}da("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),da("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),da("Object.entries",function(e){return e||function(e){var r,i=[];for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&i.push([r,e[r]]);return i}});var s=s||{},k=this||self;function n(e){var r=typeof e;return"object"==r&&null!=e||"function"==r}function fa(e,r,i){return e.call.apply(e.bind,arguments)}function p(e,r,i){return(p=fa).apply(null,arguments)}function ha(e,r){var i=Array.prototype.slice.call(arguments,1);return function(){var r=i.slice();return r.push.apply(r,arguments),e.apply(this,r)}}function t(e,r){function c(){}c.prototype=r.prototype,e.Z=r.prototype,e.prototype=new c,e.prototype.constructor=e,e.Ob=function(e,i,o){for(var s=Array(arguments.length-2),l=2;l<arguments.length;l++)s[l-2]=arguments[l];return r.prototype[i].apply(e,s)}}var M="undefined"!=typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function ja(e){let r=e.length;if(r>0){let i=Array(r);for(let o=0;o<r;o++)i[o]=e[o];return i}return[]}function ka(e,r){for(let r=1;r<arguments.length;r++){let o=arguments[r];var i=typeof o;if("array"==(i="object"!=i?i:o?Array.isArray(o)?"array":i:"null")||"object"==i&&"number"==typeof o.length){i=e.length||0;let r=o.length||0;e.length=i+r;for(let s=0;s<r;s++)e[i+s]=o[s]}else e.push(o)}}let la=class la{constructor(e,r){this.i=e,this.j=r,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function ma(e){k.setTimeout(()=>{throw e},0)}function na(){let e=null;return ee.g&&(e=ee.g,ee.g=ee.g.next,ee.g||(ee.h=null),e.next=null),e}let pa=class pa{constructor(){this.h=this.g=null}add(e,r){let i=j.get();i.set(e,r),this.h?this.h.next=i:this.g=i,this.h=i}};var j=new la(()=>new ra,e=>e.reset());let ra=class ra{constructor(){this.next=this.g=this.h=null}set(e,r){this.h=e,this.g=r,this.next=null}reset(){this.next=this.g=this.h=null}};let q,$=!1,ee=new pa,ta=()=>{let e=Promise.resolve(void 0);q=()=>{e.then(sa)}};function sa(){for(var e;e=na();){try{e.h.call(e.g)}catch(e){ma(e)}j.j(e),j.h<100&&(j.h++,e.next=j.g,j.g=e)}$=!1}function w(){this.u=this.u,this.C=this.C}function x(e,r){this.type=e,this.g=this.target=r,this.defaultPrevented=!1}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},x.prototype.h=function(){this.defaultPrevented=!0};var et=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var e=!1,r=Object.defineProperty({},"passive",{get:function(){e=!0}});try{let c=()=>{};k.addEventListener("test",c,r),k.removeEventListener("test",c,r)}catch(e){}return e}();function y(e){return/^[\s\xa0]*$/.test(e)}function z(e,r){x.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,r)}t(z,x),z.prototype.init=function(e,r){let i=this.type=e.type,o=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=r,(r=e.relatedTarget)||("mouseover"==i?r=e.fromElement:"mouseout"==i&&(r=e.toElement)),this.relatedTarget=r,o?(this.clientX=void 0!==o.clientX?o.clientX:o.pageX,this.clientY=void 0!==o.clientY?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&z.Z.h.call(this)},z.prototype.h=function(){z.Z.h.call(this);let e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var en="closure_listenable_"+(1e6*Math.random()|0),er=0;function wa(e,r,i,o,s){this.listener=e,this.proxy=null,this.src=r,this.type=i,this.capture=!!o,this.ha=s,this.key=++er,this.da=this.fa=!1}function xa(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function ya(e,r,i){for(let o in e)r.call(i,e[o],o,e)}function Aa(e,r){for(let i in e)r.call(void 0,e[i],i,e)}function Ba(e){let r={};for(let i in e)r[i]=e[i];return r}let ei="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Da(e,r){let i,o;for(let r=1;r<arguments.length;r++){for(i in o=arguments[r])e[i]=o[i];for(let r=0;r<ei.length;r++)i=ei[r],Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}}function Ea(e){this.src=e,this.g={},this.h=0}function Ga(e,r){let i=r.type;if(i in e.g){var o,s=e.g[i],l=Array.prototype.indexOf.call(s,r,void 0);(o=l>=0)&&Array.prototype.splice.call(s,l,1),o&&(xa(r),0==e.g[i].length&&(delete e.g[i],e.h--))}}function Fa(e,r,i,o){for(let s=0;s<e.length;++s){let l=e[s];if(!l.da&&l.listener==r&&!!i==l.capture&&l.ha==o)return s}return -1}Ea.prototype.add=function(e,r,i,o,s){let l=e.toString();(e=this.g[l])||(e=this.g[l]=[],this.h++);let h=Fa(e,r,o,s);return h>-1?(r=e[h],i||(r.fa=!1)):((r=new wa(r,this.src,l,!!o,s)).fa=i,e.push(r)),r};var ea="closure_lm_"+(1e6*Math.random()|0),el={};function Ka(e,r,i,o,s){if(o&&o.once)return La(e,r,i,o,s);if(Array.isArray(r)){for(let l=0;l<r.length;l++)Ka(e,r[l],i,o,s);return null}return i=Ma(i),e&&e[en]?e.J(r,i,n(o)?!!o.capture:!!o,s):Na(e,r,i,!1,o,s)}function Na(e,r,i,o,s,l){if(!r)throw Error("Invalid event type");let h=n(s)?!!s.capture:!!s,d=Oa(e);if(d||(e[ea]=d=new Ea(e)),(i=d.add(r,i,o,h,l)).proxy)return i;if(o=Pa(),i.proxy=o,o.src=e,o.listener=i,e.addEventListener)et||(s=h),void 0===s&&(s=!1),e.addEventListener(r.toString(),o,s);else if(e.attachEvent)e.attachEvent(Qa(r.toString()),o);else if(e.addListener&&e.removeListener)e.addListener(o);else throw Error("addEventListener and attachEvent are unavailable.");return i}function Pa(){function a(r){return e.call(a.src,a.listener,r)}let e=Ra;return a}function La(e,r,i,o,s){if(Array.isArray(r)){for(let l=0;l<r.length;l++)La(e,r[l],i,o,s);return null}return i=Ma(i),e&&e[en]?e.K(r,i,n(o)?!!o.capture:!!o,s):Na(e,r,i,!0,o,s)}function Sa(e,r,i,o,s){if(Array.isArray(r))for(var l=0;l<r.length;l++)Sa(e,r[l],i,o,s);else(o=n(o)?!!o.capture:!!o,i=Ma(i),e&&e[en])?(e=e.i,(l=String(r).toString())in e.g&&(i=Fa(r=e.g[l],i,o,s))>-1&&(xa(r[i]),Array.prototype.splice.call(r,i,1),0==r.length&&(delete e.g[l],e.h--))):e&&(e=Oa(e))&&(r=e.g[r.toString()],e=-1,r&&(e=Fa(r,i,o,s)),(i=e>-1?r[e]:null)&&Ta(i))}function Ta(e){if("number"!=typeof e&&e&&!e.da){var r=e.src;if(r&&r[en])Ga(r.i,e);else{var i=e.type,o=e.proxy;r.removeEventListener?r.removeEventListener(i,o,e.capture):r.detachEvent?r.detachEvent(Qa(i),o):r.addListener&&r.removeListener&&r.removeListener(o),(i=Oa(r))?(Ga(i,e),0==i.h&&(i.src=null,r[ea]=null)):xa(e)}}}function Qa(e){return e in el?el[e]:el[e]="on"+e}function Ra(e,r){if(e.da)e=!0;else{r=new z(r,this);let i=e.listener,o=e.ha||e.src;e.fa&&Ta(e),e=i.call(o,r)}return e}function Oa(e){return(e=e[ea])instanceof Ea?e:null}var eu="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ma(e){return"function"==typeof e?e:(e[eu]||(e[eu]=function(r){return e.handleEvent(r)}),e[eu])}function C(){w.call(this),this.i=new Ea(this),this.M=this,this.G=null}function D(e,r){let i,o;var s,l=e.G;if(l)for(s=[];l;l=l.G)s.push(l);if(e=e.M,l=r.type||r,"string"==typeof r)r=new x(r,e);else if(r instanceof x)r.target=r.target||e;else{var h=r;Da(r=new x(l,e),h)}if(h=!0,s)for(o=s.length-1;o>=0;o--)h=Va(i=r.g=s[o],l,!0,r)&&h;if(h=Va(i=r.g=e,l,!0,r)&&h,h=Va(i,l,!1,r)&&h,s)for(o=0;o<s.length;o++)h=Va(i=r.g=s[o],l,!1,r)&&h}function Va(e,r,i,o){if(!(r=e.i.g[String(r)]))return!0;r=r.concat();let s=!0;for(let l=0;l<r.length;++l){let h=r[l];if(h&&!h.da&&h.capture==i){let r=h.listener,i=h.ha||h.src;h.fa&&Ga(e.i,h),s=!1!==r.call(i,o)&&s}}return s&&!o.defaultPrevented}function Wa(e,r){if("function"!=typeof e){if(e&&"function"==typeof e.handleEvent)e=p(e.handleEvent,e);else throw Error("Invalid listener argument")}return Number(r)>2147483647?-1:k.setTimeout(e,r||0)}function Xa(e){e.g=Wa(()=>{e.g=null,e.i&&(e.i=!1,Xa(e))},e.l);let r=e.h;e.h=null,e.m.apply(null,r)}t(C,w),C.prototype[en]=!0,C.prototype.removeEventListener=function(e,r,i,o){Sa(this,e,r,i,o)},C.prototype.N=function(){if(C.Z.N.call(this),this.i){var e=this.i;for(let r in e.g){let i=e.g[r];for(let e=0;e<i.length;e++)xa(i[e]);delete e.g[r],e.h--}}this.G=null},C.prototype.J=function(e,r,i,o){return this.i.add(String(e),r,!1,i,o)},C.prototype.K=function(e,r,i,o){return this.i.add(String(e),r,!0,i,o)};let Ya=class Ya extends w{constructor(e,r){super(),this.m=e,this.l=r,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:Xa(this)}N(){super.N(),this.g&&(k.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function E(e){w.call(this),this.h=e,this.g={}}t(E,w);var eh=[];function $a(e){ya(e.g,function(e,r){this.g.hasOwnProperty(r)&&Ta(e)},e),e.g={}}E.prototype.N=function(){E.Z.N.call(this),$a(this)},E.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ed=k.JSON.stringify,ef=k.JSON.parse,ep=class{stringify(e){return k.JSON.stringify(e,void 0)}parse(e){return k.JSON.parse(e,void 0)}};function eb(){}function fb(){}var em={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gb(){x.call(this,"d")}function hb(){x.call(this,"c")}t(gb,x),t(hb,x);var e_={},eg=null;function jb(){return eg=eg||new C}function kb(e){x.call(this,e_.Ia,e)}function lb(e){let r=jb();D(r,new kb(r))}function mb(e,r){x.call(this,e_.STAT_EVENT,e),this.stat=r}function J(e){let r=jb();D(r,new mb(r,e))}function nb(e,r){x.call(this,e_.Ja,e),this.size=r}function ob(e,r){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){e()},r)}function pb(){this.g=!0}function qb(e,r,i,o,s,l){e.info(function(){if(e.g){if(l){var h="",d=l.split("&");for(let e=0;e<d.length;e++){var f=d[e].split("=");if(f.length>1){let e=f[0];f=f[1];let r=e.split("_");h=r.length>=2&&"type"==r[1]?h+(e+"=")+f+"&":h+(e+"=redacted&")}}}else h=null}else h=l;return"XMLHTTP REQ ("+o+") [attempt "+s+"]: "+r+"\n"+i+"\n"+h})}function rb(e,r,i,o,s,l,h){e.info(function(){return"XMLHTTP RESP ("+o+") [ attempt "+s+"]: "+r+"\n"+i+"\n"+l+" "+h})}function K(e,r,i,o){e.info(function(){return"XMLHTTP TEXT ("+r+"): "+sb(e,i)+(o?" "+o:"")})}function tb(e,r){e.info(function(){return"TIMEOUT: "+r})}function sb(e,r){if(!e.g)return r;if(!r)return null;try{let l=JSON.parse(r);if(l){for(e=0;e<l.length;e++)if(Array.isArray(l[e])){var i=l[e];if(!(i.length<2)){var o=i[1];if(Array.isArray(o)&&!(o.length<1)){var s=o[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(let e=1;e<o.length;e++)o[e]=""}}}}return ed(l)}catch(e){return r}}e_.Ia="serverreachability",t(kb,x),e_.STAT_EVENT="statevent",t(mb,x),e_.Ja="timingevent",t(nb,x),pb.prototype.ua=function(){this.g=!1},pb.prototype.info=function(){};var ey={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},eE={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function xb(){}function L(e){return encodeURIComponent(String(e))}function yb(e){var r=1;e=e.split(":");let i=[];for(;r>0&&e.length;)i.push(e.shift()),r--;return e.length&&i.push(e.join(":")),i}function N(e,r,i,o){this.j=e,this.i=r,this.l=i,this.S=o||1,this.V=new E(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new zb}function zb(){this.i=null,this.g="",this.h=!1}t(xb,eb),xb.prototype.g=function(){return new XMLHttpRequest},e=new xb;var eI={},eT={};function Cb(e,r,i){e.M=1,e.A=Db(O(r)),e.u=i,e.R=!0,Eb(e,null)}function Eb(e,r){e.F=Date.now(),Fb(e),e.B=O(e.A);var i=e.B,o=e.S;Array.isArray(o)||(o=[String(o)]),Gb(i.i,"t",o),e.C=0,i=e.j.L,e.h=new zb,e.g=Hb(e.j,i?r:null,!e.u),e.P>0&&(e.O=new Ya(p(e.Y,e,e.g),e.P)),r=e.V,i=e.g,o=e.ba;var s="readystatechange";Array.isArray(s)||(s&&(eh[0]=s.toString()),s=eh);for(let e=0;e<s.length;e++){let l=Ka(i,s[e],o||r.handleEvent,!1,r.h||r);if(!l)break;r.g[l.key]=l}r=e.J?Ba(e.J):{},e.u?(e.v||(e.v="POST"),r["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,r)):(e.v="GET",e.g.ea(e.B,e.v,null,r)),lb(),qb(e.i,e.v,e.B,e.l,e.S,e.u)}function Kb(e){if(!Ob(e))return e.g.la();let r=Ib(e.g);if(""===r)return"";let i="",o=r.length,s=4==P(e.g);if(!e.h.i){if("undefined"==typeof TextDecoder)return Q(e),Mb(e),"";e.h.i=new k.TextDecoder}for(let l=0;l<o;l++)e.h.h=!0,i+=e.h.i.decode(r[l],{stream:!(s&&l==o-1)});return r.length=0,e.h.g+=i,e.C=0,e.h.g}function Ob(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.j.Aa}function Nb(e,r){var i=e.C,o=r.indexOf("\n",i);return -1==o?eT:isNaN(i=Number(r.substring(i,o)))?eI:(o+=1)+i>r.length?eT:(r=r.slice(o,o+i),e.C=o+i,r)}function Fb(e){e.T=Date.now()+e.H,Sb(e,e.H)}function Sb(e,r){if(null!=e.D)throw Error("WatchDog timer not null");e.D=ob(p(e.aa,e),r)}function Jb(e){e.D&&(k.clearTimeout(e.D),e.D=null)}function Mb(e){0==e.j.I||e.K||Qb(e.j,e)}function Q(e){Jb(e);var r=e.O;r&&"function"==typeof r.dispose&&r.dispose(),e.O=null,$a(e.V),e.g&&(r=e.g,e.g=null,r.abort(),r.dispose())}function Lb(e,r){try{var i=e.j;if(0!=i.I&&(i.g==e||Tb(i.h,e))){if(!e.L&&Tb(i.h,e)&&3==i.I){try{var o=i.Ba.g.parse(r)}catch(e){o=null}if(Array.isArray(o)&&3==o.length){var s=o;if(0==s[0]){e:if(!i.v){if(i.g){if(i.g.F+3e3<e.F)Ub(i),Vb(i);else break e}Wb(i),J(18)}}else i.xa=s[1],0<i.xa-i.K&&s[2]<37500&&i.F&&0==i.A&&!i.C&&(i.C=ob(p(i.Va,i),6e3));1>=Xb(i.h)&&i.ta&&(i.ta=void 0)}else R(i,11)}else if((e.L||i.g==e)&&Ub(i),!y(r))for(s=i.Ba.g.parse(r),r=0;r<s.length;r++){let d=s[r],f=d[0];if(!(f<=i.K)){if(i.K=f,d=d[1],2==i.I){if("c"==d[0]){i.M=d[1],i.ba=d[2];let r=d[3];null!=r&&(i.ka=r,i.j.info("VER="+i.ka));let s=d[4];null!=s&&(i.za=s,i.j.info("SVER="+i.za));let f=d[5];null!=f&&"number"==typeof f&&f>0&&(o=1.5*f,i.O=o,i.j.info("backChannelRequestTimeoutMs_="+o)),o=i;let _=e.g;if(_){let e=_.g?_.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var l=o.h;l.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(l.j=l.l,l.g=new Set,l.h&&(Yb(l,l.h),l.h=null))}if(o.G){let e=_.g?_.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(o.wa=e,S(o.J,o.G,e))}}if(i.I=3,i.l&&i.l.ra(),i.aa&&(i.T=Date.now()-e.F,i.j.info("Handshake RTT: "+i.T+"ms")),(o=i).na=Zb(o,o.L?o.ba:null,o.W),e.L){$b(o.h,e);var h=o.O;h&&(e.H=h),e.D&&(Jb(e),Fb(e)),o.g=e}else ac(o);i.i.length>0&&bc(i)}else"stop"!=d[0]&&"close"!=d[0]||R(i,7)}else 3==i.I&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?R(i,7):cc(i):"noop"!=d[0]&&i.l&&i.l.qa(d),i.A=0)}}}lb(4)}catch(e){}}N.prototype.ba=function(e){e=e.target;let r=this.O;r&&3==P(e)?r.j():this.Y(e)},N.prototype.Y=function(e){try{if(e==this.g)e:{let d=P(this.g),f=this.g.ya(),_=this.g.ca();if(!(d<3)&&(3!=d||this.g&&(this.h.h||this.g.la()||Ib(this.g)))){this.K||4!=d||7==f||(8==f||_<=0?lb(3):lb(2)),Jb(this);var r=this.g.ca();this.X=r;var i=Kb(this);if(this.o=200==r,rb(this.i,this.v,this.B,this.l,this.S,d,r),this.o){if(this.U&&!this.L){t:{if(this.g){var o,s=this.g;if((o=s.g?s.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(o)){var l=o;break t}}l=null}if(e=l)K(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Lb(this,e);else{this.o=!1,this.m=3,J(12),Q(this),Mb(this);break e}}if(this.R){let r;for(e=!0;!this.K&&this.C<i.length;)if((r=Nb(this,i))==eT){4==d&&(this.m=4,J(14),e=!1),K(this.i,this.l,null,"[Incomplete Response]");break}else if(r==eI){this.m=4,J(15),K(this.i,this.l,i,"[Invalid Chunk]"),e=!1;break}else K(this.i,this.l,r,null),Lb(this,r);if(Ob(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=i.length||this.h.h||(this.m=1,J(16),e=!1),this.o=this.o&&e,e){if(i.length>0&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.aa&&!h.P&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+i.length),Pb(h),h.P=!0,J(11))}}else K(this.i,this.l,i,"[Invalid Chunked Response]"),Q(this),Mb(this)}else K(this.i,this.l,i,null),Lb(this,i);4==d&&Q(this),this.o&&!this.K&&(4==d?Qb(this.j,this):(this.o=!1,Fb(this)))}else Rb(this.g),400==r&&i.indexOf("Unknown SID")>0?(this.m=3,J(12)):(this.m=0,J(13)),Q(this),Mb(this)}}}catch(e){}finally{}},N.prototype.cancel=function(){this.K=!0,Q(this)},N.prototype.aa=function(){this.D=null;let e=Date.now();e-this.T>=0?(tb(this.i,this.B),2!=this.M&&(lb(),J(17)),Q(this),this.m=2,Mb(this)):Sb(this,this.T-e)};var ev=class{constructor(e,r){this.g=e,this.map=r}};function ec(e){this.l=e||10,e=k.PerformanceNavigationTiming?(e=k.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(k.chrome&&k.chrome.loadTimes&&k.chrome.loadTimes()&&k.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function fc(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xb(e){return e.h?1:e.g?e.g.size:0}function Tb(e,r){return e.h?e.h==r:!!e.g&&e.g.has(r)}function Yb(e,r){e.g?e.g.add(r):e.h=r}function $b(e,r){e.h&&e.h==r?e.h=null:e.g&&e.g.has(r)&&e.g.delete(r)}function hc(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let r=e.i;for(let i of e.g.values())r=r.concat(i.G);return r}return ja(e.i)}ec.prototype.cancel=function(){if(this.i=hc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(let e of this.g.values())e.cancel();this.g.clear()}};var eA=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jc(e,r){if(e){e=e.split("&");for(let i=0;i<e.length;i++){let o=e[i].indexOf("="),s,l=null;o>=0?(s=e[i].substring(0,o),l=e[i].substring(o+1)):s=e[i],r(s,l?decodeURIComponent(l.replace(/\+/g," ")):"")}}}function T(e){let r;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof T?(this.l=e.l,kc(this,e.j),this.o=e.o,this.g=e.g,lc(this,e.u),this.h=e.h,mc(this,nc(e.i)),this.m=e.m):e&&(r=String(e).match(eA))?(this.l=!1,kc(this,r[1]||"",!0),this.o=oc(r[2]||""),this.g=oc(r[3]||"",!0),lc(this,r[4]),this.h=oc(r[5]||"",!0),mc(this,r[6]||"",!0),this.m=oc(r[7]||"")):(this.l=!1,this.i=new pc(null,this.l))}function O(e){return new T(e)}function kc(e,r,i){e.j=i?oc(r,!0):r,e.j&&(e.j=e.j.replace(/:$/,""))}function lc(e,r){if(r){if(isNaN(r=Number(r))||r<0)throw Error("Bad port number "+r);e.u=r}else e.u=null}function mc(e,r,i){r instanceof pc?(e.i=r,vc(e.i,e.l)):(i||(r=qc(r,eS)),e.i=new pc(r,e.l))}function S(e,r,i){e.i.set(r,i)}function Db(e){return S(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function oc(e,r){return e?r?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function qc(e,r,i){return"string"==typeof e?(e=encodeURI(e).replace(r,xc),i&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function xc(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}T.prototype.toString=function(){let e=[];var r=this.j;r&&e.push(qc(r,eP,!0),":");var i=this.g;return(i||"file"==r)&&(e.push("//"),(r=this.o)&&e.push(qc(r,eP,!0),"@"),e.push(L(i).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(i=this.u)&&e.push(":",String(i))),(i=this.h)&&(this.g&&"/"!=i.charAt(0)&&e.push("/"),e.push(qc(i,"/"==i.charAt(0)?ew:eR,!0))),(i=this.i.toString())&&e.push("?",i),(i=this.m)&&e.push("#",qc(i,ek)),e.join("")},T.prototype.resolve=function(e){let r=O(this),i=!!e.j;i?kc(r,e.j):i=!!e.o,i?r.o=e.o:i=!!e.g,i?r.g=e.g:i=null!=e.u;var o=e.h;if(i)lc(r,e.u);else if(i=!!e.h){if("/"!=o.charAt(0)){if(this.g&&!this.h)o="/"+o;else{var s=r.h.lastIndexOf("/");-1!=s&&(o=r.h.slice(0,s+1)+o)}}if(".."==(s=o)||"."==s)o="";else if(-1!=s.indexOf("./")||-1!=s.indexOf("/.")){o=0==s.lastIndexOf("/",0),s=s.split("/");let e=[];for(let r=0;r<s.length;){let i=s[r++];"."==i?o&&r==s.length&&e.push(""):".."==i?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),o&&r==s.length&&e.push("")):(e.push(i),o=!0)}o=e.join("/")}else o=s}return i?r.h=o:i=""!==e.i.toString(),i?mc(r,nc(e.i)):i=!!e.m,i&&(r.m=e.m),r};var eP=/[#\/\?@]/g,eR=/[#\?:]/g,ew=/[#\?]/g,eS=/[#\?@]/g,ek=/#/g;function pc(e,r){this.h=this.g=null,this.i=e||null,this.j=!!r}function U(e){e.g||(e.g=new Map,e.h=0,e.i&&jc(e.i,function(r,i){e.add(decodeURIComponent(r.replace(/\+/g," ")),i)}))}function yc(e,r){U(e),r=V(e,r),e.g.has(r)&&(e.i=null,e.h-=e.g.get(r).length,e.g.delete(r))}function zc(e,r){return U(e),r=V(e,r),e.g.has(r)}function Ac(e,r){U(e);let i=[];if("string"==typeof r)zc(e,r)&&(i=i.concat(e.g.get(V(e,r))));else for(e=Array.from(e.g.values()),r=0;r<e.length;r++)i=i.concat(e[r]);return i}function Gb(e,r,i){yc(e,r),i.length>0&&(e.i=null,e.g.set(V(e,r),ja(i)),e.h+=i.length)}function nc(e){let r=new pc;return r.i=e.i,e.g&&(r.g=new Map(e.g),r.h=e.h),r}function V(e,r){return r=String(r),e.j&&(r=r.toLowerCase()),r}function vc(e,r){r&&!e.j&&(U(e),e.i=null,e.g.forEach(function(e,r){let i=r.toLowerCase();r!=i&&(yc(this,r),Gb(this,i,e))},e)),e.j=r}function Bc(e,r){let i=new pb;if(k.Image){let o=new Image;o.onload=ha(W,i,"TestLoadImage: loaded",!0,r,o),o.onerror=ha(W,i,"TestLoadImage: error",!1,r,o),o.onabort=ha(W,i,"TestLoadImage: abort",!1,r,o),o.ontimeout=ha(W,i,"TestLoadImage: timeout",!1,r,o),k.setTimeout(function(){o.ontimeout&&o.ontimeout()},1e4),o.src=e}else r(!1)}function Cc(e,r){let i=new pb,o=new AbortController,s=setTimeout(()=>{o.abort(),W(i,"TestPingServer: timeout",!1,r)},1e4);fetch(e,{signal:o.signal}).then(e=>{clearTimeout(s),e.ok?W(i,"TestPingServer: ok",!0,r):W(i,"TestPingServer: server error",!1,r)}).catch(()=>{clearTimeout(s),W(i,"TestPingServer: error",!1,r)})}function W(e,r,i,o,s){try{s&&(s.onload=null,s.onerror=null,s.onabort=null,s.ontimeout=null),o(i)}catch(e){}}function Dc(){this.g=new ep}function Ec(e){this.i=e.Sb||null,this.h=e.ab||!1}function Fc(e,r){C.call(this),this.H=e,this.o=r,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Ic(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function Hc(e){e.readyState=4,e.l=null,e.j=null,e.B=null,Gc(e)}function Gc(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Jc(e){let r="";return ya(e,function(e,i){r+=i+":"+e+"\r\n"}),r}function Kc(e,r,i){e:{for(o in i){var o=!1;break e}o=!0}o||(i=Jc(i),"string"==typeof e?null!=i&&L(i):S(e,r,i))}function X(e){C.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(r=pc.prototype).add=function(e,r){U(this),this.i=null,e=V(this,e);let i=this.g.get(e);return i||this.g.set(e,i=[]),i.push(r),this.h+=1,this},r.forEach=function(e,r){U(this),this.g.forEach(function(i,o){i.forEach(function(i){e.call(r,i,o,this)},this)},this)},r.set=function(e,r){return U(this),this.i=null,zc(this,e=V(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[r]),this.h+=1,this},r.get=function(e,r){return e&&(e=Ac(this,e)).length>0?String(e[0]):r},r.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],r=Array.from(this.g.keys());for(let o=0;o<r.length;o++){var i=r[o];let s=L(i);i=Ac(this,i);for(let r=0;r<i.length;r++){let o=s;""!==i[r]&&(o+="="+L(i[r])),e.push(o)}}return this.i=e.join("&")},t(Ec,eb),Ec.prototype.g=function(){return new Fc(this.i,this.h)},t(Fc,C),(r=Fc.prototype).open=function(e,r){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=r,this.readyState=1,Gc(this)},r.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let r={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(r.body=e),(this.H||k).fetch(new Request(this.D,r)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,Hc(this)),this.readyState=0},r.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Gc(this)),this.g&&(this.readyState=3,Gc(this),this.g))){if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(void 0!==k.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ic(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))}},r.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var r=e.value?e.value:new Uint8Array(0);(r=this.B.decode(r,{stream:!e.done}))&&(this.response=this.responseText+=r)}e.done?Hc(this):Gc(this),3==this.readyState&&Ic(this)}},r.Oa=function(e){this.g&&(this.response=this.responseText=e,Hc(this))},r.Na=function(e){this.g&&(this.response=e,Hc(this))},r.ga=function(){this.g&&Hc(this)},r.setRequestHeader=function(e,r){this.A.append(e,r)},r.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],r=this.h.entries();for(var i=r.next();!i.done;)e.push((i=i.value)[0]+": "+i[1]),i=r.next();return e.join("\r\n")},Object.defineProperty(Fc.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),t(X,C);var eV=/^https?$/i,eC=["POST","PUT"];function Nc(e,r){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=r,e.o=5,Oc(e),Pc(e)}function Oc(e){e.A||(e.A=!0,D(e,"complete"),D(e,"error"))}function Qc(e){if(e.h&&void 0!==s){if(e.v&&4==P(e))setTimeout(e.Ca.bind(e),0);else if(D(e,"readystatechange"),4==P(e)){e.h=!1;try{let s=e.ca();switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r,i,o=!0;break;default:o=!1}if(!(r=o)){if(i=0===s){let r=String(e.D).match(eA)[1]||null;!r&&k.self&&k.self.location&&(r=k.self.location.protocol.slice(0,-1)),i=!eV.test(r?r.toLowerCase():"")}r=i}if(r)D(e,"complete"),D(e,"success");else{e.o=6;try{var l=P(e)>2?e.g.statusText:""}catch(e){l=""}e.l=l+" ["+e.ca()+"]",Oc(e)}}finally{Pc(e)}}}}function Pc(e,r){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);let i=e.g;e.g=null,r||D(e,"ready");try{i.onreadystatechange=null}catch(e){}}}function P(e){return e.g?e.g.readyState:0}function Ib(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Rb(e){let r={};e=(e.g&&P(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let o=0;o<e.length;o++){if(y(e[o]))continue;var i=yb(e[o]);let s=i[0];if("string"!=typeof(i=i[1]))continue;i=i.trim();let l=r[s]||[];r[s]=l,l.push(i)}Aa(r,function(e){return e.join(", ")})}function Rc(e,r,i){return i&&i.internalChannelParams&&i.internalChannelParams[e]||r}function Sc(e){this.za=0,this.i=[],this.j=new pb,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Rc("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Rc("baseRetryDelayMs",5e3,e),this.Za=Rc("retryDelaySeedMs",1e4,e),this.Ta=Rc("forwardChannelMaxRetries",2,e),this.va=Rc("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new ec(e&&e.concurrentRequestLimit),this.Ba=new Dc,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function cc(e){if(Tc(e),3==e.I){var r=e.V++,i=O(e.J);if(S(i,"SID",e.M),S(i,"RID",r),S(i,"TYPE","terminate"),Uc(e,i),(r=new N(e,e.j,r)).M=2,r.A=Db(O(i)),i=!1,k.navigator&&k.navigator.sendBeacon)try{i=k.navigator.sendBeacon(r.A.toString(),"")}catch(e){}!i&&k.Image&&((new Image).src=r.A,i=!0),i||(r.g=Hb(r.j,null),r.g.ea(r.A)),r.F=Date.now(),Fb(r)}Vc(e)}function Vb(e){e.g&&(Pb(e),e.g.cancel(),e.g=null)}function Tc(e){Vb(e),e.v&&(k.clearTimeout(e.v),e.v=null),Ub(e),e.h.cancel(),e.m&&("number"==typeof e.m&&k.clearTimeout(e.m),e.m=null)}function bc(e){if(!fc(e.h)&&!e.m){e.m=!0;var r=e.Ea;q||ta(),$||(q(),$=!0),ee.add(r,e),e.D=0}}function Wc(e,r){return!(Xb(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=r.G.concat(e.i),!0):1!=e.I&&2!=e.I&&!(e.D>=(e.Sa?0:e.Ta))&&(e.m=ob(p(e.Ea,e,r),Xc(e,e.D)),e.D++,!0))}function Zc(e,r){var i;i=r?r.l:e.V++;let o=O(e.J);S(o,"SID",e.M),S(o,"RID",i),S(o,"AID",e.K),Uc(e,o),e.u&&e.o&&Kc(o,e.u,e.o),i=new N(e,e.j,i,e.D+1),null===e.u&&(i.J=e.o),r&&(e.i=r.G.concat(e.i)),r=Yc(e,i,1e3),i.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Yb(e.h,i),Cb(i,o,r)}function Uc(e,r){e.H&&ya(e.H,function(e,i){S(r,i,e)}),e.l&&ya({},function(e,i){S(r,i,e)})}function Yc(e,r,i){i=Math.min(e.i.length,i);let o=e.l?p(e.l.Ka,e.l,e):null;e:{var s=e.i;let r=-1;for(;;){let e=["count="+i];-1==r?i>0?(r=s[0].g,e.push("ofs="+r)):r=0:e.push("ofs="+r);let d=!0;for(let f=0;f<i;f++){var l=s[f].g;let i=s[f].map;if((l-=r)<0)r=Math.max(0,s[f].g-100),d=!1;else try{l="req"+l+"_";try{var h=i instanceof Map?i:Object.entries(i);for(let[r,i]of h){let o=i;n(i)&&(o=ed(i)),e.push(l+r+"="+encodeURIComponent(o))}}catch(r){throw e.push(l+"type="+encodeURIComponent("_badmap")),r}}catch(e){o&&o(i)}}if(d){h=e.join("&");break e}}h=void 0}return e=e.i.splice(0,i),r.G=e,h}function ac(e){if(!e.g&&!e.v){e.Y=1;var r=e.Da;q||ta(),$||(q(),$=!0),ee.add(r,e),e.A=0}}function Wb(e){return!e.g&&!e.v&&!(e.A>=3)&&(e.Y++,e.v=ob(p(e.Da,e),Xc(e,e.A)),e.A++,!0)}function Pb(e){null!=e.B&&(k.clearTimeout(e.B),e.B=null)}function $c(e){e.g=new N(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var r=O(e.na);S(r,"RID","rpc"),S(r,"SID",e.M),S(r,"AID",e.K),S(r,"CI",e.F?"0":"1"),!e.F&&e.ia&&S(r,"TO",e.ia),S(r,"TYPE","xmlhttp"),Uc(e,r),e.u&&e.o&&Kc(r,e.u,e.o),e.O&&(e.g.H=e.O);var i=e.g;e=e.ba,i.M=1,i.A=Db(O(r)),i.u=null,i.R=!0,Eb(i,e)}function Ub(e){null!=e.C&&(k.clearTimeout(e.C),e.C=null)}function Qb(e,r){var i=null;if(e.g==r){Ub(e),Pb(e),e.g=null;var o=2}else{if(!Tb(e.h,r))return;i=r.G,$b(e.h,r),o=1}if(0!=e.I){if(r.o){if(1==o){i=r.u?r.u.length:0,r=Date.now()-r.F;var s=e.D;D(o=jb(),new nb(o,i)),bc(e)}else ac(e)}else if(3==(s=r.m)||0==s&&r.X>0||!(1==o&&Wc(e,r)||2==o&&Wb(e)))switch(i&&i.length>0&&((r=e.h).i=r.i.concat(i)),s){case 1:R(e,5);break;case 4:R(e,10);break;case 3:R(e,6);break;default:R(e,2)}}}function Xc(e,r){let i=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(i*=2),i*r}function R(e,r){if(e.j.info("Error code "+r),2==r){var i=p(e.bb,e),o=e.Ua;let r=!o;o=new T(o||"//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||kc(o,"https"),Db(o),r?Bc(o.toString(),i):Cc(o.toString(),i)}else J(2);e.I=0,e.l&&e.l.pa(r),Vc(e),Tc(e)}function Vc(e){if(e.I=0,e.ja=[],e.l){let r=hc(e.h);(0!=r.length||0!=e.i.length)&&(ka(e.ja,r),ka(e.ja,e.i),e.h.i.length=0,ja(e.i),e.i.length=0),e.l.oa()}}function Zb(e,r,i){var o=i instanceof T?O(i):new T(i);if(""!=o.g)r&&(o.g=r+"."+o.g),lc(o,o.u);else{var s=k.location;o=s.protocol,r=r?r+"."+s.hostname:s.hostname,s=+s.port;let e=new T(null);o&&kc(e,o),r&&(e.g=r),s&&lc(e,s),i&&(e.h=i),o=e}return i=e.G,r=e.wa,i&&r&&S(o,i,r),S(o,"VER",e.ka),Uc(e,o),o}function Hb(e,r,i){if(r&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(r=new X(e.Aa&&!e.ma?new Ec({ab:i}):e.ma)).Fa(e.L),r}function ad(){}function bd(){}function Y(e,r){C.call(this),this.g=new Sc(r),this.l=e,this.h=r&&r.messageUrlParams||null,e=r&&r.messageHeaders||null,r&&r.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=r&&r.initMessageHeaders||null,r&&r.messageContentType&&(e?e["X-WebChannel-Content-Type"]=r.messageContentType:e={"X-WebChannel-Content-Type":r.messageContentType}),r&&r.sa&&(e?e["X-WebChannel-Client-Profile"]=r.sa:e={"X-WebChannel-Client-Profile":r.sa}),this.g.U=e,(e=r&&r.Qb)&&!y(e)&&(this.g.u=e),this.A=r&&r.supportsCrossDomainXhr||!1,this.v=r&&r.sendRawJson||!1,(r=r&&r.httpSessionIdParam)&&!y(r)&&(this.g.G=r,null!==(e=this.h)&&r in e&&r in(e=this.h)&&delete e[r]),this.j=new Z(this)}function cd(e){gb.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var r=e.__sm__;if(r){e:{for(let i in r){e=i;break e}e=void 0}(this.i=e)&&(e=this.i,r=null!==r&&e in r?r[e]:void 0),this.data=r}else this.data=e}function dd(){hb.call(this),this.status=1}function Z(e){this.g=e}(r=X.prototype).Fa=function(e){this.H=e},r.ea=function(r,i,o,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+r);i=i?i.toUpperCase():"GET",this.D=r,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():e.g(),this.g.onreadystatechange=M(p(this.Ca,this));try{this.B=!0,this.g.open(i,String(r),!0),this.B=!1}catch(e){Nc(this,e);return}if(r=o||"",o=new Map(this.headers),s){if(Object.getPrototypeOf(s)===Object.prototype)for(var l in s)o.set(l,s[l]);else if("function"==typeof s.keys&&"function"==typeof s.get)for(let e of s.keys())o.set(e,s.get(e));else throw Error("Unknown input type for opt_headers: "+String(s))}for(let[e,h]of(s=Array.from(o.keys()).find(e=>"content-type"==e.toLowerCase()),l=k.FormData&&r instanceof k.FormData,!(Array.prototype.indexOf.call(eC,i,void 0)>=0)||s||l||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o))this.g.setRequestHeader(e,h);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(r),this.v=!1}catch(e){Nc(this,e)}},r.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,D(this,"complete"),D(this,"abort"),Pc(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Pc(this,!0)),X.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?Qc(this):this.Xa())},r.Xa=function(){Qc(this)},r.isActive=function(){return!!this.g},r.ca=function(){try{return P(this)>2?this.g.status:-1}catch(e){return -1}},r.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},r.La=function(e){if(this.g){var r=this.g.responseText;return e&&0==r.indexOf(e)&&(r=r.substring(e.length)),ef(r)}},r.ya=function(){return this.o},r.Ha=function(){return"string"==typeof this.l?this.l:String(this.l)},(r=Sc.prototype).ka=8,r.I=1,r.connect=function(e,r,i,o){J(0),this.W=e,this.H=r||{},i&&void 0!==o&&(this.H.OSID=i,this.H.OAID=o),this.F=this.X,this.J=Zb(this,null,this.W),bc(this)},r.Ea=function(e){if(this.m){if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;let s=new N(this,this.j,e),l=this.o;if(this.U&&(l?Da(l=Ba(l),this.U):l=this.U),null!==this.u||this.R||(s.J=l,l=null),this.S)e:{for(var r=0,i=0;i<this.i.length;i++){t:{var o=this.i[i];if("__data__"in o.map&&"string"==typeof(o=o.map.__data__)){o=o.length;break t}o=void 0}if(void 0===o)break;if((r+=o)>4096){r=i;break e}if(4096===r||i===this.i.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=Yc(this,s,r),S(i=O(this.J),"RID",e),S(i,"CVER",22),this.G&&S(i,"X-HTTP-Session-Id",this.G),Uc(this,i),l&&(this.R?r="headers="+L(Jc(l))+"&"+r:this.u&&Kc(i,this.u,l)),Yb(this.h,s),this.Ra&&S(i,"TYPE","init"),this.S?(S(i,"$req",r),S(i,"SID","null"),s.U=!0,Cb(s,i,null)):Cb(s,i,r),this.I=2}}else 3==this.I&&(e?Zc(this,e):0==this.i.length||fc(this.h)||Zc(this))}},r.Da=function(){if(this.v=null,$c(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=ob(p(this.Wa,this),e)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,J(10),Vb(this),$c(this))},r.Va=function(){null!=this.C&&(this.C=null,Vb(this),Wb(this),J(19))},r.bb=function(e){e?(this.j.info("Successfully pinged google.com"),J(2)):(this.j.info("Failed to ping google.com"),J(1))},r.isActive=function(){return!!this.l&&this.l.isActive(this)},(r=ad.prototype).ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){},bd.prototype.g=function(e,r){return new Y(e,r)},t(Y,C),Y.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Y.prototype.close=function(){cc(this.g)},Y.prototype.o=function(e){var r=this.g;if("string"==typeof e){var i={};i.__data__=e,e=i}else this.v&&((i={}).__data__=ed(e),e=i);r.i.push(new ev(r.Ya++,e)),3==r.I&&bc(r)},Y.prototype.N=function(){this.g.l=null,delete this.j,cc(this.g),delete this.g,Y.Z.N.call(this)},t(cd,gb),t(dd,hb),t(Z,ad),Z.prototype.ra=function(){D(this.g,"a")},Z.prototype.qa=function(e){D(this.g,new cd(e))},Z.prototype.pa=function(e){D(this.g,new dd)},Z.prototype.oa=function(){D(this.g,"b")},bd.prototype.createWebChannel=bd.prototype.g,Y.prototype.send=Y.prototype.o,Y.prototype.open=Y.prototype.m,Y.prototype.close=Y.prototype.close,b=es.createWebChannelTransport=function(){return new bd},A=es.getStatEventTarget=function(){return jb()},g=es.Event=e_,_=es.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ey.NO_ERROR=0,ey.TIMEOUT=8,ey.HTTP_ERROR=6,f=es.ErrorCode=ey,eE.COMPLETE="complete",d=es.EventType=eE,fb.EventType=em,em.OPEN="a",em.CLOSE="b",em.ERROR="c",em.MESSAGE="d",C.prototype.listen=C.prototype.J,h=es.WebChannel=fb,es.FetchXmlHttpFactory=Ec,X.prototype.listenOnce=X.prototype.K,X.prototype.getLastError=X.prototype.Ha,X.prototype.getLastErrorCode=X.prototype.ya,X.prototype.getStatus=X.prototype.ca,X.prototype.getResponseJson=X.prototype.La,X.prototype.getResponseText=X.prototype.la,X.prototype.send=X.prototype.ea,X.prototype.setWithCredentials=X.prototype.Fa,l=es.XhrIo=X}).apply(void 0!==eo?eo:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),i(3454);var ea=i(1876).Buffer;let el="@firebase/firestore",eu="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let User=class User{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User("google-credentials-uid"),User.FIRST_PARTY=new User("first-party-uid"),User.MOCK_USER=new User("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eh="12.7.0",ed=new et.Yd("@firebase/firestore");function __PRIVATE_getLogLevel(){return ed.logLevel}function __PRIVATE_logDebug(e,...r){if(ed.logLevel<=et.in.DEBUG){let i=r.map(__PRIVATE_argToString);ed.debug(`Firestore (${eh}): ${e}`,...i)}}function __PRIVATE_logError(e,...r){if(ed.logLevel<=et.in.ERROR){let i=r.map(__PRIVATE_argToString);ed.error(`Firestore (${eh}): ${e}`,...i)}}function __PRIVATE_logWarn(e,...r){if(ed.logLevel<=et.in.WARN){let i=r.map(__PRIVATE_argToString);ed.warn(`Firestore (${eh}): ${e}`,...i)}}function __PRIVATE_argToString(e){if("string"==typeof e)return e;try{/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */return JSON.stringify(e)}catch(r){return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fail(e,r,i){let o="Unexpected state";"string"==typeof r?o=r:i=r,__PRIVATE__fail(e,o,i)}function __PRIVATE__fail(e,r,i){let o=`FIRESTORE (${eh}) INTERNAL ASSERTION FAILED: ${r} (ID: ${e.toString(16)})`;if(void 0!==i)try{o+=" CONTEXT: "+JSON.stringify(i)}catch(e){o+=" CONTEXT: "+i}throw __PRIVATE_logError(o),Error(o)}function __PRIVATE_hardAssert(e,r,i,o){let s="Unexpected state";"string"==typeof i?s=i:o=i,e||__PRIVATE__fail(r,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ef={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};let FirestoreError=class FirestoreError extends en.ZR{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_Deferred=class __PRIVATE_Deferred{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_OAuthToken=class __PRIVATE_OAuthToken{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}};let __PRIVATE_EmptyAuthCredentialsProvider=class __PRIVATE_EmptyAuthCredentialsProvider{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(User.UNAUTHENTICATED))}shutdown(){}};let __PRIVATE_EmulatorAuthCredentialsProvider=class __PRIVATE_EmulatorAuthCredentialsProvider{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}};let __PRIVATE_FirebaseAuthCredentialsProvider=class __PRIVATE_FirebaseAuthCredentialsProvider{constructor(e){this.t=e,this.currentUser=User.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){__PRIVATE_hardAssert(void 0===this.o,42304);let i=this.i,__PRIVATE_guardedChangeListener=e=>this.i!==i?(i=this.i,r(e)):Promise.resolve(),o=new __PRIVATE_Deferred;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new __PRIVATE_Deferred,e.enqueueRetryable(()=>__PRIVATE_guardedChangeListener(this.currentUser))};let __PRIVATE_awaitNextToken=()=>{let r=o;e.enqueueRetryable(async()=>{await r.promise,await __PRIVATE_guardedChangeListener(this.currentUser)})},__PRIVATE_registerAuth=e=>{__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),__PRIVATE_awaitNextToken())};this.t.onInit(e=>__PRIVATE_registerAuth(e)),setTimeout(()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?__PRIVATE_registerAuth(e):(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new __PRIVATE_Deferred)}},0),__PRIVATE_awaitNextToken()}getToken(){let e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(r=>this.i!==e?(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(__PRIVATE_hardAssert("string"==typeof r.accessToken,31837,{l:r}),new __PRIVATE_OAuthToken(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return __PRIVATE_hardAssert(null===e||"string"==typeof e,2055,{h:e}),new User(e)}};let __PRIVATE_FirstPartyToken=class __PRIVATE_FirstPartyToken{constructor(e,r,i){this.P=e,this.T=r,this.I=i,this.type="FirstParty",this.user=User.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}};let __PRIVATE_FirstPartyAuthCredentialsProvider=class __PRIVATE_FirstPartyAuthCredentialsProvider{constructor(e,r,i){this.P=e,this.T=r,this.I=i}getToken(){return Promise.resolve(new __PRIVATE_FirstPartyToken(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(User.FIRST_PARTY))}shutdown(){}invalidateToken(){}};let AppCheckToken=class AppCheckToken{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}};let __PRIVATE_FirebaseAppCheckTokenProvider=class __PRIVATE_FirebaseAppCheckTokenProvider{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,$.rh)(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){__PRIVATE_hardAssert(void 0===this.o,3512);let onTokenChanged=e=>{null!=e.error&&__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let i=e.token!==this.m;return this.m=e.token,__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(e.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>onTokenChanged(r))};let __PRIVATE_registerAppCheck=e=>{__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>__PRIVATE_registerAppCheck(e)),setTimeout(()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?__PRIVATE_registerAppCheck(e):__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new AppCheckToken(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(__PRIVATE_hardAssert("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new AppCheckToken(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_randomBytes(e){let r="undefined"!=typeof self&&(self.crypto||self.msCrypto),i=new Uint8Array(e);if(r&&"function"==typeof r.getRandomValues)r.getRandomValues(i);else for(let r=0;r<e;r++)i[r]=Math.floor(256*Math.random());return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_AutoId=class __PRIVATE_AutoId{static newId(){let e=62*Math.floor(256/62),r="";for(;r.length<20;){let i=__PRIVATE_randomBytes(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<e&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[o]%62))}return r}};function __PRIVATE_primitiveComparator(e,r){return e<r?-1:e>r?1:0}function __PRIVATE_compareUtf8Strings(e,r){let i=Math.min(e.length,r.length);for(let o=0;o<i;o++){let i=e.charAt(o),s=r.charAt(o);if(i!==s)return __PRIVATE_isSurrogate(i)===__PRIVATE_isSurrogate(s)?__PRIVATE_primitiveComparator(i,s):__PRIVATE_isSurrogate(i)?1:-1}return __PRIVATE_primitiveComparator(e.length,r.length)}function __PRIVATE_isSurrogate(e){let r=e.charCodeAt(0);return r>=55296&&r<=57343}function __PRIVATE_arrayEquals(e,r,i){return e.length===r.length&&e.every((e,o)=>i(e,r[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ep="__name__";let BasePath=class BasePath{constructor(e,r,i){void 0===r?r=0:r>e.length&&fail(637,{offset:r,range:e.length}),void 0===i?i=e.length-r:i>e.length-r&&fail(1746,{length:i,range:e.length-r}),this.segments=e,this.offset=r,this.len=i}get length(){return this.len}isEqual(e){return 0===BasePath.comparator(this,e)}child(e){let r=this.segments.slice(this.offset,this.limit());return e instanceof BasePath?e.forEach(e=>{r.push(e)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,i=this.limit();r<i;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){let i=Math.min(e.length,r.length);for(let o=0;o<i;o++){let i=BasePath.compareSegments(e.get(o),r.get(o));if(0!==i)return i}return __PRIVATE_primitiveComparator(e.length,r.length)}static compareSegments(e,r){let i=BasePath.isNumericId(e),o=BasePath.isNumericId(r);return i&&!o?-1:!i&&o?1:i&&o?BasePath.extractNumericId(e).compare(BasePath.extractNumericId(r)):__PRIVATE_compareUtf8Strings(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return o.fromString(e.substring(4,e.length-2))}};let ResourcePath=class ResourcePath extends BasePath{construct(e,r,i){return new ResourcePath(e,r,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let r=[];for(let i of e){if(i.indexOf("//")>=0)throw new FirestoreError(ef.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);r.push(...i.split("/").filter(e=>e.length>0))}return new ResourcePath(r)}static emptyPath(){return new ResourcePath([])}};let em=/^[_a-zA-Z][_a-zA-Z0-9]*$/;let FieldPath$1=class FieldPath$1 extends BasePath{construct(e,r,i){return new FieldPath$1(e,r,i)}static isValidIdentifier(e){return em.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),FieldPath$1.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===ep}static keyField(){return new FieldPath$1([ep])}static fromServerFormat(e){let r=[],i="",o=0,__PRIVATE_addCurrentSegment=()=>{if(0===i.length)throw new FirestoreError(ef.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(i),i=""},s=!1;for(;o<e.length;){let r=e[o];if("\\"===r){if(o+1===e.length)throw new FirestoreError(ef.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let r=e[o+1];if("\\"!==r&&"."!==r&&"`"!==r)throw new FirestoreError(ef.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=r,o+=2}else"`"===r?s=!s:"."!==r||s?i+=r:__PRIVATE_addCurrentSegment(),o++}if(__PRIVATE_addCurrentSegment(),s)throw new FirestoreError(ef.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new FieldPath$1(r)}static emptyPath(){return new FieldPath$1([])}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DocumentKey=class DocumentKey{constructor(e){this.path=e}static fromPath(e){return new DocumentKey(ResourcePath.fromString(e))}static fromName(e){return new DocumentKey(ResourcePath.fromString(e).popFirst(5))}static empty(){return new DocumentKey(ResourcePath.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ResourcePath.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,r){return ResourcePath.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new DocumentKey(new ResourcePath(e.slice()))}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateNonEmptyArgument(e,r,i){if(!i)throw new FirestoreError(ef.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${r}.`)}function __PRIVATE_validateIsNotUsedTogether(e,r,i,o){if(!0===r&&!0===o)throw new FirestoreError(ef.INVALID_ARGUMENT,`${e} and ${i} cannot be used together.`)}function __PRIVATE_validateDocumentPath(e){if(!DocumentKey.isDocumentKey(e))throw new FirestoreError(ef.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function __PRIVATE_validateCollectionPath(e){if(DocumentKey.isDocumentKey(e))throw new FirestoreError(ef.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function __PRIVATE_isPlainObject(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function __PRIVATE_valueDescription(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{var r;let i=(r=e).constructor?r.constructor.name:null;return i?`a custom ${i} object`:"an object"}}return"function"==typeof e?"a function":fail(12329,{type:typeof e})}function __PRIVATE_cast(e,r){if("_delegate"in e&&(e=e._delegate),!(e instanceof r)){if(r.name===e.constructor.name)throw new FirestoreError(ef.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let i=__PRIVATE_valueDescription(e);throw new FirestoreError(ef.INVALID_ARGUMENT,`Expected type '${r.name}', but it was: ${i}`)}}return e}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function property(e,r){let i={typeString:e};return r&&(i.value=r),i}function __PRIVATE_validateJSON(e,r){let i;if(!__PRIVATE_isPlainObject(e))throw new FirestoreError(ef.INVALID_ARGUMENT,"JSON must be an object");for(let o in r)if(r[o]){let s=r[o].typeString,l="value"in r[o]?{value:r[o].value}:void 0;if(!(o in e)){i=`JSON missing required field: '${o}'`;break}let h=e[o];if(s&&typeof h!==s){i=`JSON field '${o}' must be a ${s}.`;break}if(void 0!==l&&h!==l.value){i=`Expected '${o}' field to equal '${l.value}'`;break}}if(i)throw new FirestoreError(ef.INVALID_ARGUMENT,i);return!0}let Timestamp=class Timestamp{static now(){return Timestamp.fromMillis(Date.now())}static fromDate(e){return Timestamp.fromMillis(e.getTime())}static fromMillis(e){let r=Math.floor(e/1e3),i=Math.floor((e-1e3*r)*1e6);return new Timestamp(r,i)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0||r>=1e9)throw new FirestoreError(ef.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800||e>=253402300800)throw new FirestoreError(ef.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?__PRIVATE_primitiveComparator(this.nanoseconds,e.nanoseconds):__PRIVATE_primitiveComparator(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Timestamp._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(__PRIVATE_validateJSON(e,Timestamp._jsonSchema))return new Timestamp(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Timestamp._jsonSchemaVersion="firestore/timestamp/1.0",Timestamp._jsonSchema={type:property("string",Timestamp._jsonSchemaVersion),seconds:property("number"),nanoseconds:property("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SnapshotVersion=class SnapshotVersion{static fromTimestamp(e){return new SnapshotVersion(e)}static min(){return new SnapshotVersion(new Timestamp(0,0))}static max(){return new SnapshotVersion(new Timestamp(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};let FieldIndex=class FieldIndex{constructor(e,r,i,o){this.indexId=e,this.collectionGroup=r,this.fields=i,this.indexState=o}};function __PRIVATE_newIndexOffsetSuccessorFromReadTime(e,r){let i=e.toTimestamp().seconds,o=e.toTimestamp().nanoseconds+1,s=SnapshotVersion.fromTimestamp(1e9===o?new Timestamp(i+1,0):new Timestamp(i,o));return new IndexOffset(s,DocumentKey.empty(),r)}function __PRIVATE_newIndexOffsetFromDocument(e){return new IndexOffset(e.readTime,e.key,-1)}FieldIndex.UNKNOWN_ID=-1;let IndexOffset=class IndexOffset{constructor(e,r,i){this.readTime=e,this.documentKey=r,this.largestBatchId=i}static min(){return new IndexOffset(SnapshotVersion.min(),DocumentKey.empty(),-1)}static max(){return new IndexOffset(SnapshotVersion.max(),DocumentKey.empty(),-1)}};function __PRIVATE_indexOffsetComparator(e,r){let i=e.readTime.compareTo(r.readTime);return 0!==i?i:0!==(i=DocumentKey.comparator(e.documentKey,r.documentKey))?i:__PRIVATE_primitiveComparator(e.largestBatchId,r.largestBatchId)}let PersistenceTransaction=class PersistenceTransaction{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function __PRIVATE_ignoreIfPrimaryLeaseLoss(e){if(e.code!==ef.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;__PRIVATE_logDebug("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PersistencePromise=class PersistencePromise{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&fail(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new PersistencePromise((i,o)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(i,o)},this.catchCallback=e=>{this.wrapFailure(r,e).next(i,o)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{let r=e();return r instanceof PersistencePromise?r:PersistencePromise.resolve(r)}catch(e){return PersistencePromise.reject(e)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):PersistencePromise.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):PersistencePromise.reject(r)}static resolve(e){return new PersistencePromise((r,i)=>{r(e)})}static reject(e){return new PersistencePromise((r,i)=>{i(e)})}static waitFor(e){return new PersistencePromise((r,i)=>{let o=0,s=0,l=!1;e.forEach(e=>{++o,e.next(()=>{++s,l&&s===o&&r()},e=>i(e))}),l=!0,s===o&&r()})}static or(e){let r=PersistencePromise.resolve(!1);for(let i of e)r=r.next(e=>e?PersistencePromise.resolve(e):i());return r}static forEach(e,r){let i=[];return e.forEach((e,o)=>{i.push(r.call(this,e,o))}),this.waitFor(i)}static mapArray(e,r){return new PersistencePromise((i,o)=>{let s=e.length,l=Array(s),h=0;for(let d=0;d<s;d++){let f=d;r(e[f]).next(e=>{l[f]=e,++h===s&&i(l)},e=>o(e))}})}static doWhile(e,r){return new PersistencePromise((i,o)=>{let process=()=>{!0===e()?r().next(()=>{process()},o):i()};process()})}};function __PRIVATE_getAndroidVersion(e){let r=e.match(/Android ([\d.]+)/i),i=r?r[1].split(".").slice(0,2).join("."):"-1";return Number(i)}function __PRIVATE_isIndexedDbTransactionError(e){return"IndexedDbTransactionError"===e.name}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_ListenSequence=class __PRIVATE_ListenSequence{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>r.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}};function __PRIVATE_isNegativeZero(e){return 0===e&&1/e==-1/0}function isSafeInteger(e){return"number"==typeof e&&Number.isInteger(e)&&!__PRIVATE_isNegativeZero(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function __PRIVATE_encodeResourcePath(e){var r,i;let o="";for(let r=0;r<e.length;r++)o.length>0&&(o+="\x01\x01"),o=__PRIVATE_encodeSegment(e.get(r),o);return o+"\x01\x01"}function __PRIVATE_encodeSegment(e,r){let i=r,o=e.length;for(let r=0;r<o;r++){let o=e.charAt(r);switch(o){case"\x00":i+="\x01\x10";break;case"\x01":i+="\x01\x11";break;default:i+=o}}return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_objectSize(e){let r=0;for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&r++;return r}function forEach(e,r){for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&r(i,e[i])}function isEmpty(e){for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}__PRIVATE_ListenSequence.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SortedMap=class SortedMap{constructor(e,r){this.comparator=e,this.root=r||LLRBNode.EMPTY}insert(e,r){return new SortedMap(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}remove(e){return new SortedMap(this.comparator,this.root.remove(e,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(0===i)return r.value;i<0?r=r.left:i>0&&(r=r.right)}return null}indexOf(e){let r=0,i=this.root;for(;!i.isEmpty();){let o=this.comparator(e,i.key);if(0===o)return r+i.left.size;o<0?i=i.left:(r+=i.left.size+1,i=i.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,i)=>(e(r,i),!1))}toString(){let e=[];return this.inorderTraversal((r,i)=>(e.push(`${r}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new SortedMapIterator(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!1)}getReverseIterator(){return new SortedMapIterator(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!0)}};let SortedMapIterator=class SortedMapIterator{constructor(e,r,i,o){this.isReverse=o,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?i(e.key,r):1,r&&o&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}};let LLRBNode=class LLRBNode{constructor(e,r,i,o,s){this.key=e,this.value=r,this.color=null!=i?i:LLRBNode.RED,this.left=null!=o?o:LLRBNode.EMPTY,this.right=null!=s?s:LLRBNode.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,i,o,s){return new LLRBNode(null!=e?e:this.key,null!=r?r:this.value,null!=i?i:this.color,null!=o?o:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,i){let o=this,s=i(e,o.key);return(o=s<0?o.copy(null,null,null,o.left.insert(e,r,i),null):0===s?o.copy(null,r,null,null,null):o.copy(null,null,null,null,o.right.insert(e,r,i))).fixUp()}removeMin(){if(this.left.isEmpty())return LLRBNode.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,r){let i,o=this;if(0>r(e,o.key))o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,r),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),0===r(e,o.key)){if(o.right.isEmpty())return LLRBNode.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,r))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw fail(43730,{key:this.key,value:this.value});if(this.right.isRed())throw fail(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw fail(27949);return e+(this.isRed()?0:1)}};LLRBNode.EMPTY=null,LLRBNode.RED=!0,LLRBNode.BLACK=!1,LLRBNode.EMPTY=new class{constructor(){this.size=0}get key(){throw fail(57766)}get value(){throw fail(16141)}get color(){throw fail(16727)}get left(){throw fail(29726)}get right(){throw fail(36894)}copy(e,r,i,o,s){return this}insert(e,r,i){return new LLRBNode(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SortedSet=class SortedSet{constructor(e){this.comparator=e,this.data=new SortedMap(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,i)=>(e(r),!1))}forEachInRange(e,r){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;r(o.key)}}forEachWhile(e,r){let i;for(i=void 0!==r?this.data.getIteratorFrom(r):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new SortedSetIterator(this.data.getIterator())}getIteratorFrom(e){return new SortedSetIterator(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(e=>{r=r.add(e)}),r}isEqual(e){if(!(e instanceof SortedSet)||this.size!==e.size)return!1;let r=this.data.getIterator(),i=e.data.getIterator();for(;r.hasNext();){let e=r.getNext().key,o=i.getNext().key;if(0!==this.comparator(e,o))return!1}return!0}toArray(){let e=[];return this.forEach(r=>{e.push(r)}),e}toString(){let e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){let r=new SortedSet(this.comparator);return r.data=e,r}};let SortedSetIterator=class SortedSetIterator{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FieldMask=class FieldMask{constructor(e){this.fields=e,e.sort(FieldPath$1.comparator)}static empty(){return new FieldMask([])}unionWith(e){let r=new SortedSet(FieldPath$1.comparator);for(let e of this.fields)r=r.add(e);for(let i of e)r=r.add(i);return new FieldMask(r.toArray())}covers(e){for(let r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return __PRIVATE_arrayEquals(this.fields,e.fields,(e,r)=>e.isEqual(r))}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_Base64DecodeError=class __PRIVATE_Base64DecodeError extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ByteString=class ByteString{constructor(e){this.binaryString=e}static fromBase64String(e){let r=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new __PRIVATE_Base64DecodeError("Invalid base64 string: "+e):e}}(e);return new ByteString(r)}static fromUint8Array(e){let r=function(e){let r="";for(let i=0;i<e.length;++i)r+=String.fromCharCode(e[i]);return r}(e);return new ByteString(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){let r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return __PRIVATE_primitiveComparator(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ByteString.EMPTY_BYTE_STRING=new ByteString("");let e_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function __PRIVATE_normalizeTimestamp(e){if(__PRIVATE_hardAssert(!!e,39018),"string"==typeof e){let r=0,i=e_.exec(e);if(__PRIVATE_hardAssert(!!i,46558,{timestamp:e}),i[1]){let e=i[1];r=Number(e=(e+"000000000").substr(0,9))}let o=new Date(e);return{seconds:Math.floor(o.getTime()/1e3),nanos:r}}return{seconds:__PRIVATE_normalizeNumber(e.seconds),nanos:__PRIVATE_normalizeNumber(e.nanos)}}function __PRIVATE_normalizeNumber(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function __PRIVATE_normalizeByteString(e){return"string"==typeof e?ByteString.fromBase64String(e):ByteString.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eg="server_timestamp",ey="__type__",eE="__previous_value__",eI="__local_write_time__";function __PRIVATE_isServerTimestamp(e){let r=(e?.mapValue?.fields||{})[ey]?.stringValue;return r===eg}function __PRIVATE_getPreviousValue(e){let r=e.mapValue.fields[eE];return __PRIVATE_isServerTimestamp(r)?__PRIVATE_getPreviousValue(r):r}function __PRIVATE_getLocalWriteTime(e){let r=__PRIVATE_normalizeTimestamp(e.mapValue.fields[eI].timestampValue);return new Timestamp(r.seconds,r.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DatabaseInfo=class DatabaseInfo{constructor(e,r,i,o,s,l,h,d,f,_){this.databaseId=e,this.appId=r,this.persistenceKey=i,this.host=o,this.ssl=s,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=f,this.isUsingEmulator=_}};let eT="(default)";let DatabaseId=class DatabaseId{constructor(e,r){this.projectId=e,this.database=r||eT}static empty(){return new DatabaseId("","")}get isDefaultDatabase(){return this.database===eT}isEqual(e){return e instanceof DatabaseId&&e.projectId===this.projectId&&e.database===this.database}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ev="__type__",eA="__max__",eP={mapValue:{fields:{__type__:{stringValue:eA}}}},eR="__vector__",ew="value";function __PRIVATE_typeOrder(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?__PRIVATE_isServerTimestamp(e)?4:__PRIVATE_isMaxValue(e)?9007199254740991:__PRIVATE_isVectorValue(e)?10:11:fail(28295,{value:e})}function __PRIVATE_valueEquals(e,r){if(e===r)return!0;let i=__PRIVATE_typeOrder(e);if(i!==__PRIVATE_typeOrder(r))return!1;switch(i){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===r.booleanValue;case 4:return __PRIVATE_getLocalWriteTime(e).isEqual(__PRIVATE_getLocalWriteTime(r));case 3:return function(e,r){if("string"==typeof e.timestampValue&&"string"==typeof r.timestampValue&&e.timestampValue.length===r.timestampValue.length)return e.timestampValue===r.timestampValue;let i=__PRIVATE_normalizeTimestamp(e.timestampValue),o=__PRIVATE_normalizeTimestamp(r.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(e,r);case 5:return e.stringValue===r.stringValue;case 6:return __PRIVATE_normalizeByteString(e.bytesValue).isEqual(__PRIVATE_normalizeByteString(r.bytesValue));case 7:return e.referenceValue===r.referenceValue;case 8:return __PRIVATE_normalizeNumber(e.geoPointValue.latitude)===__PRIVATE_normalizeNumber(r.geoPointValue.latitude)&&__PRIVATE_normalizeNumber(e.geoPointValue.longitude)===__PRIVATE_normalizeNumber(r.geoPointValue.longitude);case 2:return function(e,r){if("integerValue"in e&&"integerValue"in r)return __PRIVATE_normalizeNumber(e.integerValue)===__PRIVATE_normalizeNumber(r.integerValue);if("doubleValue"in e&&"doubleValue"in r){let i=__PRIVATE_normalizeNumber(e.doubleValue),o=__PRIVATE_normalizeNumber(r.doubleValue);return i===o?__PRIVATE_isNegativeZero(i)===__PRIVATE_isNegativeZero(o):isNaN(i)&&isNaN(o)}return!1}(e,r);case 9:return __PRIVATE_arrayEquals(e.arrayValue.values||[],r.arrayValue.values||[],__PRIVATE_valueEquals);case 10:case 11:return function(e,r){let i=e.mapValue.fields||{},o=r.mapValue.fields||{};if(__PRIVATE_objectSize(i)!==__PRIVATE_objectSize(o))return!1;for(let e in i)if(i.hasOwnProperty(e)&&(void 0===o[e]||!__PRIVATE_valueEquals(i[e],o[e])))return!1;return!0}(e,r);default:return fail(52216,{left:e})}}function __PRIVATE_arrayValueContains(e,r){return void 0!==(e.values||[]).find(e=>__PRIVATE_valueEquals(e,r))}function __PRIVATE_valueCompare(e,r){if(e===r)return 0;let i=__PRIVATE_typeOrder(e),o=__PRIVATE_typeOrder(r);if(i!==o)return __PRIVATE_primitiveComparator(i,o);switch(i){case 0:case 9007199254740991:return 0;case 1:return __PRIVATE_primitiveComparator(e.booleanValue,r.booleanValue);case 2:return function(e,r){let i=__PRIVATE_normalizeNumber(e.integerValue||e.doubleValue),o=__PRIVATE_normalizeNumber(r.integerValue||r.doubleValue);return i<o?-1:i>o?1:i===o?0:isNaN(i)?isNaN(o)?0:-1:1}(e,r);case 3:return __PRIVATE_compareTimestamps(e.timestampValue,r.timestampValue);case 4:return __PRIVATE_compareTimestamps(__PRIVATE_getLocalWriteTime(e),__PRIVATE_getLocalWriteTime(r));case 5:return __PRIVATE_compareUtf8Strings(e.stringValue,r.stringValue);case 6:return function(e,r){let i=__PRIVATE_normalizeByteString(e),o=__PRIVATE_normalizeByteString(r);return i.compareTo(o)}(e.bytesValue,r.bytesValue);case 7:return function(e,r){let i=e.split("/"),o=r.split("/");for(let e=0;e<i.length&&e<o.length;e++){let r=__PRIVATE_primitiveComparator(i[e],o[e]);if(0!==r)return r}return __PRIVATE_primitiveComparator(i.length,o.length)}(e.referenceValue,r.referenceValue);case 8:return function(e,r){let i=__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(e.latitude),__PRIVATE_normalizeNumber(r.latitude));return 0!==i?i:__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(e.longitude),__PRIVATE_normalizeNumber(r.longitude))}(e.geoPointValue,r.geoPointValue);case 9:return __PRIVATE_compareArrays(e.arrayValue,r.arrayValue);case 10:return function(e,r){let i=e.fields||{},o=r.fields||{},s=i[ew]?.arrayValue,l=o[ew]?.arrayValue,h=__PRIVATE_primitiveComparator(s?.values?.length||0,l?.values?.length||0);return 0!==h?h:__PRIVATE_compareArrays(s,l)}(e.mapValue,r.mapValue);case 11:return function(e,r){if(e===eP.mapValue&&r===eP.mapValue)return 0;if(e===eP.mapValue)return 1;if(r===eP.mapValue)return -1;let i=e.fields||{},o=Object.keys(i),s=r.fields||{},l=Object.keys(s);o.sort(),l.sort();for(let e=0;e<o.length&&e<l.length;++e){let r=__PRIVATE_compareUtf8Strings(o[e],l[e]);if(0!==r)return r;let h=__PRIVATE_valueCompare(i[o[e]],s[l[e]]);if(0!==h)return h}return __PRIVATE_primitiveComparator(o.length,l.length)}(e.mapValue,r.mapValue);default:throw fail(23264,{he:i})}}function __PRIVATE_compareTimestamps(e,r){if("string"==typeof e&&"string"==typeof r&&e.length===r.length)return __PRIVATE_primitiveComparator(e,r);let i=__PRIVATE_normalizeTimestamp(e),o=__PRIVATE_normalizeTimestamp(r),s=__PRIVATE_primitiveComparator(i.seconds,o.seconds);return 0!==s?s:__PRIVATE_primitiveComparator(i.nanos,o.nanos)}function __PRIVATE_compareArrays(e,r){let i=e.values||[],o=r.values||[];for(let e=0;e<i.length&&e<o.length;++e){let r=__PRIVATE_valueCompare(i[e],o[e]);if(r)return r}return __PRIVATE_primitiveComparator(i.length,o.length)}function __PRIVATE_canonifyValue(e){var r,i;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){let r=__PRIVATE_normalizeTimestamp(e);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?__PRIVATE_normalizeByteString(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,DocumentKey.fromName(r).toString()):"geoPointValue"in e?(i=e.geoPointValue,`geo(${i.latitude},${i.longitude})`):"arrayValue"in e?function(e){let r="[",i=!0;for(let o of e.values||[])i?i=!1:r+=",",r+=__PRIVATE_canonifyValue(o);return r+"]"}(e.arrayValue):"mapValue"in e?function(e){let r=Object.keys(e.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${__PRIVATE_canonifyValue(e.fields[s])}`;return i+"}"}(e.mapValue):fail(61005,{value:e})}function __PRIVATE_estimateByteSize(e){switch(__PRIVATE_typeOrder(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let r=__PRIVATE_getPreviousValue(e);return r?16+__PRIVATE_estimateByteSize(r):16;case 5:return 2*e.stringValue.length;case 6:return __PRIVATE_normalizeByteString(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return(e.arrayValue.values||[]).reduce((e,r)=>e+__PRIVATE_estimateByteSize(r),0);case 10:case 11:var i;let o;return i=e.mapValue,o=0,forEach(i.fields,(e,r)=>{o+=e.length+__PRIVATE_estimateByteSize(r)}),o;default:throw fail(13486,{value:e})}}function isInteger(e){return!!e&&"integerValue"in e}function isArray(e){return!!e&&"arrayValue"in e}function __PRIVATE_isNullValue(e){return!!e&&"nullValue"in e}function __PRIVATE_isNanValue(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function __PRIVATE_isMapValue(e){return!!e&&"mapValue"in e}function __PRIVATE_isVectorValue(e){let r=(e?.mapValue?.fields||{})[ev]?.stringValue;return r===eR}function __PRIVATE_deepClone(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let r={mapValue:{fields:{}}};return forEach(e.mapValue.fields,(e,i)=>r.mapValue.fields[e]=__PRIVATE_deepClone(i)),r}if(e.arrayValue){let r={arrayValue:{values:[]}};for(let i=0;i<(e.arrayValue.values||[]).length;++i)r.arrayValue.values[i]=__PRIVATE_deepClone(e.arrayValue.values[i]);return r}return{...e}}function __PRIVATE_isMaxValue(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===eA}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ObjectValue=class ObjectValue{constructor(e){this.value=e}static empty(){return new ObjectValue({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let i=0;i<e.length-1;++i)if(!__PRIVATE_isMapValue(r=(r.mapValue.fields||{})[e.get(i)]))return null;return(r=(r.mapValue.fields||{})[e.lastSegment()])||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=__PRIVATE_deepClone(r)}setAll(e){let r=FieldPath$1.emptyPath(),i={},o=[];e.forEach((e,s)=>{if(!r.isImmediateParentOf(s)){let e=this.getFieldsMap(r);this.applyChanges(e,i,o),i={},o=[],r=s.popLast()}e?i[s.lastSegment()]=__PRIVATE_deepClone(e):o.push(s.lastSegment())});let s=this.getFieldsMap(r);this.applyChanges(s,i,o)}delete(e){let r=this.field(e.popLast());__PRIVATE_isMapValue(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return __PRIVATE_valueEquals(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=r.mapValue.fields[e.get(i)];__PRIVATE_isMapValue(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},r.mapValue.fields[e.get(i)]=o),r=o}return r.mapValue.fields}applyChanges(e,r,i){for(let o of(forEach(r,(r,i)=>e[r]=i),i))delete e[o]}clone(){return new ObjectValue(__PRIVATE_deepClone(this.value))}};function __PRIVATE_extractFieldMask(e){let r=[];return forEach(e.fields,(e,i)=>{let o=new FieldPath$1([e]);if(__PRIVATE_isMapValue(i)){let e=__PRIVATE_extractFieldMask(i.mapValue).fields;if(0===e.length)r.push(o);else for(let i of e)r.push(o.child(i))}else r.push(o)}),new FieldMask(r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MutableDocument=class MutableDocument{constructor(e,r,i,o,s,l,h){this.key=e,this.documentType=r,this.version=i,this.readTime=o,this.createTime=s,this.data=l,this.documentState=h}static newInvalidDocument(e){return new MutableDocument(e,0,SnapshotVersion.min(),SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newFoundDocument(e,r,i,o){return new MutableDocument(e,1,r,SnapshotVersion.min(),i,o,0)}static newNoDocument(e,r){return new MutableDocument(e,2,r,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newUnknownDocument(e,r){return new MutableDocument(e,3,r,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),2)}convertToFoundDocument(e,r){return this.createTime.isEqual(SnapshotVersion.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ObjectValue.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ObjectValue.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=SnapshotVersion.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof MutableDocument&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new MutableDocument(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bound=class Bound{constructor(e,r){this.position=e,this.inclusive=r}};function __PRIVATE_boundCompareToDocument(e,r,i){let o=0;for(let s=0;s<e.position.length;s++){let l=r[s],h=e.position[s];if(o=l.field.isKeyField()?DocumentKey.comparator(DocumentKey.fromName(h.referenceValue),i.key):__PRIVATE_valueCompare(h,i.data.field(l.field)),"desc"===l.dir&&(o*=-1),0!==o)break}return o}function __PRIVATE_boundEquals(e,r){if(null===e)return null===r;if(null===r||e.inclusive!==r.inclusive||e.position.length!==r.position.length)return!1;for(let i=0;i<e.position.length;i++)if(!__PRIVATE_valueEquals(e.position[i],r.position[i]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OrderBy=class OrderBy{constructor(e,r="asc"){this.field=e,this.dir=r}};function __PRIVATE_orderByEquals(e,r){return e.dir===r.dir&&e.field.isEqual(r.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Filter=class Filter{};let FieldFilter=class FieldFilter extends Filter{constructor(e,r,i){super(),this.field=e,this.op=r,this.value=i}static create(e,r,i){return e.isKeyField()?"in"===r||"not-in"===r?this.createKeyFieldInFilter(e,r,i):new __PRIVATE_KeyFieldFilter(e,r,i):"array-contains"===r?new __PRIVATE_ArrayContainsFilter(e,i):"in"===r?new __PRIVATE_InFilter(e,i):"not-in"===r?new __PRIVATE_NotInFilter(e,i):"array-contains-any"===r?new __PRIVATE_ArrayContainsAnyFilter(e,i):new FieldFilter(e,r,i)}static createKeyFieldInFilter(e,r,i){return"in"===r?new __PRIVATE_KeyFieldInFilter(e,i):new __PRIVATE_KeyFieldNotInFilter(e,i)}matches(e){let r=e.data.field(this.field);return"!="===this.op?null!==r&&void 0===r.nullValue&&this.matchesComparison(__PRIVATE_valueCompare(r,this.value)):null!==r&&__PRIVATE_typeOrder(this.value)===__PRIVATE_typeOrder(r)&&this.matchesComparison(__PRIVATE_valueCompare(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return fail(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}};let CompositeFilter=class CompositeFilter extends Filter{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new CompositeFilter(e,r)}matches(e){return __PRIVATE_compositeFilterIsConjunction(this)?void 0===this.filters.find(r=>!r.matches(e)):void 0!==this.filters.find(r=>r.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function __PRIVATE_compositeFilterIsConjunction(e){return"and"===e.op}function __PRIVATE_compositeFilterIsFlat(e){for(let r of e.filters)if(r instanceof CompositeFilter)return!1;return!0}function __PRIVATE_canonifyFilter(e){if(e instanceof FieldFilter)return e.field.canonicalString()+e.op.toString()+__PRIVATE_canonifyValue(e.value);if(__PRIVATE_compositeFilterIsFlat(e)&&__PRIVATE_compositeFilterIsConjunction(e))return e.filters.map(e=>__PRIVATE_canonifyFilter(e)).join(",");{let r=e.filters.map(e=>__PRIVATE_canonifyFilter(e)).join(",");return`${e.op}(${r})`}}function __PRIVATE_filterEquals(e,r){return e instanceof FieldFilter?r instanceof FieldFilter&&e.op===r.op&&e.field.isEqual(r.field)&&__PRIVATE_valueEquals(e.value,r.value):e instanceof CompositeFilter?r instanceof CompositeFilter&&e.op===r.op&&e.filters.length===r.filters.length&&e.filters.reduce((e,i,o)=>e&&__PRIVATE_filterEquals(i,r.filters[o]),!0):void fail(19439)}function __PRIVATE_stringifyFilter(e){return e instanceof FieldFilter?`${e.field.canonicalString()} ${e.op} ${__PRIVATE_canonifyValue(e.value)}`:e instanceof CompositeFilter?e.op.toString()+" {"+e.getFilters().map(__PRIVATE_stringifyFilter).join(" ,")+"}":"Filter"}let __PRIVATE_KeyFieldFilter=class __PRIVATE_KeyFieldFilter extends FieldFilter{constructor(e,r,i){super(e,r,i),this.key=DocumentKey.fromName(i.referenceValue)}matches(e){let r=DocumentKey.comparator(e.key,this.key);return this.matchesComparison(r)}};let __PRIVATE_KeyFieldInFilter=class __PRIVATE_KeyFieldInFilter extends FieldFilter{constructor(e,r){super(e,"in",r),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}};let __PRIVATE_KeyFieldNotInFilter=class __PRIVATE_KeyFieldNotInFilter extends FieldFilter{constructor(e,r){super(e,"not-in",r),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}};function __PRIVATE_extractDocumentKeysFromArrayValue(e,r){return(r.arrayValue?.values||[]).map(e=>DocumentKey.fromName(e.referenceValue))}let __PRIVATE_ArrayContainsFilter=class __PRIVATE_ArrayContainsFilter extends FieldFilter{constructor(e,r){super(e,"array-contains",r)}matches(e){let r=e.data.field(this.field);return isArray(r)&&__PRIVATE_arrayValueContains(r.arrayValue,this.value)}};let __PRIVATE_InFilter=class __PRIVATE_InFilter extends FieldFilter{constructor(e,r){super(e,"in",r)}matches(e){let r=e.data.field(this.field);return null!==r&&__PRIVATE_arrayValueContains(this.value.arrayValue,r)}};let __PRIVATE_NotInFilter=class __PRIVATE_NotInFilter extends FieldFilter{constructor(e,r){super(e,"not-in",r)}matches(e){if(__PRIVATE_arrayValueContains(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let r=e.data.field(this.field);return null!==r&&void 0===r.nullValue&&!__PRIVATE_arrayValueContains(this.value.arrayValue,r)}};let __PRIVATE_ArrayContainsAnyFilter=class __PRIVATE_ArrayContainsAnyFilter extends FieldFilter{constructor(e,r){super(e,"array-contains-any",r)}matches(e){let r=e.data.field(this.field);return!(!isArray(r)||!r.arrayValue.values)&&r.arrayValue.values.some(e=>__PRIVATE_arrayValueContains(this.value.arrayValue,e))}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_TargetImpl=class __PRIVATE_TargetImpl{constructor(e,r=null,i=[],o=[],s=null,l=null,h=null){this.path=e,this.collectionGroup=r,this.orderBy=i,this.filters=o,this.limit=s,this.startAt=l,this.endAt=h,this.Te=null}};function __PRIVATE_newTarget(e,r=null,i=[],o=[],s=null,l=null,h=null){return new __PRIVATE_TargetImpl(e,r,i,o,s,l,h)}function __PRIVATE_canonifyTarget(e){if(null===e.Te){let r=e.path.canonicalString();null!==e.collectionGroup&&(r+="|cg:"+e.collectionGroup),r+="|f:"+e.filters.map(e=>__PRIVATE_canonifyFilter(e)).join(",")+"|ob:"+e.orderBy.map(e=>e.field.canonicalString()+e.dir).join(","),null==e.limit||(r+="|l:"+e.limit),e.startAt&&(r+="|lb:"+(e.startAt.inclusive?"b:":"a:")+e.startAt.position.map(e=>__PRIVATE_canonifyValue(e)).join(",")),e.endAt&&(r+="|ub:"+(e.endAt.inclusive?"a:":"b:")+e.endAt.position.map(e=>__PRIVATE_canonifyValue(e)).join(",")),e.Te=r}return e.Te}function __PRIVATE_targetEquals(e,r){if(e.limit!==r.limit||e.orderBy.length!==r.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++)if(!__PRIVATE_orderByEquals(e.orderBy[i],r.orderBy[i]))return!1;if(e.filters.length!==r.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if(!__PRIVATE_filterEquals(e.filters[i],r.filters[i]))return!1;return e.collectionGroup===r.collectionGroup&&!!e.path.isEqual(r.path)&&!!__PRIVATE_boundEquals(e.startAt,r.startAt)&&__PRIVATE_boundEquals(e.endAt,r.endAt)}function __PRIVATE_targetIsDocumentTarget(e){return DocumentKey.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_QueryImpl=class __PRIVATE_QueryImpl{constructor(e,r=null,i=[],o=[],s=null,l="F",h=null,d=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=i,this.filters=o,this.limit=s,this.limitType=l,this.startAt=h,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function __PRIVATE_newQuery(e,r,i,o,s,l,h,d){return new __PRIVATE_QueryImpl(e,r,i,o,s,l,h,d)}function __PRIVATE_queryMatchesAllDocuments(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function __PRIVATE_isCollectionGroupQuery(e){return null!==e.collectionGroup}function __PRIVATE_queryNormalizedOrderBy(e){if(null===e.Ie){let r;e.Ie=[];let i=new Set;for(let r of e.explicitOrderBy)e.Ie.push(r),i.add(r.field.canonicalString());let o=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",s=(r=new SortedSet(FieldPath$1.comparator),e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(r=r.add(e.field))})}),r);s.forEach(r=>{i.has(r.canonicalString())||r.isKeyField()||e.Ie.push(new OrderBy(r,o))}),i.has(FieldPath$1.keyField().canonicalString())||e.Ie.push(new OrderBy(FieldPath$1.keyField(),o))}return e.Ie}function __PRIVATE_queryToTarget(e){return e.Ee||(e.Ee=__PRIVATE__queryToTarget(e,__PRIVATE_queryNormalizedOrderBy(e))),e.Ee}function __PRIVATE__queryToTarget(e,r){if("F"===e.limitType)return __PRIVATE_newTarget(e.path,e.collectionGroup,r,e.filters,e.limit,e.startAt,e.endAt);{r=r.map(e=>{let r="desc"===e.dir?"asc":"desc";return new OrderBy(e.field,r)});let i=e.endAt?new Bound(e.endAt.position,e.endAt.inclusive):null,o=e.startAt?new Bound(e.startAt.position,e.startAt.inclusive):null;return __PRIVATE_newTarget(e.path,e.collectionGroup,r,e.filters,e.limit,i,o)}}function __PRIVATE_queryWithLimit(e,r,i){return new __PRIVATE_QueryImpl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),r,i,e.startAt,e.endAt)}function __PRIVATE_queryEquals(e,r){return __PRIVATE_targetEquals(__PRIVATE_queryToTarget(e),__PRIVATE_queryToTarget(r))&&e.limitType===r.limitType}function __PRIVATE_canonifyQuery(e){return`${__PRIVATE_canonifyTarget(__PRIVATE_queryToTarget(e))}|lt:${e.limitType}`}function __PRIVATE_stringifyQuery(e){var r;let i;return`Query(target=${i=(r=__PRIVATE_queryToTarget(e)).path.canonicalString(),null!==r.collectionGroup&&(i+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(i+=`, filters: [${r.filters.map(e=>__PRIVATE_stringifyFilter(e)).join(", ")}]`),null==r.limit||(i+=", limit: "+r.limit),r.orderBy.length>0&&(i+=`, orderBy: [${r.orderBy.map(e=>`${e.field.canonicalString()} (${e.dir})`).join(", ")}]`),r.startAt&&(i+=", startAt: "+(r.startAt.inclusive?"b:":"a:")+r.startAt.position.map(e=>__PRIVATE_canonifyValue(e)).join(",")),r.endAt&&(i+=", endAt: "+(r.endAt.inclusive?"a:":"b:")+r.endAt.position.map(e=>__PRIVATE_canonifyValue(e)).join(",")),`Target(${i})`}; limitType=${e.limitType})`}function __PRIVATE_queryMatches(e,r){return r.isFoundDocument()&&function(e,r){let i=r.key.path;return null!==e.collectionGroup?r.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(i):DocumentKey.isDocumentKey(e.path)?e.path.isEqual(i):e.path.isImmediateParentOf(i)}(e,r)&&function(e,r){for(let i of __PRIVATE_queryNormalizedOrderBy(e))if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(e,r)&&function(e,r){for(let i of e.filters)if(!i.matches(r))return!1;return!0}(e,r)&&(!e.startAt||!!function(e,r,i){let o=__PRIVATE_boundCompareToDocument(e,r,i);return e.inclusive?o<=0:o<0}(e.startAt,__PRIVATE_queryNormalizedOrderBy(e),r))&&(!e.endAt||!!function(e,r,i){let o=__PRIVATE_boundCompareToDocument(e,r,i);return e.inclusive?o>=0:o>0}(e.endAt,__PRIVATE_queryNormalizedOrderBy(e),r))}function __PRIVATE_queryCollectionGroup(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function __PRIVATE_newQueryComparator(e){return(r,i)=>{let o=!1;for(let s of __PRIVATE_queryNormalizedOrderBy(e)){let e=__PRIVATE_compareDocs(s,r,i);if(0!==e)return e;o=o||s.field.isKeyField()}return 0}}function __PRIVATE_compareDocs(e,r,i){let o=e.field.isKeyField()?DocumentKey.comparator(r.key,i.key):function(e,r,i){let o=r.data.field(e),s=i.data.field(e);return null!==o&&null!==s?__PRIVATE_valueCompare(o,s):fail(42886)}(e.field,r,i);switch(e.dir){case"asc":return o;case"desc":return -1*o;default:return fail(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ObjectMap=class ObjectMap{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){let r=this.mapKeyFn(e),i=this.inner[r];if(void 0!==i){for(let[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return void 0!==this.get(e)}set(e,r){let i=this.mapKeyFn(e),o=this.inner[i];if(void 0===o)return this.inner[i]=[[e,r]],void this.innerSize++;for(let i=0;i<o.length;i++)if(this.equalsFn(o[i][0],e))return void(o[i]=[e,r]);o.push([e,r]),this.innerSize++}delete(e){let r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return 1===i.length?delete this.inner[r]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){forEach(this.inner,(r,i)=>{for(let[r,o]of i)e(r,o)})}isEmpty(){return isEmpty(this.inner)}size(){return this.innerSize}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eS=new SortedMap(DocumentKey.comparator),ek=new SortedMap(DocumentKey.comparator);function documentMap(...e){let r=ek;for(let i of e)r=r.insert(i.key,i);return r}function __PRIVATE_convertOverlayedDocumentMapToDocumentMap(e){let r=ek;return e.forEach((e,i)=>r=r.insert(e,i.overlayedDocument)),r}function __PRIVATE_newDocumentKeyMap(){return new ObjectMap(e=>e.toString(),(e,r)=>e.isEqual(r))}let eV=new SortedMap(DocumentKey.comparator),eC=new SortedSet(DocumentKey.comparator);function __PRIVATE_documentKeySet(...e){let r=eC;for(let i of e)r=r.add(i);return r}let ex=new SortedSet(__PRIVATE_primitiveComparator);function __PRIVATE_targetIdSet(){return ex}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_toDouble(e,r){if(e.useProto3Json){if(isNaN(r))return{doubleValue:"NaN"};if(r===1/0)return{doubleValue:"Infinity"};if(r===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:__PRIVATE_isNegativeZero(r)?"-0":r}}function __PRIVATE_toInteger(e){return{integerValue:""+e}}function toNumber(e,r){return isSafeInteger(r)?__PRIVATE_toInteger(r):__PRIVATE_toDouble(e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TransformOperation=class TransformOperation{constructor(){this._=void 0}};function __PRIVATE_applyTransformOperationToLocalView(e,r,i){return e instanceof __PRIVATE_ServerTimestampTransform?function(e,r){let i={fields:{[ey]:{stringValue:eg},[eI]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return r&&__PRIVATE_isServerTimestamp(r)&&(r=__PRIVATE_getPreviousValue(r)),r&&(i.fields[eE]=r),{mapValue:i}}(i,r):e instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(e,r):e instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(e,r):function(e,r){let i=__PRIVATE_computeTransformOperationBaseValue(e,r),o=asNumber(i)+asNumber(e.Ae);return isInteger(i)&&isInteger(e.Ae)?__PRIVATE_toInteger(o):__PRIVATE_toDouble(e.serializer,o)}(e,r)}function __PRIVATE_applyTransformOperationToRemoteDocument(e,r,i){return e instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(e,r):e instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(e,r):i}function __PRIVATE_computeTransformOperationBaseValue(e,r){return e instanceof __PRIVATE_NumericIncrementTransformOperation?isInteger(r)||r&&"doubleValue"in r?r:{integerValue:0}:null}let __PRIVATE_ServerTimestampTransform=class __PRIVATE_ServerTimestampTransform extends TransformOperation{};let __PRIVATE_ArrayUnionTransformOperation=class __PRIVATE_ArrayUnionTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}};function __PRIVATE_applyArrayUnionTransformOperation(e,r){let i=__PRIVATE_coercedFieldValuesArray(r);for(let r of e.elements)i.some(e=>__PRIVATE_valueEquals(e,r))||i.push(r);return{arrayValue:{values:i}}}let __PRIVATE_ArrayRemoveTransformOperation=class __PRIVATE_ArrayRemoveTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}};function __PRIVATE_applyArrayRemoveTransformOperation(e,r){let i=__PRIVATE_coercedFieldValuesArray(r);for(let r of e.elements)i=i.filter(e=>!__PRIVATE_valueEquals(e,r));return{arrayValue:{values:i}}}let __PRIVATE_NumericIncrementTransformOperation=class __PRIVATE_NumericIncrementTransformOperation extends TransformOperation{constructor(e,r){super(),this.serializer=e,this.Ae=r}};function asNumber(e){return __PRIVATE_normalizeNumber(e.integerValue||e.doubleValue)}function __PRIVATE_coercedFieldValuesArray(e){return isArray(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FieldTransform=class FieldTransform{constructor(e,r){this.field=e,this.transform=r}};function __PRIVATE_fieldTransformEquals(e,r){var i,o;return e.field.isEqual(r.field)&&(i=e.transform,o=r.transform,i instanceof __PRIVATE_ArrayUnionTransformOperation&&o instanceof __PRIVATE_ArrayUnionTransformOperation||i instanceof __PRIVATE_ArrayRemoveTransformOperation&&o instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_arrayEquals(i.elements,o.elements,__PRIVATE_valueEquals):i instanceof __PRIVATE_NumericIncrementTransformOperation&&o instanceof __PRIVATE_NumericIncrementTransformOperation?__PRIVATE_valueEquals(i.Ae,o.Ae):i instanceof __PRIVATE_ServerTimestampTransform&&o instanceof __PRIVATE_ServerTimestampTransform)}let MutationResult=class MutationResult{constructor(e,r){this.version=e,this.transformResults=r}};let Precondition=class Precondition{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Precondition}static exists(e){return new Precondition(void 0,e)}static updateTime(e){return new Precondition(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function __PRIVATE_preconditionIsValidForDocument(e,r){return void 0!==e.updateTime?r.isFoundDocument()&&r.version.isEqual(e.updateTime):void 0===e.exists||e.exists===r.isFoundDocument()}let Mutation=class Mutation{};function __PRIVATE_calculateOverlayMutation(e,r){if(!e.hasLocalMutations||r&&0===r.fields.length)return null;if(null===r)return e.isNoDocument()?new __PRIVATE_DeleteMutation(e.key,Precondition.none()):new __PRIVATE_SetMutation(e.key,e.data,Precondition.none());{let i=e.data,o=ObjectValue.empty(),s=new SortedSet(FieldPath$1.comparator);for(let e of r.fields)if(!s.has(e)){let r=i.field(e);null===r&&e.length>1&&(e=e.popLast(),r=i.field(e)),null===r?o.delete(e):o.set(e,r),s=s.add(e)}return new __PRIVATE_PatchMutation(e.key,o,new FieldMask(s.toArray()),Precondition.none())}}function __PRIVATE_mutationApplyToRemoteDocument(e,r,i){e instanceof __PRIVATE_SetMutation?function(e,r,i){let o=e.value.clone(),s=__PRIVATE_serverTransformResults(e.fieldTransforms,r,i.transformResults);o.setAll(s),r.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(e,r,i):e instanceof __PRIVATE_PatchMutation?function(e,r,i){if(!__PRIVATE_preconditionIsValidForDocument(e.precondition,r))return void r.convertToUnknownDocument(i.version);let o=__PRIVATE_serverTransformResults(e.fieldTransforms,r,i.transformResults),s=r.data;s.setAll(__PRIVATE_getPatch(e)),s.setAll(o),r.convertToFoundDocument(i.version,s).setHasCommittedMutations()}(e,r,i):function(e,r,i){r.convertToNoDocument(i.version).setHasCommittedMutations()}(0,r,i)}function __PRIVATE_mutationApplyToLocalView(e,r,i,o){return e instanceof __PRIVATE_SetMutation?function(e,r,i,o){if(!__PRIVATE_preconditionIsValidForDocument(e.precondition,r))return i;let s=e.value.clone(),l=__PRIVATE_localTransformResults(e.fieldTransforms,o,r);return s.setAll(l),r.convertToFoundDocument(r.version,s).setHasLocalMutations(),null}(e,r,i,o):e instanceof __PRIVATE_PatchMutation?function(e,r,i,o){if(!__PRIVATE_preconditionIsValidForDocument(e.precondition,r))return i;let s=__PRIVATE_localTransformResults(e.fieldTransforms,o,r),l=r.data;return(l.setAll(__PRIVATE_getPatch(e)),l.setAll(s),r.convertToFoundDocument(r.version,l).setHasLocalMutations(),null===i)?null:i.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,r,i,o):__PRIVATE_preconditionIsValidForDocument(e.precondition,r)?(r.convertToNoDocument(r.version).setHasLocalMutations(),null):i}function __PRIVATE_mutationExtractBaseValue(e,r){let i=null;for(let o of e.fieldTransforms){let e=r.data.field(o.field),s=__PRIVATE_computeTransformOperationBaseValue(o.transform,e||null);null!=s&&(null===i&&(i=ObjectValue.empty()),i.set(o.field,s))}return i||null}function __PRIVATE_mutationEquals(e,r){var i,o;return e.type===r.type&&!!e.key.isEqual(r.key)&&!!e.precondition.isEqual(r.precondition)&&(i=e.fieldTransforms,o=r.fieldTransforms,!!(void 0===i&&void 0===o||!(!i||!o)&&__PRIVATE_arrayEquals(i,o,(e,r)=>__PRIVATE_fieldTransformEquals(e,r))))&&(0===e.type?e.value.isEqual(r.value):1!==e.type||e.data.isEqual(r.data)&&e.fieldMask.isEqual(r.fieldMask))}let __PRIVATE_SetMutation=class __PRIVATE_SetMutation extends Mutation{constructor(e,r,i,o=[]){super(),this.key=e,this.value=r,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}};let __PRIVATE_PatchMutation=class __PRIVATE_PatchMutation extends Mutation{constructor(e,r,i,o,s=[]){super(),this.key=e,this.data=r,this.fieldMask=i,this.precondition=o,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function __PRIVATE_getPatch(e){let r=new Map;return e.fieldMask.fields.forEach(i=>{if(!i.isEmpty()){let o=e.data.field(i);r.set(i,o)}}),r}function __PRIVATE_serverTransformResults(e,r,i){let o=new Map;__PRIVATE_hardAssert(e.length===i.length,32656,{Re:i.length,Ve:e.length});for(let s=0;s<i.length;s++){let l=e[s],h=l.transform,d=r.data.field(l.field);o.set(l.field,__PRIVATE_applyTransformOperationToRemoteDocument(h,d,i[s]))}return o}function __PRIVATE_localTransformResults(e,r,i){let o=new Map;for(let s of e){let e=s.transform,l=i.data.field(s.field);o.set(s.field,__PRIVATE_applyTransformOperationToLocalView(e,l,r))}return o}let __PRIVATE_DeleteMutation=class __PRIVATE_DeleteMutation extends Mutation{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};let __PRIVATE_VerifyMutation=class __PRIVATE_VerifyMutation extends Mutation{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MutationBatch=class MutationBatch{constructor(e,r,i,o){this.batchId=e,this.localWriteTime=r,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,r){let i=r.mutationResults;for(let r=0;r<this.mutations.length;r++){let o=this.mutations[r];o.key.isEqual(e.key)&&__PRIVATE_mutationApplyToRemoteDocument(o,e,i[r])}}applyToLocalView(e,r){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(r=__PRIVATE_mutationApplyToLocalView(i,e,r,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(r=__PRIVATE_mutationApplyToLocalView(i,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){let i=__PRIVATE_newDocumentKeyMap();return this.mutations.forEach(o=>{let s=e.get(o.key),l=s.overlayedDocument,h=this.applyToLocalView(l,s.mutatedFields);h=r.has(o.key)?null:h;let d=__PRIVATE_calculateOverlayMutation(l,h);null!==d&&i.set(o.key,d),l.isValidDocument()||l.convertToNoDocument(SnapshotVersion.min())}),i}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),__PRIVATE_documentKeySet())}isEqual(e){return this.batchId===e.batchId&&__PRIVATE_arrayEquals(this.mutations,e.mutations,(e,r)=>__PRIVATE_mutationEquals(e,r))&&__PRIVATE_arrayEquals(this.baseMutations,e.baseMutations,(e,r)=>__PRIVATE_mutationEquals(e,r))}};let MutationBatchResult=class MutationBatchResult{constructor(e,r,i,o){this.batch=e,this.commitVersion=r,this.mutationResults=i,this.docVersions=o}static from(e,r,i){__PRIVATE_hardAssert(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=eV,s=e.mutations;for(let e=0;e<s.length;e++)o=o.insert(s[e].key,i[e].version);return new MutationBatchResult(e,r,i,o)}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Overlay=class Overlay{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ExistenceFilter=class ExistenceFilter{constructor(e,r){this.count=e,this.unchangedNames=r}};function __PRIVATE_isPermanentError(e){switch(e){case ef.OK:return fail(64938);case ef.CANCELLED:case ef.UNKNOWN:case ef.DEADLINE_EXCEEDED:case ef.RESOURCE_EXHAUSTED:case ef.INTERNAL:case ef.UNAVAILABLE:case ef.UNAUTHENTICATED:return!1;case ef.INVALID_ARGUMENT:case ef.NOT_FOUND:case ef.ALREADY_EXISTS:case ef.PERMISSION_DENIED:case ef.FAILED_PRECONDITION:case ef.ABORTED:case ef.OUT_OF_RANGE:case ef.UNIMPLEMENTED:case ef.DATA_LOSS:return!0;default:return fail(15467,{code:e})}}function __PRIVATE_mapCodeFromRpcCode(e){if(void 0===e)return __PRIVATE_logError("GRPC error has no .code"),ef.UNKNOWN;switch(e){case k.OK:return ef.OK;case k.CANCELLED:return ef.CANCELLED;case k.UNKNOWN:return ef.UNKNOWN;case k.DEADLINE_EXCEEDED:return ef.DEADLINE_EXCEEDED;case k.RESOURCE_EXHAUSTED:return ef.RESOURCE_EXHAUSTED;case k.INTERNAL:return ef.INTERNAL;case k.UNAVAILABLE:return ef.UNAVAILABLE;case k.UNAUTHENTICATED:return ef.UNAUTHENTICATED;case k.INVALID_ARGUMENT:return ef.INVALID_ARGUMENT;case k.NOT_FOUND:return ef.NOT_FOUND;case k.ALREADY_EXISTS:return ef.ALREADY_EXISTS;case k.PERMISSION_DENIED:return ef.PERMISSION_DENIED;case k.FAILED_PRECONDITION:return ef.FAILED_PRECONDITION;case k.ABORTED:return ef.ABORTED;case k.OUT_OF_RANGE:return ef.OUT_OF_RANGE;case k.UNIMPLEMENTED:return ef.UNIMPLEMENTED;case k.DATA_LOSS:return ef.DATA_LOSS;default:return fail(39323,{code:e})}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newTextEncoder(){return new TextEncoder}(M=k||(k={}))[M.OK=0]="OK",M[M.CANCELLED=1]="CANCELLED",M[M.UNKNOWN=2]="UNKNOWN",M[M.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",M[M.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",M[M.NOT_FOUND=5]="NOT_FOUND",M[M.ALREADY_EXISTS=6]="ALREADY_EXISTS",M[M.PERMISSION_DENIED=7]="PERMISSION_DENIED",M[M.UNAUTHENTICATED=16]="UNAUTHENTICATED",M[M.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",M[M.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",M[M.ABORTED=10]="ABORTED",M[M.OUT_OF_RANGE=11]="OUT_OF_RANGE",M[M.UNIMPLEMENTED=12]="UNIMPLEMENTED",M[M.INTERNAL=13]="INTERNAL",M[M.UNAVAILABLE=14]="UNAVAILABLE",M[M.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eD=new o([4294967295,4294967295],0);function __PRIVATE_getMd5HashValue(e){let r=__PRIVATE_newTextEncoder().encode(e),i=new s;return i.update(r),new Uint8Array(i.digest())}function __PRIVATE_get64BitUints(e){let r=new DataView(e.buffer),i=r.getUint32(0,!0),s=r.getUint32(4,!0),l=r.getUint32(8,!0),h=r.getUint32(12,!0);return[new o([i,s],0),new o([l,h],0)]}let BloomFilter=class BloomFilter{constructor(e,r,i){if(this.bitmap=e,this.padding=r,this.hashCount=i,r<0||r>=8)throw new __PRIVATE_BloomFilterError(`Invalid padding: ${r}`);if(i<0||e.length>0&&0===this.hashCount)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${i}`);if(0===e.length&&0!==r)throw new __PRIVATE_BloomFilterError(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=o.fromNumber(this.ge)}ye(e,r,i){let s=e.add(r.multiply(o.fromNumber(i)));return 1===s.compare(eD)&&(s=new o([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;let r=__PRIVATE_getMd5HashValue(e),[i,o]=__PRIVATE_get64BitUints(r);for(let e=0;e<this.hashCount;e++){let r=this.ye(i,o,e);if(!this.we(r))return!1}return!0}static create(e,r,i){let o=new Uint8Array(Math.ceil(e/8)),s=new BloomFilter(o,e%8==0?0:8-e%8,r);return i.forEach(e=>s.insert(e)),s}insert(e){if(0===this.ge)return;let r=__PRIVATE_getMd5HashValue(e),[i,o]=__PRIVATE_get64BitUints(r);for(let e=0;e<this.hashCount;e++){let r=this.ye(i,o,e);this.Se(r)}}Se(e){this.bitmap[Math.floor(e/8)]|=1<<e%8}};let __PRIVATE_BloomFilterError=class __PRIVATE_BloomFilterError extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RemoteEvent=class RemoteEvent{constructor(e,r,i,o,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,i){let o=new Map;return o.set(e,TargetChange.createSynthesizedTargetChangeForCurrentChange(e,r,i)),new RemoteEvent(SnapshotVersion.min(),o,new SortedMap(__PRIVATE_primitiveComparator),eS,__PRIVATE_documentKeySet())}};let TargetChange=class TargetChange{constructor(e,r,i,o,s){this.resumeToken=e,this.current=r,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,i){return new TargetChange(i,r,__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet())}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_DocumentWatchChange=class __PRIVATE_DocumentWatchChange{constructor(e,r,i,o){this.be=e,this.removedTargetIds=r,this.key=i,this.De=o}};let __PRIVATE_ExistenceFilterChange=class __PRIVATE_ExistenceFilterChange{constructor(e,r){this.targetId=e,this.Ce=r}};let __PRIVATE_WatchTargetChange=class __PRIVATE_WatchTargetChange{constructor(e,r,i=ByteString.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=r,this.resumeToken=i,this.cause=o}};let __PRIVATE_TargetState=class __PRIVATE_TargetState{constructor(){this.ve=0,this.Fe=__PRIVATE_snapshotChangesMap(),this.Me=ByteString.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=__PRIVATE_documentKeySet(),r=__PRIVATE_documentKeySet(),i=__PRIVATE_documentKeySet();return this.Fe.forEach((o,s)=>{switch(s){case 0:e=e.add(o);break;case 2:r=r.add(o);break;case 1:i=i.add(o);break;default:fail(38017,{changeType:s})}}),new TargetChange(this.Me,this.xe,e,r,i)}qe(){this.Oe=!1,this.Fe=__PRIVATE_snapshotChangesMap()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,__PRIVATE_hardAssert(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}};let __PRIVATE_WatchChangeAggregator=class __PRIVATE_WatchChangeAggregator{constructor(e){this.Ge=e,this.ze=new Map,this.je=eS,this.Je=__PRIVATE_documentTargetMap(),this.He=__PRIVATE_documentTargetMap(),this.Ye=new SortedMap(__PRIVATE_primitiveComparator)}Ze(e){for(let r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(let r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{let i=this.nt(r);switch(e.state){case 0:this.rt(r)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),i.Le(e.resumeToken));break;default:fail(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((e,i)=>{this.rt(i)&&r(i)})}st(e){let r=e.targetId,i=e.Ce.count,o=this.ot(r);if(o){let s=o.target;if(__PRIVATE_targetIsDocumentTarget(s)){if(0===i){let e=new DocumentKey(s.path);this.et(r,e,MutableDocument.newNoDocument(e,SnapshotVersion.min()))}else __PRIVATE_hardAssert(1===i,20013,{expectedCount:i})}else{let o=this._t(r);if(o!==i){let i=this.ut(e),s=i?this.ct(i,e,o):1;0!==s&&(this.it(r),this.Ye=this.Ye.insert(r,2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}ut(e){let r,i;let o=e.Ce.unchangedNames;if(!o||!o.bits)return null;let{bits:{bitmap:s="",padding:l=0},hashCount:h=0}=o;try{r=__PRIVATE_normalizeByteString(s).toUint8Array()}catch(e){if(e instanceof __PRIVATE_Base64DecodeError)return __PRIVATE_logWarn("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{i=new BloomFilter(r,l,h)}catch(e){return __PRIVATE_logWarn(e instanceof __PRIVATE_BloomFilterError?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===i.ge?null:i}ct(e,r,i){return r.Ce.count===i-this.Pt(e,r.targetId)?0:2}Pt(e,r){let i=this.Ge.getRemoteKeysForTarget(r),o=0;return i.forEach(i=>{let s=this.Ge.ht(),l=`projects/${s.projectId}/databases/${s.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(r,i,null),o++)}),o}Tt(e){let r=new Map;this.ze.forEach((i,o)=>{let s=this.ot(o);if(s){if(i.current&&__PRIVATE_targetIsDocumentTarget(s.target)){let r=new DocumentKey(s.target.path);this.It(r).has(o)||this.Et(o,r)||this.et(o,r,MutableDocument.newNoDocument(r,e))}i.Be&&(r.set(o,i.ke()),i.qe())}});let i=__PRIVATE_documentKeySet();this.He.forEach((e,r)=>{let o=!0;r.forEachWhile(e=>{let r=this.ot(e);return!r||"TargetPurposeLimboResolution"===r.purpose||(o=!1,!1)}),o&&(i=i.add(e))}),this.je.forEach((r,i)=>i.setReadTime(e));let o=new RemoteEvent(e,r,this.Ye,this.je,i);return this.je=eS,this.Je=__PRIVATE_documentTargetMap(),this.He=__PRIVATE_documentTargetMap(),this.Ye=new SortedMap(__PRIVATE_primitiveComparator),o}Xe(e,r){if(!this.rt(e))return;let i=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,i),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,i){if(!this.rt(e))return;let o=this.nt(e);this.Et(e,r)?o.Qe(r,1):o.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),i&&(this.je=this.je.insert(r,i))}removeTarget(e){this.ze.delete(e)}_t(e){let r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new __PRIVATE_TargetState,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new SortedSet(__PRIVATE_primitiveComparator),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new SortedSet(__PRIVATE_primitiveComparator),this.Je=this.Je.insert(e,r)),r}rt(e){let r=null!==this.ot(e);return r||__PRIVATE_logDebug("WatchChangeAggregator","Detected inactive target",e),r}ot(e){let r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new __PRIVATE_TargetState),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}};function __PRIVATE_documentTargetMap(){return new SortedMap(DocumentKey.comparator)}function __PRIVATE_snapshotChangesMap(){return new SortedMap(DocumentKey.comparator)}let eO={asc:"ASCENDING",desc:"DESCENDING"},eN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eL={and:"AND",or:"OR"};let JsonProtoSerializer=class JsonProtoSerializer{constructor(e,r){this.databaseId=e,this.useProto3Json=r}};function __PRIVATE_toInt32Proto(e,r){return e.useProto3Json||null==r?r:{value:r}}function toTimestamp(e,r){return e.useProto3Json?`${new Date(1e3*r.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+r.nanoseconds).slice(-9)}Z`:{seconds:""+r.seconds,nanos:r.nanoseconds}}function __PRIVATE_toBytes(e,r){return e.useProto3Json?r.toBase64():r.toUint8Array()}function __PRIVATE_toVersion(e,r){return toTimestamp(e,r.toTimestamp())}function __PRIVATE_fromVersion(e){return __PRIVATE_hardAssert(!!e,49232),SnapshotVersion.fromTimestamp(function(e){let r=__PRIVATE_normalizeTimestamp(e);return new Timestamp(r.seconds,r.nanos)}(e))}function __PRIVATE_toResourceName(e,r){return __PRIVATE_toResourcePath(e,r).canonicalString()}function __PRIVATE_toResourcePath(e,r){let i=new ResourcePath(["projects",e.projectId,"databases",e.database]).child("documents");return void 0===r?i:i.child(r)}function __PRIVATE_fromResourceName(e){let r=ResourcePath.fromString(e);return __PRIVATE_hardAssert(__PRIVATE_isValidResourceName(r),10190,{key:r.toString()}),r}function __PRIVATE_toName(e,r){return __PRIVATE_toResourceName(e.databaseId,r.path)}function fromName(e,r){let i=__PRIVATE_fromResourceName(r);if(i.get(1)!==e.databaseId.projectId)throw new FirestoreError(ef.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+i.get(1)+" vs "+e.databaseId.projectId);if(i.get(3)!==e.databaseId.database)throw new FirestoreError(ef.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+i.get(3)+" vs "+e.databaseId.database);return new DocumentKey(__PRIVATE_extractLocalPathFromResourceName(i))}function __PRIVATE_toQueryPath(e,r){return __PRIVATE_toResourceName(e.databaseId,r)}function __PRIVATE_fromQueryPath(e){let r=__PRIVATE_fromResourceName(e);return 4===r.length?ResourcePath.emptyPath():__PRIVATE_extractLocalPathFromResourceName(r)}function __PRIVATE_getEncodedDatabaseId(e){return new ResourcePath(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function __PRIVATE_extractLocalPathFromResourceName(e){return __PRIVATE_hardAssert(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function __PRIVATE_toMutationDocument(e,r,i){return{name:__PRIVATE_toName(e,r),fields:i.value.mapValue.fields}}function __PRIVATE_fromWatchChange(e,r){let i;if("targetChange"in r){var o,s;r.targetChange;let l="NO_CHANGE"===(o=r.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:fail(39313,{state:o}),h=r.targetChange.targetIds||[],d=(s=r.targetChange.resumeToken,e.useProto3Json?(__PRIVATE_hardAssert(void 0===s||"string"==typeof s,58123),ByteString.fromBase64String(s||"")):(__PRIVATE_hardAssert(void 0===s||s instanceof ea||s instanceof Uint8Array,16193),ByteString.fromUint8Array(s||new Uint8Array))),f=r.targetChange.cause,_=f&&function(e){let r=void 0===e.code?ef.UNKNOWN:__PRIVATE_mapCodeFromRpcCode(e.code);return new FirestoreError(r,e.message||"")}(f);i=new __PRIVATE_WatchTargetChange(l,h,d,_||null)}else if("documentChange"in r){r.documentChange;let o=r.documentChange;o.document,o.document.name,o.document.updateTime;let s=fromName(e,o.document.name),l=__PRIVATE_fromVersion(o.document.updateTime),h=o.document.createTime?__PRIVATE_fromVersion(o.document.createTime):SnapshotVersion.min(),d=new ObjectValue({mapValue:{fields:o.document.fields}}),f=MutableDocument.newFoundDocument(s,l,h,d),_=o.targetIds||[],g=o.removedTargetIds||[];i=new __PRIVATE_DocumentWatchChange(_,g,f.key,f)}else if("documentDelete"in r){r.documentDelete;let o=r.documentDelete;o.document;let s=fromName(e,o.document),l=o.readTime?__PRIVATE_fromVersion(o.readTime):SnapshotVersion.min(),h=MutableDocument.newNoDocument(s,l),d=o.removedTargetIds||[];i=new __PRIVATE_DocumentWatchChange([],d,h.key,h)}else if("documentRemove"in r){r.documentRemove;let o=r.documentRemove;o.document;let s=fromName(e,o.document),l=o.removedTargetIds||[];i=new __PRIVATE_DocumentWatchChange([],l,s,null)}else{if(!("filter"in r))return fail(11601,{Rt:r});{r.filter;let e=r.filter;e.targetId;let{count:o=0,unchangedNames:s}=e,l=new ExistenceFilter(o,s),h=e.targetId;i=new __PRIVATE_ExistenceFilterChange(h,l)}}return i}function toMutation(e,r){var i;let o;if(r instanceof __PRIVATE_SetMutation)o={update:__PRIVATE_toMutationDocument(e,r.key,r.value)};else if(r instanceof __PRIVATE_DeleteMutation)o={delete:__PRIVATE_toName(e,r.key)};else if(r instanceof __PRIVATE_PatchMutation)o={update:__PRIVATE_toMutationDocument(e,r.key,r.data),updateMask:__PRIVATE_toDocumentMask(r.fieldMask)};else{if(!(r instanceof __PRIVATE_VerifyMutation))return fail(16599,{Vt:r.type});o={verify:__PRIVATE_toName(e,r.key)}}return r.fieldTransforms.length>0&&(o.updateTransforms=r.fieldTransforms.map(e=>(function(e,r){let i=r.transform;if(i instanceof __PRIVATE_ServerTimestampTransform)return{fieldPath:r.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(i instanceof __PRIVATE_ArrayUnionTransformOperation)return{fieldPath:r.field.canonicalString(),appendMissingElements:{values:i.elements}};if(i instanceof __PRIVATE_ArrayRemoveTransformOperation)return{fieldPath:r.field.canonicalString(),removeAllFromArray:{values:i.elements}};if(i instanceof __PRIVATE_NumericIncrementTransformOperation)return{fieldPath:r.field.canonicalString(),increment:i.Ae};throw fail(20930,{transform:r.transform})})(0,e))),r.precondition.isNone||(o.currentDocument=void 0!==(i=r.precondition).updateTime?{updateTime:__PRIVATE_toVersion(e,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:fail(27497)),o}function __PRIVATE_fromWriteResults(e,r){return e&&e.length>0?(__PRIVATE_hardAssert(void 0!==r,14353),e.map(e=>{let i;return(i=e.updateTime?__PRIVATE_fromVersion(e.updateTime):__PRIVATE_fromVersion(r)).isEqual(SnapshotVersion.min())&&(i=__PRIVATE_fromVersion(r)),new MutationResult(i,e.transformResults||[])})):[]}function __PRIVATE_toDocumentsTarget(e,r){return{documents:[__PRIVATE_toQueryPath(e,r.path)]}}function __PRIVATE_toQueryTarget(e,r){var i,o;let s;let l={structuredQuery:{}},h=r.path;null!==r.collectionGroup?(s=h,l.structuredQuery.from=[{collectionId:r.collectionGroup,allDescendants:!0}]):(s=h.popLast(),l.structuredQuery.from=[{collectionId:h.lastSegment()}]),l.parent=__PRIVATE_toQueryPath(e,s);let d=function(e){if(0!==e.length)return __PRIVATE_toFilter(CompositeFilter.create(e,"and"))}(r.filters);d&&(l.structuredQuery.where=d);let f=function(e){if(0!==e.length)return e.map(e=>({field:__PRIVATE_toFieldPathReference(e.field),direction:__PRIVATE_toDirection(e.dir)}))}(r.orderBy);f&&(l.structuredQuery.orderBy=f);let _=__PRIVATE_toInt32Proto(e,r.limit);return null!==_&&(l.structuredQuery.limit=_),r.startAt&&(l.structuredQuery.startAt={before:(i=r.startAt).inclusive,values:i.position}),r.endAt&&(l.structuredQuery.endAt={before:!(o=r.endAt).inclusive,values:o.position}),{ft:l,parent:s}}function __PRIVATE_convertQueryTargetToQuery(e){var r;let i,o=__PRIVATE_fromQueryPath(e.parent),s=e.structuredQuery,l=s.from?s.from.length:0,h=null;if(l>0){__PRIVATE_hardAssert(1===l,65062);let e=s.from[0];e.allDescendants?h=e.collectionId:o=o.child(e.collectionId)}let d=[];s.where&&(d=function(e){var r;let i=__PRIVATE_fromFilter(e);return i instanceof CompositeFilter&&__PRIVATE_compositeFilterIsFlat(r=i)&&__PRIVATE_compositeFilterIsConjunction(r)?i.getFilters():[i]}(s.where));let f=[];s.orderBy&&(f=s.orderBy.map(e=>new OrderBy(__PRIVATE_fromFieldPathReference(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))));let _=null;s.limit&&(_=null==(i="object"==typeof(r=s.limit)?r.value:r)?null:i);let g=null;s.startAt&&(g=function(e){let r=!!e.before,i=e.values||[];return new Bound(i,r)}(s.startAt));let A=null;return s.endAt&&(A=function(e){let r=!e.before,i=e.values||[];return new Bound(i,r)}(s.endAt)),__PRIVATE_newQuery(o,h,f,d,_,"F",g,A)}function __PRIVATE_toListenRequestLabels(e,r){let i=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fail(28987,{purpose:e})}}(r.purpose);return null==i?null:{"goog-listen-tags":i}}function __PRIVATE_fromFilter(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":let r=__PRIVATE_fromFieldPathReference(e.unaryFilter.field);return FieldFilter.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=__PRIVATE_fromFieldPathReference(e.unaryFilter.field);return FieldFilter.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=__PRIVATE_fromFieldPathReference(e.unaryFilter.field);return FieldFilter.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=__PRIVATE_fromFieldPathReference(e.unaryFilter.field);return FieldFilter.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return fail(61313);default:return fail(60726)}}(e):void 0!==e.fieldFilter?FieldFilter.create(__PRIVATE_fromFieldPathReference(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return fail(58110);default:return fail(50506)}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==e.compositeFilter?CompositeFilter.create(e.compositeFilter.filters.map(e=>__PRIVATE_fromFilter(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return fail(1026)}}(e.compositeFilter.op)):fail(30097,{filter:e})}function __PRIVATE_toDirection(e){return eO[e]}function __PRIVATE_toOperatorName(e){return eN[e]}function __PRIVATE_toCompositeOperatorName(e){return eL[e]}function __PRIVATE_toFieldPathReference(e){return{fieldPath:e.canonicalString()}}function __PRIVATE_fromFieldPathReference(e){return FieldPath$1.fromServerFormat(e.fieldPath)}function __PRIVATE_toFilter(e){return e instanceof FieldFilter?function(e){if("=="===e.op){if(__PRIVATE_isNanValue(e.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(e.field),op:"IS_NAN"}};if(__PRIVATE_isNullValue(e.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(__PRIVATE_isNanValue(e.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(e.field),op:"IS_NOT_NAN"}};if(__PRIVATE_isNullValue(e.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:__PRIVATE_toFieldPathReference(e.field),op:__PRIVATE_toOperatorName(e.op),value:e.value}}}(e):e instanceof CompositeFilter?function(e){let r=e.getFilters().map(e=>__PRIVATE_toFilter(e));return 1===r.length?r[0]:{compositeFilter:{op:__PRIVATE_toCompositeOperatorName(e.op),filters:r}}}(e):fail(54877,{filter:e})}function __PRIVATE_toDocumentMask(e){let r=[];return e.fields.forEach(e=>r.push(e.canonicalString())),{fieldPaths:r}}function __PRIVATE_isValidResourceName(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TargetData=class TargetData{constructor(e,r,i,o,s=SnapshotVersion.min(),l=SnapshotVersion.min(),h=ByteString.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=r,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(e){return new TargetData(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_LocalSerializer=class __PRIVATE_LocalSerializer{constructor(e){this.yt=e}};function __PRIVATE_fromBundledQuery(e){let r=__PRIVATE_convertQueryTargetToQuery({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?__PRIVATE_queryWithLimit(r,r.limit,"L"):r}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_FirestoreIndexValueWriter=class __PRIVATE_FirestoreIndexValueWriter{constructor(){}Dt(e,r){this.Ct(e,r),r.vt()}Ct(e,r){if("nullValue"in e)this.Ft(r,5);else if("booleanValue"in e)this.Ft(r,10),r.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(r,15),r.Mt(__PRIVATE_normalizeNumber(e.integerValue));else if("doubleValue"in e){let i=__PRIVATE_normalizeNumber(e.doubleValue);isNaN(i)?this.Ft(r,13):(this.Ft(r,15),__PRIVATE_isNegativeZero(i)?r.Mt(0):r.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(r,20),"string"==typeof i&&(i=__PRIVATE_normalizeTimestamp(i)),r.xt(`${i.seconds||""}`),r.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,r),this.Nt(r);else if("bytesValue"in e)this.Ft(r,30),r.Bt(__PRIVATE_normalizeByteString(e.bytesValue)),this.Nt(r);else if("referenceValue"in e)this.Lt(e.referenceValue,r);else if("geoPointValue"in e){let i=e.geoPointValue;this.Ft(r,45),r.Mt(i.latitude||0),r.Mt(i.longitude||0)}else"mapValue"in e?__PRIVATE_isMaxValue(e)?this.Ft(r,Number.MAX_SAFE_INTEGER):__PRIVATE_isVectorValue(e)?this.kt(e.mapValue,r):(this.qt(e.mapValue,r),this.Nt(r)):"arrayValue"in e?(this.Qt(e.arrayValue,r),this.Nt(r)):fail(19022,{$t:e})}Ot(e,r){this.Ft(r,25),this.Ut(e,r)}Ut(e,r){r.xt(e)}qt(e,r){let i=e.fields||{};for(let e of(this.Ft(r,55),Object.keys(i)))this.Ot(e,r),this.Ct(i[e],r)}kt(e,r){let i=e.fields||{};this.Ft(r,53);let o=i[ew].arrayValue?.values?.length||0;this.Ft(r,15),r.Mt(__PRIVATE_normalizeNumber(o)),this.Ot(ew,r),this.Ct(i[ew],r)}Qt(e,r){let i=e.values||[];for(let e of(this.Ft(r,50),i))this.Ct(e,r)}Lt(e,r){this.Ft(r,37),DocumentKey.fromName(e).path.forEach(e=>{this.Ft(r,60),this.Ut(e,r)})}Ft(e,r){e.Mt(r)}Nt(e){e.Mt(2)}};__PRIVATE_FirestoreIndexValueWriter.Kt=new __PRIVATE_FirestoreIndexValueWriter;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryIndexManager=class __PRIVATE_MemoryIndexManager{constructor(){this.Cn=new __PRIVATE_MemoryCollectionParentIndex}addToCollectionParentIndex(e,r){return this.Cn.add(r),PersistencePromise.resolve()}getCollectionParents(e,r){return PersistencePromise.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return PersistencePromise.resolve()}deleteFieldIndex(e,r){return PersistencePromise.resolve()}deleteAllFieldIndexes(e){return PersistencePromise.resolve()}createTargetIndexes(e,r){return PersistencePromise.resolve()}getDocumentsMatchingTarget(e,r){return PersistencePromise.resolve(null)}getIndexType(e,r){return PersistencePromise.resolve(0)}getFieldIndexes(e,r){return PersistencePromise.resolve([])}getNextCollectionGroupToUpdate(e){return PersistencePromise.resolve(null)}getMinOffset(e,r){return PersistencePromise.resolve(IndexOffset.min())}getMinOffsetFromCollectionGroup(e,r){return PersistencePromise.resolve(IndexOffset.min())}updateCollectionGroup(e,r,i){return PersistencePromise.resolve()}updateIndexEntries(e,r){return PersistencePromise.resolve()}};let __PRIVATE_MemoryCollectionParentIndex=class __PRIVATE_MemoryCollectionParentIndex{constructor(){this.index={}}add(e){let r=e.lastSegment(),i=e.popLast(),o=this.index[r]||new SortedSet(ResourcePath.comparator),s=!o.has(i);return this.index[r]=o.add(i),s}has(e){let r=e.lastSegment(),i=e.popLast(),o=this.index[r];return o&&o.has(i)}getEntries(e){return(this.index[e]||new SortedSet(ResourcePath.comparator)).toArray()}};new Uint8Array(0);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eM={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};let LruParams=class LruParams{static withCacheSize(e){return new LruParams(e,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */LruParams.DEFAULT_COLLECTION_PERCENTILE=10,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,LruParams.DEFAULT=new LruParams(41943040,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),LruParams.DISABLED=new LruParams(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_TargetIdGenerator=class __PRIVATE_TargetIdGenerator{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new __PRIVATE_TargetIdGenerator(0)}static cr(){return new __PRIVATE_TargetIdGenerator(-1)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eF="LruGarbageCollector";function __PRIVATE_bufferEntryComparator([e,r],[i,o]){let s=__PRIVATE_primitiveComparator(e,i);return 0===s?__PRIVATE_primitiveComparator(r,o):s}let __PRIVATE_RollingSequenceNumberBuffer=class __PRIVATE_RollingSequenceNumberBuffer{constructor(e){this.Ir=e,this.buffer=new SortedSet(__PRIVATE_bufferEntryComparator),this.Er=0}dr(){return++this.Er}Ar(e){let r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{let e=this.buffer.last();0>__PRIVATE_bufferEntryComparator(r,e)&&(this.buffer=this.buffer.delete(e).add(r))}}get maxValue(){return this.buffer.last()[0]}};let __PRIVATE_LruScheduler=class __PRIVATE_LruScheduler{constructor(e,r,i){this.garbageCollector=e,this.asyncQueue=r,this.localStore=i,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){__PRIVATE_logDebug(eF,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){__PRIVATE_isIndexedDbTransactionError(e)?__PRIVATE_logDebug(eF,"Ignoring IndexedDB error during garbage collection: ",e):await __PRIVATE_ignoreIfPrimaryLeaseLoss(e)}await this.Vr(3e5)})}};let __PRIVATE_LruGarbageCollectorImpl=class __PRIVATE_LruGarbageCollectorImpl{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(e=>Math.floor(r/100*e))}nthSequenceNumber(e,r){if(0===r)return PersistencePromise.resolve(__PRIVATE_ListenSequence.ce);let i=new __PRIVATE_RollingSequenceNumberBuffer(r);return this.mr.forEachTarget(e,e=>i.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>i.Ar(e))).next(()=>i.maxValue)}removeTargets(e,r,i){return this.mr.removeTargets(e,r,i)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return -1===this.params.cacheSizeCollectionThreshold?(__PRIVATE_logDebug("LruGarbageCollector","Garbage collection skipped; disabled"),PersistencePromise.resolve(eM)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(__PRIVATE_logDebug("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),eM):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let i,o,s,l,h,d,f;let _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(r=>(r>this.params.maximumSequenceNumbersToCollect?(__PRIVATE_logDebug("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${r}`),o=this.params.maximumSequenceNumbersToCollect):o=r,l=Date.now(),this.nthSequenceNumber(e,o))).next(o=>(i=o,h=Date.now(),this.removeTargets(e,i,r))).next(r=>(s=r,d=Date.now(),this.removeOrphanedDocuments(e,i))).next(e=>(f=Date.now(),__PRIVATE_getLogLevel()<=et.in.DEBUG&&__PRIVATE_logDebug("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-_}ms
	Determined least recently used ${o} in `+(h-l)+"ms\n"+`	Removed ${s} targets in `+(d-h)+"ms\n"+`	Removed ${e} documents in `+(f-d)+"ms\n"+`Total Duration: ${f-_}ms`),PersistencePromise.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:s,documentsRemoved:e})))}};function __PRIVATE_newLruGarbageCollector(e,r){return new __PRIVATE_LruGarbageCollectorImpl(e,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RemoteDocumentChangeBuffer=class RemoteDocumentChangeBuffer{constructor(){this.changes=new ObjectMap(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,MutableDocument.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();let i=this.changes.get(r);return void 0!==i?PersistencePromise.resolve(i):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OverlayedDocument=class OverlayedDocument{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let LocalDocumentsView=class LocalDocumentsView{constructor(e,r,i,o){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,r){let i=null;return this.documentOverlayCache.getOverlay(e,r).next(o=>(i=o,this.remoteDocumentCache.getEntry(e,r))).next(e=>(null!==i&&__PRIVATE_mutationApplyToLocalView(i.mutation,e,FieldMask.empty(),Timestamp.now()),e))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(r=>this.getLocalViewOfDocuments(e,r,__PRIVATE_documentKeySet()).next(()=>r))}getLocalViewOfDocuments(e,r,i=__PRIVATE_documentKeySet()){let o=__PRIVATE_newDocumentKeyMap();return this.populateOverlays(e,o,r).next(()=>this.computeViews(e,r,o,i).next(e=>{let r=documentMap();return e.forEach((e,i)=>{r=r.insert(e,i.overlayedDocument)}),r}))}getOverlayedDocuments(e,r){let i=__PRIVATE_newDocumentKeyMap();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,__PRIVATE_documentKeySet()))}populateOverlays(e,r,i){let o=[];return i.forEach(e=>{r.has(e)||o.push(e)}),this.documentOverlayCache.getOverlays(e,o).next(e=>{e.forEach((e,i)=>{r.set(e,i)})})}computeViews(e,r,i,o){let s=eS,l=__PRIVATE_newDocumentKeyMap(),h=__PRIVATE_newDocumentKeyMap();return r.forEach((e,r)=>{let h=i.get(r.key);o.has(r.key)&&(void 0===h||h.mutation instanceof __PRIVATE_PatchMutation)?s=s.insert(r.key,r):void 0!==h?(l.set(r.key,h.mutation.getFieldMask()),__PRIVATE_mutationApplyToLocalView(h.mutation,r,h.mutation.getFieldMask(),Timestamp.now())):l.set(r.key,FieldMask.empty())}),this.recalculateAndSaveOverlays(e,s).next(e=>(e.forEach((e,r)=>l.set(e,r)),r.forEach((e,r)=>h.set(e,new OverlayedDocument(r,l.get(e)??null))),h))}recalculateAndSaveOverlays(e,r){let i=__PRIVATE_newDocumentKeyMap(),o=new SortedMap((e,r)=>e-r),s=__PRIVATE_documentKeySet();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(e=>{for(let s of e)s.keys().forEach(e=>{let l=r.get(e);if(null===l)return;let h=i.get(e)||FieldMask.empty();h=s.applyToLocalView(l,h),i.set(e,h);let d=(o.get(s.batchId)||__PRIVATE_documentKeySet()).add(e);o=o.insert(s.batchId,d)})}).next(()=>{let l=[],h=o.getReverseIterator();for(;h.hasNext();){let o=h.getNext(),d=o.key,f=o.value,_=__PRIVATE_newDocumentKeyMap();f.forEach(e=>{if(!s.has(e)){let o=__PRIVATE_calculateOverlayMutation(r.get(e),i.get(e));null!==o&&_.set(e,o),s=s.add(e)}}),l.push(this.documentOverlayCache.saveOverlays(e,d,_))}return PersistencePromise.waitFor(l)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,r,i,o){return DocumentKey.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,r.path):__PRIVATE_isCollectionGroupQuery(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,i,o):this.getDocumentsMatchingCollectionQuery(e,r,i,o)}getNextDocuments(e,r,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,i,o).next(s=>{let l=o-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,i.largestBatchId,o-s.size):PersistencePromise.resolve(__PRIVATE_newDocumentKeyMap()),h=-1,d=s;return l.next(r=>PersistencePromise.forEach(r,(r,i)=>(h<i.largestBatchId&&(h=i.largestBatchId),s.get(r)?PersistencePromise.resolve():this.remoteDocumentCache.getEntry(e,r).next(e=>{d=d.insert(r,e)}))).next(()=>this.populateOverlays(e,r,s)).next(()=>this.computeViews(e,d,r,__PRIVATE_documentKeySet())).next(e=>({batchId:h,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(e)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new DocumentKey(r)).next(e=>{let r=documentMap();return e.isFoundDocument()&&(r=r.insert(e.key,e)),r})}getDocumentsMatchingCollectionGroupQuery(e,r,i,o){let s=r.collectionGroup,l=documentMap();return this.indexManager.getCollectionParents(e,s).next(h=>PersistencePromise.forEach(h,h=>{let d=new __PRIVATE_QueryImpl(h.child(s),null,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt);return this.getDocumentsMatchingCollectionQuery(e,d,i,o).next(e=>{e.forEach((e,r)=>{l=l.insert(e,r)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,r,i,o){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,i.largestBatchId).next(l=>(s=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,i,s,o))).next(e=>{s.forEach((r,i)=>{let o=i.getKey();null===e.get(o)&&(e=e.insert(o,MutableDocument.newInvalidDocument(o)))});let i=documentMap();return e.forEach((e,o)=>{let l=s.get(e);void 0!==l&&__PRIVATE_mutationApplyToLocalView(l.mutation,o,FieldMask.empty(),Timestamp.now()),__PRIVATE_queryMatches(r,o)&&(i=i.insert(e,o))}),i})}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryBundleCache=class __PRIVATE_MemoryBundleCache{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return PersistencePromise.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,{id:r.id,version:r.version,createTime:__PRIVATE_fromVersion(r.createTime)}),PersistencePromise.resolve()}getNamedQuery(e,r){return PersistencePromise.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,{name:r.name,query:__PRIVATE_fromBundledQuery(r.bundledQuery),readTime:__PRIVATE_fromVersion(r.readTime)}),PersistencePromise.resolve()}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryDocumentOverlayCache=class __PRIVATE_MemoryDocumentOverlayCache{constructor(){this.overlays=new SortedMap(DocumentKey.comparator),this.qr=new Map}getOverlay(e,r){return PersistencePromise.resolve(this.overlays.get(r))}getOverlays(e,r){let i=__PRIVATE_newDocumentKeyMap();return PersistencePromise.forEach(r,r=>this.getOverlay(e,r).next(e=>{null!==e&&i.set(r,e)})).next(()=>i)}saveOverlays(e,r,i){return i.forEach((i,o)=>{this.St(e,r,o)}),PersistencePromise.resolve()}removeOverlaysForBatchId(e,r,i){let o=this.qr.get(i);return void 0!==o&&(o.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(i)),PersistencePromise.resolve()}getOverlaysForCollection(e,r,i){let o=__PRIVATE_newDocumentKeyMap(),s=r.length+1,l=new DocumentKey(r.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){let e=h.getNext().value,l=e.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===s&&e.largestBatchId>i&&o.set(e.getKey(),e)}return PersistencePromise.resolve(o)}getOverlaysForCollectionGroup(e,r,i,o){let s=new SortedMap((e,r)=>e-r),l=this.overlays.getIterator();for(;l.hasNext();){let e=l.getNext().value;if(e.getKey().getCollectionGroup()===r&&e.largestBatchId>i){let r=s.get(e.largestBatchId);null===r&&(r=__PRIVATE_newDocumentKeyMap(),s=s.insert(e.largestBatchId,r)),r.set(e.getKey(),e)}}let h=__PRIVATE_newDocumentKeyMap(),d=s.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((e,r)=>h.set(e,r)),!(h.size()>=o)););return PersistencePromise.resolve(h)}St(e,r,i){let o=this.overlays.get(i.key);if(null!==o){let e=this.qr.get(o.largestBatchId).delete(i.key);this.qr.set(o.largestBatchId,e)}this.overlays=this.overlays.insert(i.key,new Overlay(r,i));let s=this.qr.get(r);void 0===s&&(s=__PRIVATE_documentKeySet(),this.qr.set(r,s)),this.qr.set(r,s.add(i.key))}};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryGlobalsCache=class __PRIVATE_MemoryGlobalsCache{constructor(){this.sessionToken=ByteString.EMPTY_BYTE_STRING}getSessionToken(e){return PersistencePromise.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,PersistencePromise.resolve()}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_ReferenceSet=class __PRIVATE_ReferenceSet{constructor(){this.Qr=new SortedSet(__PRIVATE_DocReference.$r),this.Ur=new SortedSet(__PRIVATE_DocReference.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){let i=new __PRIVATE_DocReference(e,r);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,r){e.forEach(e=>this.addReference(e,r))}removeReference(e,r){this.Gr(new __PRIVATE_DocReference(e,r))}zr(e,r){e.forEach(e=>this.removeReference(e,r))}jr(e){let r=new DocumentKey(new ResourcePath([])),i=new __PRIVATE_DocReference(r,e),o=new __PRIVATE_DocReference(r,e+1),s=[];return this.Ur.forEachInRange([i,o],e=>{this.Gr(e),s.push(e.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let r=new DocumentKey(new ResourcePath([])),i=new __PRIVATE_DocReference(r,e),o=new __PRIVATE_DocReference(r,e+1),s=__PRIVATE_documentKeySet();return this.Ur.forEachInRange([i,o],e=>{s=s.add(e.key)}),s}containsKey(e){let r=new __PRIVATE_DocReference(e,0),i=this.Qr.firstAfterOrEqual(r);return null!==i&&e.isEqual(i.key)}};let __PRIVATE_DocReference=class __PRIVATE_DocReference{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return DocumentKey.comparator(e.key,r.key)||__PRIVATE_primitiveComparator(e.Yr,r.Yr)}static Kr(e,r){return __PRIVATE_primitiveComparator(e.Yr,r.Yr)||DocumentKey.comparator(e.key,r.key)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryMutationQueue=class __PRIVATE_MemoryMutationQueue{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new SortedSet(__PRIVATE_DocReference.$r)}checkEmpty(e){return PersistencePromise.resolve(0===this.mutationQueue.length)}addMutationBatch(e,r,i,o){let s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let l=new MutationBatch(s,r,i,o);for(let r of(this.mutationQueue.push(l),o))this.Zr=this.Zr.add(new __PRIVATE_DocReference(r.key,s)),this.indexManager.addToCollectionParentIndex(e,r.key.path.popLast());return PersistencePromise.resolve(l)}lookupMutationBatch(e,r){return PersistencePromise.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){let i=this.ei(r+1),o=i<0?0:i;return PersistencePromise.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return PersistencePromise.resolve(0===this.mutationQueue.length?-1:this.tr-1)}getAllMutationBatches(e){return PersistencePromise.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){let i=new __PRIVATE_DocReference(r,0),o=new __PRIVATE_DocReference(r,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,o],e=>{let r=this.Xr(e.Yr);s.push(r)}),PersistencePromise.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let i=new SortedSet(__PRIVATE_primitiveComparator);return r.forEach(e=>{let r=new __PRIVATE_DocReference(e,0),o=new __PRIVATE_DocReference(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([r,o],e=>{i=i.add(e.Yr)})}),PersistencePromise.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,r){let i=r.path,o=i.length+1,s=i;DocumentKey.isDocumentKey(s)||(s=s.child(""));let l=new __PRIVATE_DocReference(new DocumentKey(s),0),h=new SortedSet(__PRIVATE_primitiveComparator);return this.Zr.forEachWhile(e=>{let r=e.key.path;return!!i.isPrefixOf(r)&&(r.length===o&&(h=h.add(e.Yr)),!0)},l),PersistencePromise.resolve(this.ti(h))}ti(e){let r=[];return e.forEach(e=>{let i=this.Xr(e);null!==i&&r.push(i)}),r}removeMutationBatch(e,r){__PRIVATE_hardAssert(0===this.ni(r.batchId,"removed"),55003),this.mutationQueue.shift();let i=this.Zr;return PersistencePromise.forEach(r.mutations,o=>{let s=new __PRIVATE_DocReference(o.key,r.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Zr=i})}ir(e){}containsKey(e,r){let i=new __PRIVATE_DocReference(r,0),o=this.Zr.firstAfterOrEqual(i);return PersistencePromise.resolve(r.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,PersistencePromise.resolve()}ni(e,r){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){let r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryRemoteDocumentCacheImpl=class __PRIVATE_MemoryRemoteDocumentCacheImpl{constructor(e){this.ri=e,this.docs=new SortedMap(DocumentKey.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){let i=r.key,o=this.docs.get(i),s=o?o.size:0,l=this.ri(r);return this.docs=this.docs.insert(i,{document:r.mutableCopy(),size:l}),this.size+=l-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){let i=this.docs.get(r);return PersistencePromise.resolve(i?i.document.mutableCopy():MutableDocument.newInvalidDocument(r))}getEntries(e,r){let i=eS;return r.forEach(e=>{let r=this.docs.get(e);i=i.insert(e,r?r.document.mutableCopy():MutableDocument.newInvalidDocument(e))}),PersistencePromise.resolve(i)}getDocumentsMatchingQuery(e,r,i,o){let s=eS,l=r.path,h=new DocumentKey(l.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){let{key:e,value:{document:h}}=d.getNext();if(!l.isPrefixOf(e.path))break;e.path.length>l.length+1||0>=__PRIVATE_indexOffsetComparator(__PRIVATE_newIndexOffsetFromDocument(h),i)||(o.has(h.key)||__PRIVATE_queryMatches(r,h))&&(s=s.insert(h.key,h.mutableCopy()))}return PersistencePromise.resolve(s)}getAllFromCollectionGroup(e,r,i,o){fail(9500)}ii(e,r){return PersistencePromise.forEach(this.docs,e=>r(e))}newChangeBuffer(e){return new __PRIVATE_MemoryRemoteDocumentChangeBuffer(this)}getSize(e){return PersistencePromise.resolve(this.size)}};let __PRIVATE_MemoryRemoteDocumentChangeBuffer=class __PRIVATE_MemoryRemoteDocumentChangeBuffer extends RemoteDocumentChangeBuffer{constructor(e){super(),this.Nr=e}applyChanges(e){let r=[];return this.changes.forEach((i,o)=>{o.isValidDocument()?r.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(i)}),PersistencePromise.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryTargetCache=class __PRIVATE_MemoryTargetCache{constructor(e){this.persistence=e,this.si=new ObjectMap(e=>__PRIVATE_canonifyTarget(e),__PRIVATE_targetEquals),this.lastRemoteSnapshotVersion=SnapshotVersion.min(),this.highestTargetId=0,this.oi=0,this._i=new __PRIVATE_ReferenceSet,this.targetCount=0,this.ai=__PRIVATE_TargetIdGenerator.ur()}forEachTarget(e,r){return this.si.forEach((e,i)=>r(i)),PersistencePromise.resolve()}getLastRemoteSnapshotVersion(e){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return PersistencePromise.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),PersistencePromise.resolve(this.highestTargetId)}setTargetsMetadata(e,r,i){return i&&(this.lastRemoteSnapshotVersion=i),r>this.oi&&(this.oi=r),PersistencePromise.resolve()}Pr(e){this.si.set(e.target,e);let r=e.targetId;r>this.highestTargetId&&(this.ai=new __PRIVATE_TargetIdGenerator(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,PersistencePromise.resolve()}updateTargetData(e,r){return this.Pr(r),PersistencePromise.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,PersistencePromise.resolve()}removeTargets(e,r,i){let o=0,s=[];return this.si.forEach((l,h)=>{h.sequenceNumber<=r&&null===i.get(h.targetId)&&(this.si.delete(l),s.push(this.removeMatchingKeysForTargetId(e,h.targetId)),o++)}),PersistencePromise.waitFor(s).next(()=>o)}getTargetCount(e){return PersistencePromise.resolve(this.targetCount)}getTargetData(e,r){let i=this.si.get(r)||null;return PersistencePromise.resolve(i)}addMatchingKeys(e,r,i){return this._i.Wr(r,i),PersistencePromise.resolve()}removeMatchingKeys(e,r,i){this._i.zr(r,i);let o=this.persistence.referenceDelegate,s=[];return o&&r.forEach(r=>{s.push(o.markPotentiallyOrphaned(e,r))}),PersistencePromise.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),PersistencePromise.resolve()}getMatchingKeysForTargetId(e,r){let i=this._i.Hr(r);return PersistencePromise.resolve(i)}containsKey(e,r){return PersistencePromise.resolve(this._i.containsKey(r))}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryPersistence=class __PRIVATE_MemoryPersistence{constructor(e,r){this.ui={},this.overlays={},this.ci=new __PRIVATE_ListenSequence(0),this.li=!1,this.li=!0,this.hi=new __PRIVATE_MemoryGlobalsCache,this.referenceDelegate=e(this),this.Pi=new __PRIVATE_MemoryTargetCache(this),this.indexManager=new __PRIVATE_MemoryIndexManager,this.remoteDocumentCache=new __PRIVATE_MemoryRemoteDocumentCacheImpl(e=>this.referenceDelegate.Ti(e)),this.serializer=new __PRIVATE_LocalSerializer(r),this.Ii=new __PRIVATE_MemoryBundleCache(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new __PRIVATE_MemoryDocumentOverlayCache,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let i=this.ui[e.toKey()];return i||(i=new __PRIVATE_MemoryMutationQueue(r,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,i){__PRIVATE_logDebug("MemoryPersistence","Starting transaction:",e);let o=new __PRIVATE_MemoryTransaction(this.ci.next());return this.referenceDelegate.Ei(),i(o).next(e=>this.referenceDelegate.di(o).next(()=>e)).toPromise().then(e=>(o.raiseOnCommittedEvent(),e))}Ai(e,r){return PersistencePromise.or(Object.values(this.ui).map(i=>()=>i.containsKey(e,r)))}};let __PRIVATE_MemoryTransaction=class __PRIVATE_MemoryTransaction extends PersistenceTransaction{constructor(e){super(),this.currentSequenceNumber=e}};let __PRIVATE_MemoryEagerDelegate=class __PRIVATE_MemoryEagerDelegate{constructor(e){this.persistence=e,this.Ri=new __PRIVATE_ReferenceSet,this.Vi=null}static mi(e){return new __PRIVATE_MemoryEagerDelegate(e)}get fi(){if(this.Vi)return this.Vi;throw fail(60996)}addReference(e,r,i){return this.Ri.addReference(i,r),this.fi.delete(i.toString()),PersistencePromise.resolve()}removeReference(e,r,i){return this.Ri.removeReference(i,r),this.fi.add(i.toString()),PersistencePromise.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),PersistencePromise.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(e=>this.fi.add(e.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,r.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>i.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){let r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return PersistencePromise.forEach(this.fi,i=>{let o=DocumentKey.fromPath(i);return this.gi(e,o).next(e=>{e||r.removeEntry(o,SnapshotVersion.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(e=>{e?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return PersistencePromise.or([()=>PersistencePromise.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}};let __PRIVATE_MemoryLruDelegate=class __PRIVATE_MemoryLruDelegate{constructor(e,r){this.persistence=e,this.pi=new ObjectMap(e=>__PRIVATE_encodeResourcePath(e.path),(e,r)=>e.isEqual(r)),this.garbageCollector=__PRIVATE_newLruGarbageCollector(this,r)}static mi(e,r){return new __PRIVATE_MemoryLruDelegate(e,r)}Ei(){}di(e){return PersistencePromise.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){let r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>r.next(r=>e+r))}wr(e){let r=0;return this.pr(e,e=>{r++}).next(()=>r)}pr(e,r){return PersistencePromise.forEach(this.pi,(i,o)=>this.br(e,i,o).next(e=>e?PersistencePromise.resolve():r(o)))}removeTargets(e,r,i){return this.persistence.getTargetCache().removeTargets(e,r,i)}removeOrphanedDocuments(e,r){let i=0,o=this.persistence.getRemoteDocumentCache(),s=o.newChangeBuffer();return o.ii(e,o=>this.br(e,o,r).next(e=>{e||(i++,s.removeEntry(o,SnapshotVersion.min()))})).next(()=>s.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),PersistencePromise.resolve()}removeTarget(e,r){let i=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,r,i){return this.pi.set(i,e.currentSequenceNumber),PersistencePromise.resolve()}removeReference(e,r,i){return this.pi.set(i,e.currentSequenceNumber),PersistencePromise.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),PersistencePromise.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=__PRIVATE_estimateByteSize(e.data.value)),r}br(e,r,i){return PersistencePromise.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{let e=this.pi.get(r);return PersistencePromise.resolve(void 0!==e&&e>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_LocalViewChanges=class __PRIVATE_LocalViewChanges{constructor(e,r,i,o){this.targetId=e,this.fromCache=r,this.Es=i,this.ds=o}static As(e,r){let i=__PRIVATE_documentKeySet(),o=__PRIVATE_documentKeySet();for(let e of r.docChanges)switch(e.type){case 0:i=i.add(e.doc.key);break;case 1:o=o.add(e.doc.key)}return new __PRIVATE_LocalViewChanges(e,r.fromCache,i,o)}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QueryContext=class QueryContext{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_QueryEngine=class __PRIVATE_QueryEngine{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(0,en.G6)()?8:__PRIVATE_getAndroidVersion((0,en.z$)())>0?6:4}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,i,o){let s={result:null};return this.ys(e,r).next(e=>{s.result=e}).next(()=>{if(!s.result)return this.ws(e,r,o,i).next(e=>{s.result=e})}).next(()=>{if(s.result)return;let i=new QueryContext;return this.Ss(e,r,i).next(o=>{if(s.result=o,this.Vs)return this.bs(e,r,i,o.size)})}).next(()=>s.result)}bs(e,r,i,o){return i.documentReadCount<this.fs?(__PRIVATE_getLogLevel()<=et.in.DEBUG&&__PRIVATE_logDebug("QueryEngine","SDK will not create cache indexes for query:",__PRIVATE_stringifyQuery(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),PersistencePromise.resolve()):(__PRIVATE_getLogLevel()<=et.in.DEBUG&&__PRIVATE_logDebug("QueryEngine","Query:",__PRIVATE_stringifyQuery(r),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.gs*o?(__PRIVATE_getLogLevel()<=et.in.DEBUG&&__PRIVATE_logDebug("QueryEngine","The SDK decides to create cache indexes for query:",__PRIVATE_stringifyQuery(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,__PRIVATE_queryToTarget(r))):PersistencePromise.resolve())}ys(e,r){if(__PRIVATE_queryMatchesAllDocuments(r))return PersistencePromise.resolve(null);let i=__PRIVATE_queryToTarget(r);return this.indexManager.getIndexType(e,i).next(o=>0===o?null:(null!==r.limit&&1===o&&(i=__PRIVATE_queryToTarget(r=__PRIVATE_queryWithLimit(r,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{let s=__PRIVATE_documentKeySet(...o);return this.ps.getDocuments(e,s).next(o=>this.indexManager.getMinOffset(e,i).next(i=>{let l=this.Ds(r,o);return this.Cs(r,l,s,i.readTime)?this.ys(e,__PRIVATE_queryWithLimit(r,null,"F")):this.vs(e,l,r,i)}))})))}ws(e,r,i,o){return __PRIVATE_queryMatchesAllDocuments(r)||o.isEqual(SnapshotVersion.min())?PersistencePromise.resolve(null):this.ps.getDocuments(e,i).next(s=>{let l=this.Ds(r,s);return this.Cs(r,l,i,o)?PersistencePromise.resolve(null):(__PRIVATE_getLogLevel()<=et.in.DEBUG&&__PRIVATE_logDebug("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),__PRIVATE_stringifyQuery(r)),this.vs(e,l,r,__PRIVATE_newIndexOffsetSuccessorFromReadTime(o,-1)).next(e=>e))})}Ds(e,r){let i=new SortedSet(__PRIVATE_newQueryComparator(e));return r.forEach((r,o)=>{__PRIVATE_queryMatches(e,o)&&(i=i.add(o))}),i}Cs(e,r,i,o){if(null===e.limit)return!1;if(i.size!==r.size)return!0;let s="F"===e.limitType?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(o)>0)}Ss(e,r,i){return __PRIVATE_getLogLevel()<=et.in.DEBUG&&__PRIVATE_logDebug("QueryEngine","Using full collection scan to execute query:",__PRIVATE_stringifyQuery(r)),this.ps.getDocumentsMatchingQuery(e,r,IndexOffset.min(),i)}vs(e,r,i,o){return this.ps.getDocumentsMatchingQuery(e,i,o).next(e=>(r.forEach(r=>{e=e.insert(r.key,r)}),e))}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eB="LocalStore";let __PRIVATE_LocalStoreImpl=class __PRIVATE_LocalStoreImpl{constructor(e,r,i,o){this.persistence=e,this.Fs=r,this.serializer=o,this.Ms=new SortedMap(__PRIVATE_primitiveComparator),this.xs=new ObjectMap(e=>__PRIVATE_canonifyTarget(e),__PRIVATE_targetEquals),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LocalDocumentsView(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}};function __PRIVATE_newLocalStore(e,r,i,o){return new __PRIVATE_LocalStoreImpl(e,r,i,o)}async function __PRIVATE_localStoreHandleUserChange(e,r){return await e.persistence.runTransaction("Handle user change","readonly",i=>{let o;return e.mutationQueue.getAllMutationBatches(i).next(s=>(o=s,e.Bs(r),e.mutationQueue.getAllMutationBatches(i))).next(r=>{let s=[],l=[],h=__PRIVATE_documentKeySet();for(let e of o)for(let r of(s.push(e.batchId),e.mutations))h=h.add(r.key);for(let e of r)for(let r of(l.push(e.batchId),e.mutations))h=h.add(r.key);return e.localDocuments.getDocuments(i,h).next(e=>({Ls:e,removedBatchIds:s,addedBatchIds:l}))})})}function __PRIVATE_localStoreAcknowledgeBatch(e,r){return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let o=r.batch.keys(),s=e.Ns.newChangeBuffer({trackRemovals:!0});return(function(e,r,i,o){let s=i.batch,l=s.keys(),h=PersistencePromise.resolve();return l.forEach(e=>{h=h.next(()=>o.getEntry(r,e)).next(r=>{let l=i.docVersions.get(e);__PRIVATE_hardAssert(null!==l,48541),0>r.version.compareTo(l)&&(s.applyToRemoteDocument(r,i),r.isValidDocument()&&(r.setReadTime(i.commitVersion),o.addEntry(r)))})}),h.next(()=>e.mutationQueue.removeMutationBatch(r,s))})(e,i,r,s).next(()=>s.apply(i)).next(()=>e.mutationQueue.performConsistencyCheck(i)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(i,o,r.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(e){let r=__PRIVATE_documentKeySet();for(let i=0;i<e.mutationResults.length;++i)e.mutationResults[i].transformResults.length>0&&(r=r.add(e.batch.mutations[i].key));return r}(r))).next(()=>e.localDocuments.getDocuments(i,o))})}function __PRIVATE_localStoreGetLastRemoteSnapshotVersion(e){return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function __PRIVATE_localStoreApplyRemoteEventToLocalCache(e,r){let i=r.snapshotVersion,o=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let l=e.Ns.newChangeBuffer({trackRemovals:!0});o=e.Ms;let h=[];r.targetChanges.forEach((l,d)=>{let f=o.get(d);if(!f)return;h.push(e.Pi.removeMatchingKeys(s,l.removedDocuments,d).next(()=>e.Pi.addMatchingKeys(s,l.addedDocuments,d)));let _=f.withSequenceNumber(s.currentSequenceNumber);null!==r.targetMismatches.get(d)?_=_.withResumeToken(ByteString.EMPTY_BYTE_STRING,SnapshotVersion.min()).withLastLimboFreeSnapshotVersion(SnapshotVersion.min()):l.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(l.resumeToken,i)),o=o.insert(d,_),function(e,r,i){if(0===e.resumeToken.approximateByteSize())return!0;let o=r.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds();if(o>=3e8)return!0;let s=i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size;return s>0}(f,_,l)&&h.push(e.Pi.updateTargetData(s,_))});let d=eS,f=__PRIVATE_documentKeySet();if(r.documentUpdates.forEach(i=>{r.resolvedLimboDocuments.has(i)&&h.push(e.persistence.referenceDelegate.updateLimboDocument(s,i))}),h.push(__PRIVATE_populateDocumentChangeBuffer(s,l,r.documentUpdates).next(e=>{d=e.ks,f=e.qs})),!i.isEqual(SnapshotVersion.min())){let r=e.Pi.getLastRemoteSnapshotVersion(s).next(r=>e.Pi.setTargetsMetadata(s,s.currentSequenceNumber,i));h.push(r)}return PersistencePromise.waitFor(h).next(()=>l.apply(s)).next(()=>e.localDocuments.getLocalViewOfDocuments(s,d,f)).next(()=>d)}).then(r=>(e.Ms=o,r))}function __PRIVATE_populateDocumentChangeBuffer(e,r,i){let o=__PRIVATE_documentKeySet(),s=__PRIVATE_documentKeySet();return i.forEach(e=>o=o.add(e)),r.getEntries(e,o).next(e=>{let o=eS;return i.forEach((i,l)=>{let h=e.get(i);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(i)),l.isNoDocument()&&l.version.isEqual(SnapshotVersion.min())?(r.removeEntry(i,l.readTime),o=o.insert(i,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||0===l.version.compareTo(h.version)&&h.hasPendingWrites?(r.addEntry(l),o=o.insert(i,l)):__PRIVATE_logDebug(eB,"Ignoring outdated watch update for ",i,". Current version:",h.version," Watch version:",l.version)}),{ks:o,qs:s}})}function __PRIVATE_localStoreGetNextMutationBatch(e,r){return e.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===r&&(r=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(i,r)))}function __PRIVATE_localStoreAllocateTarget(e,r){return e.persistence.runTransaction("Allocate target","readwrite",i=>{let o;return e.Pi.getTargetData(i,r).next(s=>s?(o=s,PersistencePromise.resolve(o)):e.Pi.allocateTargetId(i).next(s=>(o=new TargetData(r,s,"TargetPurposeListen",i.currentSequenceNumber),e.Pi.addTargetData(i,o).next(()=>o))))}).then(i=>{let o=e.Ms.get(i.targetId);return(null===o||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(i.targetId,i),e.xs.set(r,i.targetId)),i})}async function __PRIVATE_localStoreReleaseTarget(e,r,i){let o=e.Ms.get(r);try{i||await e.persistence.runTransaction("Release target",i?"readwrite":"readwrite-primary",r=>e.persistence.referenceDelegate.removeTarget(r,o))}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;__PRIVATE_logDebug(eB,`Failed to update sequence numbers for target ${r}: ${e}`)}e.Ms=e.Ms.remove(r),e.xs.delete(o.target)}function __PRIVATE_localStoreExecuteQuery(e,r,i){let o=SnapshotVersion.min(),s=__PRIVATE_documentKeySet();return e.persistence.runTransaction("Execute query","readwrite",l=>(function(e,r,i){let o=e.xs.get(i);return void 0!==o?PersistencePromise.resolve(e.Ms.get(o)):e.Pi.getTargetData(r,i)})(e,l,__PRIVATE_queryToTarget(r)).next(r=>{if(r)return o=r.lastLimboFreeSnapshotVersion,e.Pi.getMatchingKeysForTargetId(l,r.targetId).next(e=>{s=e})}).next(()=>e.Fs.getDocumentsMatchingQuery(l,r,i?o:SnapshotVersion.min(),i?s:__PRIVATE_documentKeySet())).next(i=>(__PRIVATE_setMaxReadTime(e,__PRIVATE_queryCollectionGroup(r),i),{documents:i,Qs:s})))}function __PRIVATE_setMaxReadTime(e,r,i){let o=e.Os.get(r)||SnapshotVersion.min();i.forEach((e,r)=>{r.readTime.compareTo(o)>0&&(o=r.readTime)}),e.Os.set(r,o)}let __PRIVATE_LocalClientState=class __PRIVATE_LocalClientState{constructor(){this.activeTargetIds=__PRIVATE_targetIdSet()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};let __PRIVATE_MemorySharedClientState=class __PRIVATE_MemorySharedClientState{constructor(){this.Mo=new __PRIVATE_LocalClientState,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,i){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,i){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new __PRIVATE_LocalClientState,Promise.resolve()}handleUserChange(e,r,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_NoopConnectivityMonitor=class __PRIVATE_NoopConnectivityMonitor{Oo(e){}shutdown(){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eU="ConnectivityMonitor";let __PRIVATE_BrowserConnectivityMonitor=class __PRIVATE_BrowserConnectivityMonitor{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){for(let e of(__PRIVATE_logDebug(eU,"Network connectivity changed: AVAILABLE"),this.qo))e(0)}ko(){for(let e of(__PRIVATE_logDebug(eU,"Network connectivity changed: UNAVAILABLE"),this.qo))e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ez=null;function __PRIVATE_generateUniqueDebugId(){return null===ez?ez=268435456+Math.round(2147483648*Math.random()):ez++,"0x"+ez.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ej="RestConnection",eq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};let __PRIVATE_RestConnection=class __PRIVATE_RestConnection{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let r=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${i}/databases/${o}`,this.Wo=this.databaseId.database===eT?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Go(e,r,i,o,s){let l=__PRIVATE_generateUniqueDebugId(),h=this.zo(e,r.toUriEncodedString());__PRIVATE_logDebug(ej,`Sending RPC '${e}' ${l}:`,h,i);let d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,o,s);let{host:f}=new URL(h),_=(0,en.Xx)(f);return this.Jo(e,h,d,i,_).then(r=>(__PRIVATE_logDebug(ej,`Received RPC '${e}' ${l}: `,r),r),r=>{throw __PRIVATE_logWarn(ej,`RPC '${e}' ${l} failed with error: `,r,"url: ",h,"request:",i),r})}Ho(e,r,i,o,s,l){return this.Go(e,r,i,o,s)}jo(e,r,i){e["X-Goog-Api-Client"]="gl-js/ fire/"+eh,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((r,i)=>e[i]=r),i&&i.headers.forEach((r,i)=>e[i]=r)}zo(e,r){let i=eq[e];return`${this.Uo}/v1/${r}:${i}`}terminate(){}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_StreamBridge=class __PRIVATE_StreamBridge{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eW="WebChannelConnection";let __PRIVATE_WebChannelConnection=class __PRIVATE_WebChannelConnection extends __PRIVATE_RestConnection{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,i,o,s){let h=__PRIVATE_generateUniqueDebugId();return new Promise((s,_)=>{let g=new l;g.setWithCredentials(!0),g.listenOnce(d.COMPLETE,()=>{try{switch(g.getLastErrorCode()){case f.NO_ERROR:let r=g.getResponseJson();__PRIVATE_logDebug(eW,`XHR for RPC '${e}' ${h} received:`,JSON.stringify(r)),s(r);break;case f.TIMEOUT:__PRIVATE_logDebug(eW,`RPC '${e}' ${h} timed out`),_(new FirestoreError(ef.DEADLINE_EXCEEDED,"Request time out"));break;case f.HTTP_ERROR:let i=g.getStatus();if(__PRIVATE_logDebug(eW,`RPC '${e}' ${h} failed with status:`,i,"response text:",g.getResponseText()),i>0){let e=g.getResponseJson();Array.isArray(e)&&(e=e[0]);let r=e?.error;if(r&&r.status&&r.message){let e=function(e){let r=e.toLowerCase().replace(/_/g,"-");return Object.values(ef).indexOf(r)>=0?r:ef.UNKNOWN}(r.status);_(new FirestoreError(e,r.message))}else _(new FirestoreError(ef.UNKNOWN,"Server responded with status "+g.getStatus()))}else _(new FirestoreError(ef.UNAVAILABLE,"Connection failed."));break;default:fail(9055,{l_:e,streamId:h,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{__PRIVATE_logDebug(eW,`RPC '${e}' ${h} completed.`)}});let A=JSON.stringify(o);__PRIVATE_logDebug(eW,`RPC '${e}' ${h} sending request:`,o),g.send(r,"POST",A,i,15)})}T_(e,r,i){let o=__PRIVATE_generateUniqueDebugId(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=b(),d=A(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},M=this.longPollingOptions.timeoutSeconds;void 0!==M&&(f.longPollingTimeout=Math.round(1e3*M)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,r,i),f.encodeInitMessageHeaders=!0;let j=s.join("");__PRIVATE_logDebug(eW,`Creating RPC '${e}' stream ${o}: ${j}`,f);let q=l.createWebChannel(j,f);this.I_(q);let $=!1,ee=!1,et=new __PRIVATE_StreamBridge({Yo:r=>{ee?__PRIVATE_logDebug(eW,`Not sending because RPC '${e}' stream ${o} is closed:`,r):($||(__PRIVATE_logDebug(eW,`Opening RPC '${e}' stream ${o} transport.`),q.open(),$=!0),__PRIVATE_logDebug(eW,`RPC '${e}' stream ${o} sending:`,r),q.send(r))},Zo:()=>q.close()}),__PRIVATE_unguardedEventListen=(e,r,i)=>{e.listen(r,e=>{try{i(e)}catch(e){setTimeout(()=>{throw e},0)}})};return __PRIVATE_unguardedEventListen(q,h.EventType.OPEN,()=>{ee||(__PRIVATE_logDebug(eW,`RPC '${e}' stream ${o} transport opened.`),et.o_())}),__PRIVATE_unguardedEventListen(q,h.EventType.CLOSE,()=>{ee||(ee=!0,__PRIVATE_logDebug(eW,`RPC '${e}' stream ${o} transport closed`),et.a_(),this.E_(q))}),__PRIVATE_unguardedEventListen(q,h.EventType.ERROR,r=>{ee||(ee=!0,__PRIVATE_logWarn(eW,`RPC '${e}' stream ${o} transport errored. Name:`,r.name,"Message:",r.message),et.a_(new FirestoreError(ef.UNAVAILABLE,"The operation could not be completed")))}),__PRIVATE_unguardedEventListen(q,h.EventType.MESSAGE,r=>{if(!ee){let i=r.data[0];__PRIVATE_hardAssert(!!i,16349);let s=i?.error||i[0]?.error;if(s){__PRIVATE_logDebug(eW,`RPC '${e}' stream ${o} received error:`,s);let r=s.status,i=function(e){let r=k[e];if(void 0!==r)return __PRIVATE_mapCodeFromRpcCode(r)}(r),l=s.message;void 0===i&&(i=ef.INTERNAL,l="Unknown error status: "+r+" with message "+s.message),ee=!0,et.a_(new FirestoreError(i,l)),q.close()}else __PRIVATE_logDebug(eW,`RPC '${e}' stream ${o} received:`,i),et.u_(i)}}),__PRIVATE_unguardedEventListen(d,g.STAT_EVENT,r=>{r.stat===_.PROXY?__PRIVATE_logDebug(eW,`RPC '${e}' stream ${o} detected buffering proxy`):r.stat===_.NOPROXY&&__PRIVATE_logDebug(eW,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{et.__()},0),et}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}};function getDocument(){return"undefined"!=typeof document?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newSerializer(e){return new JsonProtoSerializer(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_ExponentialBackoff=class __PRIVATE_ExponentialBackoff{constructor(e,r,i=1e3,o=1.5,s=6e4){this.Mi=e,this.timerId=r,this.d_=i,this.A_=o,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let r=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,r-i);o>0&&__PRIVATE_logDebug("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eH="PersistentStream";let __PRIVATE_PersistentStream=class __PRIVATE_PersistentStream{constructor(e,r,i,o,s,l,h,d){this.Mi=e,this.S_=i,this.b_=o,this.connection=s,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new __PRIVATE_ExponentialBackoff(e,r)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():r&&r.code===ef.RESOURCE_EXHAUSTED?(__PRIVATE_logError(r.toString()),__PRIVATE_logError("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ef.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,i])=>{this.D_===r&&this.G_(e,i)},r=>{e(()=>{let e=new FirestoreError(ef.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(e)})})}G_(e,r){let i=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{i(()=>this.listener.Xo())}),this.stream.t_(()=>{i(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{i(()=>this.z_(e))}),this.stream.onMessage(e=>{i(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return __PRIVATE_logDebug(eH,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(__PRIVATE_logDebug(eH,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};let __PRIVATE_PersistentListenStream=class __PRIVATE_PersistentListenStream extends __PRIVATE_PersistentStream{constructor(e,r,i,o,s,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,o,l),this.serializer=s}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();let r=__PRIVATE_fromWatchChange(this.serializer,e),i=function(e){if(!("targetChange"in e))return SnapshotVersion.min();let r=e.targetChange;return r.targetIds&&r.targetIds.length?SnapshotVersion.min():r.readTime?__PRIVATE_fromVersion(r.readTime):SnapshotVersion.min()}(e);return this.listener.H_(r,i)}Y_(e){let r={};r.database=__PRIVATE_getEncodedDatabaseId(this.serializer),r.addTarget=function(e,r){let i;let o=r.target;if((i=__PRIVATE_targetIsDocumentTarget(o)?{documents:__PRIVATE_toDocumentsTarget(e,o)}:{query:__PRIVATE_toQueryTarget(e,o).ft}).targetId=r.targetId,r.resumeToken.approximateByteSize()>0){i.resumeToken=__PRIVATE_toBytes(e,r.resumeToken);let o=__PRIVATE_toInt32Proto(e,r.expectedCount);null!==o&&(i.expectedCount=o)}else if(r.snapshotVersion.compareTo(SnapshotVersion.min())>0){i.readTime=toTimestamp(e,r.snapshotVersion.toTimestamp());let o=__PRIVATE_toInt32Proto(e,r.expectedCount);null!==o&&(i.expectedCount=o)}return i}(this.serializer,e);let i=__PRIVATE_toListenRequestLabels(this.serializer,e);i&&(r.labels=i),this.q_(r)}Z_(e){let r={};r.database=__PRIVATE_getEncodedDatabaseId(this.serializer),r.removeTarget=e,this.q_(r)}};let __PRIVATE_PersistentWriteStream=class __PRIVATE_PersistentWriteStream extends __PRIVATE_PersistentStream{constructor(e,r,i,o,s,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,o,l),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return __PRIVATE_hardAssert(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,__PRIVATE_hardAssert(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){__PRIVATE_hardAssert(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let r=__PRIVATE_fromWriteResults(e.writeResults,e.commitTime),i=__PRIVATE_fromVersion(e.commitTime);return this.listener.na(i,r)}ra(){let e={};e.database=__PRIVATE_getEncodedDatabaseId(this.serializer),this.q_(e)}ea(e){let r={streamToken:this.lastStreamToken,writes:e.map(e=>toMutation(this.serializer,e))};this.q_(r)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Datastore=class Datastore{};let __PRIVATE_DatastoreImpl=class __PRIVATE_DatastoreImpl extends Datastore{constructor(e,r,i,o){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new FirestoreError(ef.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,l])=>this.connection.Go(e,__PRIVATE_toResourcePath(r,i),o,s,l)).catch(e=>{throw"FirebaseError"===e.name?(e.code===ef.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new FirestoreError(ef.UNKNOWN,e.toString())})}Ho(e,r,i,o,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,h])=>this.connection.Ho(e,__PRIVATE_toResourcePath(r,i),o,l,h,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===ef.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new FirestoreError(ef.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};let __PRIVATE_OnlineStateTracker=class __PRIVATE_OnlineStateTracker{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(__PRIVATE_logError(r),this.aa=!1):__PRIVATE_logDebug("OnlineStateTracker",r)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eK="RemoteStore";let __PRIVATE_RemoteStoreImpl=class __PRIVATE_RemoteStoreImpl{constructor(e,r,i,o,s){this.localStore=e,this.datastore=r,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(e=>{i.enqueueAndForget(async()=>{__PRIVATE_canUseNetwork(this)&&(__PRIVATE_logDebug(eK,"Restarting streams for network reachability change."),await async function(e){e.Ea.add(4),await __PRIVATE_disableNetworkInternal(e),e.Ra.set("Unknown"),e.Ea.delete(4),await __PRIVATE_enableNetworkInternal(e)}(this))})}),this.Ra=new __PRIVATE_OnlineStateTracker(i,o)}};async function __PRIVATE_enableNetworkInternal(e){if(__PRIVATE_canUseNetwork(e))for(let r of e.da)await r(!0)}async function __PRIVATE_disableNetworkInternal(e){for(let r of e.da)await r(!1)}function __PRIVATE_remoteStoreListen(e,r){e.Ia.has(r.targetId)||(e.Ia.set(r.targetId,r),__PRIVATE_shouldStartWatchStream(e)?__PRIVATE_startWatchStream(e):__PRIVATE_ensureWatchStream(e).O_()&&__PRIVATE_sendWatchRequest(e,r))}function __PRIVATE_remoteStoreUnlisten(e,r){let i=__PRIVATE_ensureWatchStream(e);e.Ia.delete(r),i.O_()&&__PRIVATE_sendUnwatchRequest(e,r),0===e.Ia.size&&(i.O_()?i.L_():__PRIVATE_canUseNetwork(e)&&e.Ra.set("Unknown"))}function __PRIVATE_sendWatchRequest(e,r){if(e.Va.Ue(r.targetId),r.resumeToken.approximateByteSize()>0||r.snapshotVersion.compareTo(SnapshotVersion.min())>0){let i=e.remoteSyncer.getRemoteKeysForTarget(r.targetId).size;r=r.withExpectedCount(i)}__PRIVATE_ensureWatchStream(e).Y_(r)}function __PRIVATE_sendUnwatchRequest(e,r){e.Va.Ue(r),__PRIVATE_ensureWatchStream(e).Z_(r)}function __PRIVATE_startWatchStream(e){e.Va=new __PRIVATE_WatchChangeAggregator({getRemoteKeysForTarget:r=>e.remoteSyncer.getRemoteKeysForTarget(r),At:r=>e.Ia.get(r)||null,ht:()=>e.datastore.serializer.databaseId}),__PRIVATE_ensureWatchStream(e).start(),e.Ra.ua()}function __PRIVATE_shouldStartWatchStream(e){return __PRIVATE_canUseNetwork(e)&&!__PRIVATE_ensureWatchStream(e).x_()&&e.Ia.size>0}function __PRIVATE_canUseNetwork(e){return 0===e.Ea.size}async function __PRIVATE_onWatchStreamConnected(e){e.Ra.set("Online")}async function __PRIVATE_onWatchStreamOpen(e){e.Ia.forEach((r,i)=>{__PRIVATE_sendWatchRequest(e,r)})}async function __PRIVATE_onWatchStreamClose(e,r){e.Va=void 0,__PRIVATE_shouldStartWatchStream(e)?(e.Ra.ha(r),__PRIVATE_startWatchStream(e)):e.Ra.set("Unknown")}async function __PRIVATE_onWatchStreamChange(e,r,i){if(e.Ra.set("Online"),r instanceof __PRIVATE_WatchTargetChange&&2===r.state&&r.cause)try{await async function(e,r){let i=r.cause;for(let o of r.targetIds)e.Ia.has(o)&&(await e.remoteSyncer.rejectListen(o,i),e.Ia.delete(o),e.Va.removeTarget(o))}(e,r)}catch(i){__PRIVATE_logDebug(eK,"Failed to remove targets %s: %s ",r.targetIds.join(","),i),await __PRIVATE_disableNetworkUntilRecovery(e,i)}else if(r instanceof __PRIVATE_DocumentWatchChange?e.Va.Ze(r):r instanceof __PRIVATE_ExistenceFilterChange?e.Va.st(r):e.Va.tt(r),!i.isEqual(SnapshotVersion.min()))try{let r=await __PRIVATE_localStoreGetLastRemoteSnapshotVersion(e.localStore);i.compareTo(r)>=0&&await function(e,r){let i=e.Va.Tt(r);return i.targetChanges.forEach((i,o)=>{if(i.resumeToken.approximateByteSize()>0){let s=e.Ia.get(o);s&&e.Ia.set(o,s.withResumeToken(i.resumeToken,r))}}),i.targetMismatches.forEach((r,i)=>{let o=e.Ia.get(r);if(!o)return;e.Ia.set(r,o.withResumeToken(ByteString.EMPTY_BYTE_STRING,o.snapshotVersion)),__PRIVATE_sendUnwatchRequest(e,r);let s=new TargetData(o.target,r,i,o.sequenceNumber);__PRIVATE_sendWatchRequest(e,s)}),e.remoteSyncer.applyRemoteEvent(i)}(e,i)}catch(r){__PRIVATE_logDebug(eK,"Failed to raise snapshot:",r),await __PRIVATE_disableNetworkUntilRecovery(e,r)}}async function __PRIVATE_disableNetworkUntilRecovery(e,r,i){if(!__PRIVATE_isIndexedDbTransactionError(r))throw r;e.Ea.add(1),await __PRIVATE_disableNetworkInternal(e),e.Ra.set("Offline"),i||(i=()=>__PRIVATE_localStoreGetLastRemoteSnapshotVersion(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{__PRIVATE_logDebug(eK,"Retrying IndexedDB access"),await i(),e.Ea.delete(1),await __PRIVATE_enableNetworkInternal(e)})}function __PRIVATE_executeWithRecovery(e,r){return r().catch(i=>__PRIVATE_disableNetworkUntilRecovery(e,i,r))}async function __PRIVATE_fillWritePipeline(e){let r=__PRIVATE_ensureWriteStream(e),i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:-1;for(;__PRIVATE_canAddToWritePipeline(e);)try{let o=await __PRIVATE_localStoreGetNextMutationBatch(e.localStore,i);if(null===o){0===e.Ta.length&&r.L_();break}i=o.batchId,__PRIVATE_addToWritePipeline(e,o)}catch(r){await __PRIVATE_disableNetworkUntilRecovery(e,r)}__PRIVATE_shouldStartWriteStream(e)&&__PRIVATE_startWriteStream(e)}function __PRIVATE_canAddToWritePipeline(e){return __PRIVATE_canUseNetwork(e)&&e.Ta.length<10}function __PRIVATE_addToWritePipeline(e,r){e.Ta.push(r);let i=__PRIVATE_ensureWriteStream(e);i.O_()&&i.X_&&i.ea(r.mutations)}function __PRIVATE_shouldStartWriteStream(e){return __PRIVATE_canUseNetwork(e)&&!__PRIVATE_ensureWriteStream(e).x_()&&e.Ta.length>0}function __PRIVATE_startWriteStream(e){__PRIVATE_ensureWriteStream(e).start()}async function __PRIVATE_onWriteStreamOpen(e){__PRIVATE_ensureWriteStream(e).ra()}async function __PRIVATE_onWriteHandshakeComplete(e){let r=__PRIVATE_ensureWriteStream(e);for(let i of e.Ta)r.ea(i.mutations)}async function __PRIVATE_onMutationResult(e,r,i){let o=e.Ta.shift(),s=MutationBatchResult.from(o,r,i);await __PRIVATE_executeWithRecovery(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await __PRIVATE_fillWritePipeline(e)}async function __PRIVATE_onWriteStreamClose(e,r){r&&__PRIVATE_ensureWriteStream(e).X_&&await async function(e,r){var i;if(__PRIVATE_isPermanentError(i=r.code)&&i!==ef.ABORTED){let i=e.Ta.shift();__PRIVATE_ensureWriteStream(e).B_(),await __PRIVATE_executeWithRecovery(e,()=>e.remoteSyncer.rejectFailedWrite(i.batchId,r)),await __PRIVATE_fillWritePipeline(e)}}(e,r),__PRIVATE_shouldStartWriteStream(e)&&__PRIVATE_startWriteStream(e)}async function __PRIVATE_remoteStoreHandleCredentialChange(e,r){e.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug(eK,"RemoteStore received new credentials");let i=__PRIVATE_canUseNetwork(e);e.Ea.add(3),await __PRIVATE_disableNetworkInternal(e),i&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(r),e.Ea.delete(3),await __PRIVATE_enableNetworkInternal(e)}async function __PRIVATE_remoteStoreApplyPrimaryState(e,r){r?(e.Ea.delete(2),await __PRIVATE_enableNetworkInternal(e)):r||(e.Ea.add(2),await __PRIVATE_disableNetworkInternal(e),e.Ra.set("Unknown"))}function __PRIVATE_ensureWatchStream(e){var r,i,o;return e.ma||(e.ma=(r=e.datastore,i=e.asyncQueue,o={Xo:__PRIVATE_onWatchStreamConnected.bind(null,e),t_:__PRIVATE_onWatchStreamOpen.bind(null,e),r_:__PRIVATE_onWatchStreamClose.bind(null,e),H_:__PRIVATE_onWatchStreamChange.bind(null,e)},r.sa(),new __PRIVATE_PersistentListenStream(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,o)),e.da.push(async r=>{r?(e.ma.B_(),__PRIVATE_shouldStartWatchStream(e)?__PRIVATE_startWatchStream(e):e.Ra.set("Unknown")):(await e.ma.stop(),e.Va=void 0)})),e.ma}function __PRIVATE_ensureWriteStream(e){var r,i,o;return e.fa||(e.fa=(r=e.datastore,i=e.asyncQueue,o={Xo:()=>Promise.resolve(),t_:__PRIVATE_onWriteStreamOpen.bind(null,e),r_:__PRIVATE_onWriteStreamClose.bind(null,e),ta:__PRIVATE_onWriteHandshakeComplete.bind(null,e),na:__PRIVATE_onMutationResult.bind(null,e)},r.sa(),new __PRIVATE_PersistentWriteStream(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,o)),e.da.push(async r=>{r?(e.fa.B_(),await __PRIVATE_fillWritePipeline(e)):(await e.fa.stop(),e.Ta.length>0&&(__PRIVATE_logDebug(eK,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DelayedOperation=class DelayedOperation{constructor(e,r,i,o,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=i,this.op=o,this.removalCallback=s,this.deferred=new __PRIVATE_Deferred,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,i,o,s){let l=Date.now()+i,h=new DelayedOperation(e,r,l,o,s);return h.start(i),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(ef.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function __PRIVATE_wrapInUserErrorIfRecoverable(e,r){if(__PRIVATE_logError("AsyncQueue",`${r}: ${e}`),__PRIVATE_isIndexedDbTransactionError(e))return new FirestoreError(ef.UNAVAILABLE,`${r}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DocumentSet=class DocumentSet{static emptySet(e){return new DocumentSet(e.comparator)}constructor(e){this.comparator=e?(r,i)=>e(r,i)||DocumentKey.comparator(r.key,i.key):(e,r)=>DocumentKey.comparator(e.key,r.key),this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,i)=>(e(r),!1))}add(e){let r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){let r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof DocumentSet)||this.size!==e.size)return!1;let r=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;r.hasNext();){let e=r.getNext().key,o=i.getNext().key;if(!e.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(r=>{e.push(r.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,r){let i=new DocumentSet;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=r,i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_DocumentChangeSet=class __PRIVATE_DocumentChangeSet{constructor(){this.ga=new SortedMap(DocumentKey.comparator)}track(e){let r=e.doc.key,i=this.ga.get(r);i?0!==e.type&&3===i.type?this.ga=this.ga.insert(r,e):3===e.type&&1!==i.type?this.ga=this.ga.insert(r,{type:i.type,doc:e.doc}):2===e.type&&2===i.type?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):2===e.type&&0===i.type?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):1===e.type&&0===i.type?this.ga=this.ga.remove(r):1===e.type&&2===i.type?this.ga=this.ga.insert(r,{type:1,doc:i.doc}):0===e.type&&1===i.type?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):fail(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(r,e)}ya(){let e=[];return this.ga.inorderTraversal((r,i)=>{e.push(i)}),e}};let ViewSnapshot=class ViewSnapshot{constructor(e,r,i,o,s,l,h,d,f){this.query=e,this.docs=r,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=s,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=f}static fromInitialDocuments(e,r,i,o,s){let l=[];return r.forEach(e=>{l.push({type:0,doc:e})}),new ViewSnapshot(e,r,DocumentSet.emptySet(r),l,i,o,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&__PRIVATE_queryEquals(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let r=this.docChanges,i=e.docChanges;if(r.length!==i.length)return!1;for(let e=0;e<r.length;e++)if(r[e].type!==i[e].type||!r[e].doc.isEqual(i[e].doc))return!1;return!0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_QueryListenersInfo=class __PRIVATE_QueryListenersInfo{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}};let __PRIVATE_EventManagerImpl=class __PRIVATE_EventManagerImpl{constructor(){this.queries=__PRIVATE_newQueriesObjectMap(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,r){let i=e.queries;e.queries=__PRIVATE_newQueriesObjectMap(),i.forEach((e,i)=>{for(let e of i.Sa)e.onError(r)})}(this,new FirestoreError(ef.ABORTED,"Firestore shutting down"))}};function __PRIVATE_newQueriesObjectMap(){return new ObjectMap(e=>__PRIVATE_canonifyQuery(e),__PRIVATE_queryEquals)}async function __PRIVATE_eventManagerListen(e,r){let i=3,o=r.query,s=e.queries.get(o);s?!s.ba()&&r.Da()&&(i=2):(s=new __PRIVATE_QueryListenersInfo,i=r.Da()?0:1);try{switch(i){case 0:s.wa=await e.onListen(o,!0);break;case 1:s.wa=await e.onListen(o,!1);break;case 2:await e.onFirstRemoteStoreListen(o)}}catch(i){let e=__PRIVATE_wrapInUserErrorIfRecoverable(i,`Initialization of query '${__PRIVATE_stringifyQuery(r.query)}' failed`);return void r.onError(e)}e.queries.set(o,s),s.Sa.push(r),r.va(e.onlineState),s.wa&&r.Fa(s.wa)&&__PRIVATE_raiseSnapshotsInSyncEvent(e)}async function __PRIVATE_eventManagerUnlisten(e,r){let i=r.query,o=3,s=e.queries.get(i);if(s){let e=s.Sa.indexOf(r);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?o=r.Da()?0:1:!s.ba()&&r.Da()&&(o=2))}switch(o){case 0:return e.queries.delete(i),e.onUnlisten(i,!0);case 1:return e.queries.delete(i),e.onUnlisten(i,!1);case 2:return e.onLastRemoteStoreUnlisten(i);default:return}}function __PRIVATE_eventManagerOnWatchChange(e,r){let i=!1;for(let o of r){let r=o.query,s=e.queries.get(r);if(s){for(let e of s.Sa)e.Fa(o)&&(i=!0);s.wa=o}}i&&__PRIVATE_raiseSnapshotsInSyncEvent(e)}function __PRIVATE_eventManagerOnWatchError(e,r,i){let o=e.queries.get(r);if(o)for(let e of o.Sa)e.onError(i);e.queries.delete(r)}function __PRIVATE_raiseSnapshotsInSyncEvent(e){e.Ca.forEach(e=>{e.next()})}(q=j||(j={})).Ma="default",q.Cache="cache";let __PRIVATE_QueryListener=class __PRIVATE_QueryListener{constructor(e,r,i){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)3!==i.type&&r.push(i);e=new ViewSnapshot(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){return!(e.fromCache&&this.Da())||(!this.options.qa||!("Offline"!==r))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===r)}Ba(e){if(e.docChanges.length>0)return!0;let r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&!0===this.options.includeMetadataChanges}ka(e){e=ViewSnapshot.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==j.Cache}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_AddedLimboDocument=class __PRIVATE_AddedLimboDocument{constructor(e){this.key=e}};let __PRIVATE_RemovedLimboDocument=class __PRIVATE_RemovedLimboDocument{constructor(e){this.key=e}};let __PRIVATE_View=class __PRIVATE_View{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=__PRIVATE_documentKeySet(),this.mutatedKeys=__PRIVATE_documentKeySet(),this.eu=__PRIVATE_newQueryComparator(e),this.tu=new DocumentSet(this.eu)}get nu(){return this.Ya}ru(e,r){let i=r?r.iu:new __PRIVATE_DocumentChangeSet,o=r?r.tu:this.tu,s=r?r.mutatedKeys:this.mutatedKeys,l=o,h=!1,d="F"===this.query.limitType&&o.size===this.query.limit?o.last():null,f="L"===this.query.limitType&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((e,r)=>{let _=o.get(e),g=__PRIVATE_queryMatches(this.query,r)?r:null,A=!!_&&this.mutatedKeys.has(_.key),b=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations),k=!1;_&&g?_.data.isEqual(g.data)?A!==b&&(i.track({type:3,doc:g}),k=!0):this.su(_,g)||(i.track({type:2,doc:g}),k=!0,(d&&this.eu(g,d)>0||f&&0>this.eu(g,f))&&(h=!0)):!_&&g?(i.track({type:0,doc:g}),k=!0):_&&!g&&(i.track({type:1,doc:_}),k=!0,(d||f)&&(h=!0)),k&&(g?(l=l.add(g),s=b?s.add(e):s.delete(e)):(l=l.delete(e),s=s.delete(e)))}),null!==this.query.limit)for(;l.size>this.query.limit;){let e="F"===this.query.limitType?l.last():l.first();l=l.delete(e.key),s=s.delete(e.key),i.track({type:1,doc:e})}return{tu:l,iu:i,Cs:h,mutatedKeys:s}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,i,o){let s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let l=e.iu.ya();l.sort((e,r)=>(function(e,r){let order=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fail(20277,{Rt:e})}};return order(e)-order(r)})(e.type,r.type)||this.eu(e.doc,r.doc)),this.ou(i),o=o??!1;let h=r&&!o?this._u():[],d=0===this.Xa.size&&this.current&&!o?1:0,f=d!==this.Za;return(this.Za=d,0!==l.length||f)?{snapshot:new ViewSnapshot(this.query,e.tu,s,l,e.mutatedKeys,0===d,f,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new __PRIVATE_DocumentChangeSet,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Xa;this.Xa=__PRIVATE_documentKeySet(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});let r=[];return e.forEach(e=>{this.Xa.has(e)||r.push(new __PRIVATE_RemovedLimboDocument(e))}),this.Xa.forEach(i=>{e.has(i)||r.push(new __PRIVATE_AddedLimboDocument(i))}),r}cu(e){this.Ya=e.Qs,this.Xa=__PRIVATE_documentKeySet();let r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return ViewSnapshot.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}};let e$="SyncEngine";let __PRIVATE_QueryView=class __PRIVATE_QueryView{constructor(e,r,i){this.query=e,this.targetId=r,this.view=i}};let LimboResolution=class LimboResolution{constructor(e){this.key=e,this.hu=!1}};let __PRIVATE_SyncEngineImpl=class __PRIVATE_SyncEngineImpl{constructor(e,r,i,o,s,l){this.localStore=e,this.remoteStore=r,this.eventManager=i,this.sharedClientState=o,this.currentUser=s,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new ObjectMap(e=>__PRIVATE_canonifyQuery(e),__PRIVATE_queryEquals),this.Iu=new Map,this.Eu=new Set,this.du=new SortedMap(DocumentKey.comparator),this.Au=new Map,this.Ru=new __PRIVATE_ReferenceSet,this.Vu={},this.mu=new Map,this.fu=__PRIVATE_TargetIdGenerator.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}};async function __PRIVATE_syncEngineListen(e,r,i=!0){let o;let s=__PRIVATE_ensureWatchCallbacks(e),l=s.Tu.get(r);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await __PRIVATE_allocateTargetAndMaybeListen(s,r,i,!0),o}async function __PRIVATE_triggerRemoteStoreListen(e,r){let i=__PRIVATE_ensureWatchCallbacks(e);await __PRIVATE_allocateTargetAndMaybeListen(i,r,!0,!1)}async function __PRIVATE_allocateTargetAndMaybeListen(e,r,i,o){let s;let l=await __PRIVATE_localStoreAllocateTarget(e.localStore,__PRIVATE_queryToTarget(r)),h=l.targetId,d=e.sharedClientState.addLocalQueryTarget(h,i);return o&&(s=await __PRIVATE_initializeViewAndComputeSnapshot(e,r,h,"current"===d,l.resumeToken)),e.isPrimaryClient&&i&&__PRIVATE_remoteStoreListen(e.remoteStore,l),s}async function __PRIVATE_initializeViewAndComputeSnapshot(e,r,i,o,s){e.pu=(r,i,o)=>(async function(e,r,i,o){let s=r.view.ru(i);s.Cs&&(s=await __PRIVATE_localStoreExecuteQuery(e.localStore,r.query,!1).then(({documents:e})=>r.view.ru(e,s)));let l=o&&o.targetChanges.get(r.targetId),h=o&&null!=o.targetMismatches.get(r.targetId),d=r.view.applyChanges(s,e.isPrimaryClient,l,h);return __PRIVATE_updateTrackedLimbos(e,r.targetId,d.au),d.snapshot})(e,r,i,o);let l=await __PRIVATE_localStoreExecuteQuery(e.localStore,r,!0),h=new __PRIVATE_View(r,l.Qs),d=h.ru(l.documents),f=TargetChange.createSynthesizedTargetChangeForCurrentChange(i,o&&"Offline"!==e.onlineState,s),_=h.applyChanges(d,e.isPrimaryClient,f);__PRIVATE_updateTrackedLimbos(e,i,_.au);let g=new __PRIVATE_QueryView(r,i,h);return e.Tu.set(r,g),e.Iu.has(i)?e.Iu.get(i).push(r):e.Iu.set(i,[r]),_.snapshot}async function __PRIVATE_syncEngineUnlisten(e,r,i){let o=e.Tu.get(r),s=e.Iu.get(o.targetId);if(s.length>1)return e.Iu.set(o.targetId,s.filter(e=>!__PRIVATE_queryEquals(e,r))),void e.Tu.delete(r);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(o.targetId),e.sharedClientState.isActiveQueryTarget(o.targetId)||await __PRIVATE_localStoreReleaseTarget(e.localStore,o.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(o.targetId),i&&__PRIVATE_remoteStoreUnlisten(e.remoteStore,o.targetId),__PRIVATE_removeAndCleanupTarget(e,o.targetId)}).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)):(__PRIVATE_removeAndCleanupTarget(e,o.targetId),await __PRIVATE_localStoreReleaseTarget(e.localStore,o.targetId,!0))}async function __PRIVATE_triggerRemoteStoreUnlisten(e,r){let i=e.Tu.get(r),o=e.Iu.get(i.targetId);e.isPrimaryClient&&1===o.length&&(e.sharedClientState.removeLocalQueryTarget(i.targetId),__PRIVATE_remoteStoreUnlisten(e.remoteStore,i.targetId))}async function __PRIVATE_syncEngineWrite(e,r,i){let o=__PRIVATE_syncEngineEnsureWriteCallbacks(e);try{var s;let e;let l=await function(e,r){let i,o;let s=Timestamp.now(),l=r.reduce((e,r)=>e.add(r.key),__PRIVATE_documentKeySet());return e.persistence.runTransaction("Locally write mutations","readwrite",h=>{let d=eS,f=__PRIVATE_documentKeySet();return e.Ns.getEntries(h,l).next(e=>{(d=e).forEach((e,r)=>{r.isValidDocument()||(f=f.add(e))})}).next(()=>e.localDocuments.getOverlayedDocuments(h,d)).next(o=>{i=o;let l=[];for(let e of r){let r=__PRIVATE_mutationExtractBaseValue(e,i.get(e.key).overlayedDocument);null!=r&&l.push(new __PRIVATE_PatchMutation(e.key,r,__PRIVATE_extractFieldMask(r.value.mapValue),Precondition.exists(!0)))}return e.mutationQueue.addMutationBatch(h,s,l,r)}).next(r=>{o=r;let s=r.applyToLocalDocumentSet(i,f);return e.documentOverlayCache.saveOverlays(h,r.batchId,s)})}).then(()=>({batchId:o.batchId,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(i)}))}(o.localStore,r);o.sharedClientState.addPendingMutation(l.batchId),s=l.batchId,(e=o.Vu[o.currentUser.toKey()])||(e=new SortedMap(__PRIVATE_primitiveComparator)),e=e.insert(s,i),o.Vu[o.currentUser.toKey()]=e,await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(o,l.changes),await __PRIVATE_fillWritePipeline(o.remoteStore)}catch(r){let e=__PRIVATE_wrapInUserErrorIfRecoverable(r,"Failed to persist write");i.reject(e)}}async function __PRIVATE_syncEngineApplyRemoteEvent(e,r){try{let i=await __PRIVATE_localStoreApplyRemoteEventToLocalCache(e.localStore,r);r.targetChanges.forEach((r,i)=>{let o=e.Au.get(i);o&&(__PRIVATE_hardAssert(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?__PRIVATE_hardAssert(o.hu,14607):r.removedDocuments.size>0&&(__PRIVATE_hardAssert(o.hu,42227),o.hu=!1))}),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(e,i,r)}catch(e){await __PRIVATE_ignoreIfPrimaryLeaseLoss(e)}}function __PRIVATE_syncEngineApplyOnlineStateChange(e,r,i){var o;if(e.isPrimaryClient&&0===i||!e.isPrimaryClient&&1===i){let i;let s=[];e.Tu.forEach((e,i)=>{let o=i.view.va(r);o.snapshot&&s.push(o.snapshot)}),(o=e.eventManager).onlineState=r,i=!1,o.queries.forEach((e,o)=>{for(let e of o.Sa)e.va(r)&&(i=!0)}),i&&__PRIVATE_raiseSnapshotsInSyncEvent(o),s.length&&e.Pu.H_(s),e.onlineState=r,e.isPrimaryClient&&e.sharedClientState.setOnlineState(r)}}async function __PRIVATE_syncEngineRejectListen(e,r,i){e.sharedClientState.updateQueryState(r,"rejected",i);let o=e.Au.get(r),s=o&&o.key;if(s){let i=new SortedMap(DocumentKey.comparator);i=i.insert(s,MutableDocument.newNoDocument(s,SnapshotVersion.min()));let o=__PRIVATE_documentKeySet().add(s),l=new RemoteEvent(SnapshotVersion.min(),new Map,new SortedMap(__PRIVATE_primitiveComparator),i,o);await __PRIVATE_syncEngineApplyRemoteEvent(e,l),e.du=e.du.remove(s),e.Au.delete(r),__PRIVATE_pumpEnqueuedLimboResolutions(e)}else await __PRIVATE_localStoreReleaseTarget(e.localStore,r,!1).then(()=>__PRIVATE_removeAndCleanupTarget(e,r,i)).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)}async function __PRIVATE_syncEngineApplySuccessfulWrite(e,r){let i=r.batch.batchId;try{let o=await __PRIVATE_localStoreAcknowledgeBatch(e.localStore,r);__PRIVATE_processUserCallback(e,i,null),__PRIVATE_triggerPendingWritesCallbacks(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(e,o)}catch(e){await __PRIVATE_ignoreIfPrimaryLeaseLoss(e)}}async function __PRIVATE_syncEngineRejectFailedWrite(e,r,i){var o;try{let s=await (o=e.localStore).persistence.runTransaction("Reject batch","readwrite-primary",e=>{let i;return o.mutationQueue.lookupMutationBatch(e,r).next(r=>(__PRIVATE_hardAssert(null!==r,37113),i=r.keys(),o.mutationQueue.removeMutationBatch(e,r))).next(()=>o.mutationQueue.performConsistencyCheck(e)).next(()=>o.documentOverlayCache.removeOverlaysForBatchId(e,i,r)).next(()=>o.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i)).next(()=>o.localDocuments.getDocuments(e,i))});__PRIVATE_processUserCallback(e,r,i),__PRIVATE_triggerPendingWritesCallbacks(e,r),e.sharedClientState.updateMutationState(r,"rejected",i),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(e,s)}catch(e){await __PRIVATE_ignoreIfPrimaryLeaseLoss(e)}}function __PRIVATE_triggerPendingWritesCallbacks(e,r){(e.mu.get(r)||[]).forEach(e=>{e.resolve()}),e.mu.delete(r)}function __PRIVATE_processUserCallback(e,r,i){let o=e.Vu[e.currentUser.toKey()];if(o){let s=o.get(r);s&&(i?s.reject(i):s.resolve(),o=o.remove(r)),e.Vu[e.currentUser.toKey()]=o}}function __PRIVATE_removeAndCleanupTarget(e,r,i=null){for(let o of(e.sharedClientState.removeLocalQueryTarget(r),e.Iu.get(r)))e.Tu.delete(o),i&&e.Pu.yu(o,i);e.Iu.delete(r),e.isPrimaryClient&&e.Ru.jr(r).forEach(r=>{e.Ru.containsKey(r)||__PRIVATE_removeLimboTarget(e,r)})}function __PRIVATE_removeLimboTarget(e,r){e.Eu.delete(r.path.canonicalString());let i=e.du.get(r);null!==i&&(__PRIVATE_remoteStoreUnlisten(e.remoteStore,i),e.du=e.du.remove(r),e.Au.delete(i),__PRIVATE_pumpEnqueuedLimboResolutions(e))}function __PRIVATE_updateTrackedLimbos(e,r,i){for(let o of i)o instanceof __PRIVATE_AddedLimboDocument?(e.Ru.addReference(o.key,r),__PRIVATE_trackLimboChange(e,o)):o instanceof __PRIVATE_RemovedLimboDocument?(__PRIVATE_logDebug(e$,"Document no longer in limbo: "+o.key),e.Ru.removeReference(o.key,r),e.Ru.containsKey(o.key)||__PRIVATE_removeLimboTarget(e,o.key)):fail(19791,{wu:o})}function __PRIVATE_trackLimboChange(e,r){let i=r.key,o=i.path.canonicalString();e.du.get(i)||e.Eu.has(o)||(__PRIVATE_logDebug(e$,"New document in limbo: "+i),e.Eu.add(o),__PRIVATE_pumpEnqueuedLimboResolutions(e))}function __PRIVATE_pumpEnqueuedLimboResolutions(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){let r=e.Eu.values().next().value;e.Eu.delete(r);let i=new DocumentKey(ResourcePath.fromString(r)),o=e.fu.next();e.Au.set(o,new LimboResolution(i)),e.du=e.du.insert(i,o),__PRIVATE_remoteStoreListen(e.remoteStore,new TargetData(__PRIVATE_queryToTarget(new __PRIVATE_QueryImpl(i.path)),o,"TargetPurposeLimboResolution",__PRIVATE_ListenSequence.ce))}}async function __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(e,r,i){let o=[],s=[],l=[];e.Tu.isEmpty()||(e.Tu.forEach((h,d)=>{l.push(e.pu(d,r,i).then(r=>{if((r||i)&&e.isPrimaryClient){let o=r?!r.fromCache:i?.targetChanges.get(d.targetId)?.current;e.sharedClientState.updateQueryState(d.targetId,o?"current":"not-current")}if(r){o.push(r);let e=__PRIVATE_LocalViewChanges.As(d.targetId,r);s.push(e)}}))}),await Promise.all(l),e.Pu.H_(o),await async function(e,r){try{await e.persistence.runTransaction("notifyLocalViewChanges","readwrite",i=>PersistencePromise.forEach(r,r=>PersistencePromise.forEach(r.Es,o=>e.persistence.referenceDelegate.addReference(i,r.targetId,o)).next(()=>PersistencePromise.forEach(r.ds,o=>e.persistence.referenceDelegate.removeReference(i,r.targetId,o)))))}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;__PRIVATE_logDebug(eB,"Failed to update sequence numbers: "+e)}for(let i of r){let r=i.targetId;if(!i.fromCache){let i=e.Ms.get(r),o=i.snapshotVersion,s=i.withLastLimboFreeSnapshotVersion(o);e.Ms=e.Ms.insert(r,s)}}}(e.localStore,s))}async function __PRIVATE_syncEngineHandleCredentialChange(e,r){if(!e.currentUser.isEqual(r)){__PRIVATE_logDebug(e$,"User change. New user:",r.toKey());let i=await __PRIVATE_localStoreHandleUserChange(e.localStore,r);e.currentUser=r,e.mu.forEach(e=>{e.forEach(e=>{e.reject(new FirestoreError(ef.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.mu.clear(),e.sharedClientState.handleUserChange(r,i.removedBatchIds,i.addedBatchIds),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(e,i.Ls)}}function __PRIVATE_syncEngineGetRemoteKeysForTarget(e,r){let i=e.Au.get(r);if(i&&i.hu)return __PRIVATE_documentKeySet().add(i.key);{let i=__PRIVATE_documentKeySet(),o=e.Iu.get(r);if(!o)return i;for(let r of o){let o=e.Tu.get(r);i=i.unionWith(o.view.nu)}return i}}function __PRIVATE_ensureWatchCallbacks(e){return e.remoteStore.remoteSyncer.applyRemoteEvent=__PRIVATE_syncEngineApplyRemoteEvent.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=__PRIVATE_syncEngineGetRemoteKeysForTarget.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=__PRIVATE_syncEngineRejectListen.bind(null,e),e.Pu.H_=__PRIVATE_eventManagerOnWatchChange.bind(null,e.eventManager),e.Pu.yu=__PRIVATE_eventManagerOnWatchError.bind(null,e.eventManager),e}function __PRIVATE_syncEngineEnsureWriteCallbacks(e){return e.remoteStore.remoteSyncer.applySuccessfulWrite=__PRIVATE_syncEngineApplySuccessfulWrite.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=__PRIVATE_syncEngineRejectFailedWrite.bind(null,e),e}let __PRIVATE_MemoryOfflineComponentProvider=class __PRIVATE_MemoryOfflineComponentProvider{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=__PRIVATE_newSerializer(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return __PRIVATE_newLocalStore(this.persistence,new __PRIVATE_QueryEngine,e.initialUser,this.serializer)}Cu(e){return new __PRIVATE_MemoryPersistence(__PRIVATE_MemoryEagerDelegate.mi,this.serializer)}Du(e){return new __PRIVATE_MemorySharedClientState}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};__PRIVATE_MemoryOfflineComponentProvider.provider={build:()=>new __PRIVATE_MemoryOfflineComponentProvider};let __PRIVATE_LruGcMemoryOfflineComponentProvider=class __PRIVATE_LruGcMemoryOfflineComponentProvider extends __PRIVATE_MemoryOfflineComponentProvider{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){__PRIVATE_hardAssert(this.persistence.referenceDelegate instanceof __PRIVATE_MemoryLruDelegate,46915);let i=this.persistence.referenceDelegate.garbageCollector;return new __PRIVATE_LruScheduler(i,e.asyncQueue,r)}Cu(e){let r=void 0!==this.cacheSizeBytes?LruParams.withCacheSize(this.cacheSizeBytes):LruParams.DEFAULT;return new __PRIVATE_MemoryPersistence(e=>__PRIVATE_MemoryLruDelegate.mi(e,r),this.serializer)}};let OnlineComponentProvider=class OnlineComponentProvider{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=__PRIVATE_syncEngineHandleCredentialChange.bind(null,this.syncEngine),await __PRIVATE_remoteStoreApplyPrimaryState(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new __PRIVATE_EventManagerImpl}createDatastore(e){let r=__PRIVATE_newSerializer(e.databaseInfo.databaseId),i=new __PRIVATE_WebChannelConnection(e.databaseInfo);return new __PRIVATE_DatastoreImpl(e.authCredentials,e.appCheckCredentials,i,r)}createRemoteStore(e){var r;return r=this.localStore,new __PRIVATE_RemoteStoreImpl(r,this.datastore,e.asyncQueue,e=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,e,0),__PRIVATE_BrowserConnectivityMonitor.v()?new __PRIVATE_BrowserConnectivityMonitor:new __PRIVATE_NoopConnectivityMonitor)}createSyncEngine(e,r){return function(e,r,i,o,s,l,h){let d=new __PRIVATE_SyncEngineImpl(e,r,i,o,s,l);return h&&(d.gu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(e){__PRIVATE_logDebug(eK,"RemoteStore shutting down."),e.Ea.add(5),await __PRIVATE_disableNetworkInternal(e),e.Aa.shutdown(),e.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}};OnlineComponentProvider.provider={build:()=>new OnlineComponentProvider};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_AsyncObserver=class __PRIVATE_AsyncObserver{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):__PRIVATE_logError("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eG="FirestoreClient";let FirestoreClient=class FirestoreClient{constructor(e,r,i,o,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=i,this.databaseInfo=o,this.user=User.UNAUTHENTICATED,this.clientId=__PRIVATE_AutoId.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,async e=>{__PRIVATE_logDebug(eG,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(i,e=>(__PRIVATE_logDebug(eG,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new __PRIVATE_Deferred;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(i){let r=__PRIVATE_wrapInUserErrorIfRecoverable(i,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function __PRIVATE_setOfflineComponentProvider(e,r){e.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug(eG,"Initializing OfflineComponentProvider");let i=e.configuration;await r.initialize(i);let o=i.initialUser;e.setCredentialChangeListener(async e=>{o.isEqual(e)||(await __PRIVATE_localStoreHandleUserChange(r.localStore,e),o=e)}),r.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=r}async function __PRIVATE_setOnlineComponentProvider(e,r){e.asyncQueue.verifyOperationInProgress();let i=await __PRIVATE_ensureOfflineComponents(e);__PRIVATE_logDebug(eG,"Initializing OnlineComponentProvider"),await r.initialize(i,e.configuration),e.setCredentialChangeListener(e=>__PRIVATE_remoteStoreHandleCredentialChange(r.remoteStore,e)),e.setAppCheckTokenChangeListener((e,i)=>__PRIVATE_remoteStoreHandleCredentialChange(r.remoteStore,i)),e._onlineComponents=r}async function __PRIVATE_ensureOfflineComponents(e){if(!e._offlineComponents){if(e._uninitializedComponentsProvider){__PRIVATE_logDebug(eG,"Using user provided OfflineComponentProvider");try{await __PRIVATE_setOfflineComponentProvider(e,e._uninitializedComponentsProvider._offline)}catch(r){if(!("FirebaseError"===r.name?r.code===ef.FAILED_PRECONDITION||r.code===ef.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code))throw r;__PRIVATE_logWarn("Error using user provided cache. Falling back to memory cache: "+r),await __PRIVATE_setOfflineComponentProvider(e,new __PRIVATE_MemoryOfflineComponentProvider)}}else __PRIVATE_logDebug(eG,"Using default OfflineComponentProvider"),await __PRIVATE_setOfflineComponentProvider(e,new __PRIVATE_LruGcMemoryOfflineComponentProvider(void 0))}return e._offlineComponents}async function __PRIVATE_ensureOnlineComponents(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(__PRIVATE_logDebug(eG,"Using user provided OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(e,e._uninitializedComponentsProvider._online)):(__PRIVATE_logDebug(eG,"Using default OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(e,new OnlineComponentProvider))),e._onlineComponents}function __PRIVATE_getSyncEngine(e){return __PRIVATE_ensureOnlineComponents(e).then(e=>e.syncEngine)}async function __PRIVATE_getEventManager(e){let r=await __PRIVATE_ensureOnlineComponents(e),i=r.eventManager;return i.onListen=__PRIVATE_syncEngineListen.bind(null,r.syncEngine),i.onUnlisten=__PRIVATE_syncEngineUnlisten.bind(null,r.syncEngine),i.onFirstRemoteStoreListen=__PRIVATE_triggerRemoteStoreListen.bind(null,r.syncEngine),i.onLastRemoteStoreUnlisten=__PRIVATE_triggerRemoteStoreUnlisten.bind(null,r.syncEngine),i}function __PRIVATE_firestoreClientGetDocumentViaSnapshotListener(e,r,i={}){let o=new __PRIVATE_Deferred;return e.asyncQueue.enqueueAndForget(async()=>(function(e,r,i,o,s){let l=new __PRIVATE_AsyncObserver({next:d=>{l.Nu(),r.enqueueAndForget(()=>__PRIVATE_eventManagerUnlisten(e,h));let f=d.docs.has(i);!f&&d.fromCache?s.reject(new FirestoreError(ef.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&d.fromCache&&o&&"server"===o.source?s.reject(new FirestoreError(ef.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(d)},error:e=>s.reject(e)}),h=new __PRIVATE_QueryListener(new __PRIVATE_QueryImpl(i.path),l,{includeMetadataChanges:!0,qa:!0});return __PRIVATE_eventManagerListen(e,h)})(await __PRIVATE_getEventManager(e),e.asyncQueue,r,i,o)),o.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_cloneLongPollingOptions(e){let r={};return void 0!==e.timeoutSeconds&&(r.timeoutSeconds=e.timeoutSeconds),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eQ=new Map,eJ="firestore.googleapis.com";let FirestoreSettingsImpl=class FirestoreSettingsImpl{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new FirestoreError(ef.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=eJ,this.ssl=!0}else this.host=e.host,this.ssl=e.ssl??!0;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new FirestoreError(ef.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}__PRIVATE_validateIsNotUsedTogether("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=__PRIVATE_cloneLongPollingOptions(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new FirestoreError(ef.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new FirestoreError(ef.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new FirestoreError(ef.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){var r,i;return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(r=this.experimentalLongPollingOptions,i=e.experimentalLongPollingOptions,r.timeoutSeconds===i.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};let Firestore$1=class Firestore$1{constructor(e,r,i,o){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FirestoreSettingsImpl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new FirestoreError(ef.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new FirestoreError(ef.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FirestoreSettingsImpl(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new __PRIVATE_EmptyAuthCredentialsProvider;switch(e.type){case"firstParty":return new __PRIVATE_FirstPartyAuthCredentialsProvider(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new FirestoreError(ef.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let r=eQ.get(e);r&&(__PRIVATE_logDebug("ComponentProvider","Removing Datastore"),eQ.delete(e),r.terminate())}(this),Promise.resolve()}};function connectFirestoreEmulator(e,r,i,o={}){e=__PRIVATE_cast(e,Firestore$1);let s=(0,en.Xx)(r),l=e._getSettings(),h={...l,emulatorOptions:e._getEmulatorOptions()},d=`${r}:${i}`;s&&((0,en.Uo)(`https://${d}`),(0,en.dp)("Firestore",!0)),l.host!==eJ&&l.host!==d&&__PRIVATE_logWarn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let f={...l,host:d,ssl:s,emulatorOptions:o};if(!(0,en.vZ)(f,h)&&(e._setSettings(f),o.mockUserToken)){let r,i;if("string"==typeof o.mockUserToken)r=o.mockUserToken,i=User.MOCK_USER;else{r=(0,en.Sg)(o.mockUserToken,e._app?.options.projectId);let s=o.mockUserToken.sub||o.mockUserToken.user_id;if(!s)throw new FirestoreError(ef.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");i=new User(s)}e._authCredentials=new __PRIVATE_EmulatorAuthCredentialsProvider(new __PRIVATE_OAuthToken(r,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Query=class Query{constructor(e,r,i){this.converter=r,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Query(this.firestore,e,this._query)}};let DocumentReference=class DocumentReference{constructor(e,r,i){this.converter=r,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new CollectionReference(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new DocumentReference(this.firestore,e,this._key)}toJSON(){return{type:DocumentReference._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,i){if(__PRIVATE_validateJSON(r,DocumentReference._jsonSchema))return new DocumentReference(e,i||null,new DocumentKey(ResourcePath.fromString(r.referencePath)))}};DocumentReference._jsonSchemaVersion="firestore/documentReference/1.0",DocumentReference._jsonSchema={type:property("string",DocumentReference._jsonSchemaVersion),referencePath:property("string")};let CollectionReference=class CollectionReference extends Query{constructor(e,r,i){super(e,r,new __PRIVATE_QueryImpl(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new DocumentReference(this.firestore,null,new DocumentKey(e))}withConverter(e){return new CollectionReference(this.firestore,e,this._path)}};function collection(e,r,...i){if(e=(0,en.m9)(e),__PRIVATE_validateNonEmptyArgument("collection","path",r),e instanceof Firestore$1){let o=ResourcePath.fromString(r,...i);return __PRIVATE_validateCollectionPath(o),new CollectionReference(e,null,o)}{if(!(e instanceof DocumentReference||e instanceof CollectionReference))throw new FirestoreError(ef.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let o=e._path.child(ResourcePath.fromString(r,...i));return __PRIVATE_validateCollectionPath(o),new CollectionReference(e.firestore,null,o)}}function doc(e,r,...i){if(e=(0,en.m9)(e),1==arguments.length&&(r=__PRIVATE_AutoId.newId()),__PRIVATE_validateNonEmptyArgument("doc","path",r),e instanceof Firestore$1){let o=ResourcePath.fromString(r,...i);return __PRIVATE_validateDocumentPath(o),new DocumentReference(e,null,new DocumentKey(o))}{if(!(e instanceof DocumentReference||e instanceof CollectionReference))throw new FirestoreError(ef.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let o=e._path.child(ResourcePath.fromString(r,...i));return __PRIVATE_validateDocumentPath(o),new DocumentReference(e.firestore,e instanceof CollectionReference?e.converter:null,new DocumentKey(o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eX="AsyncQueue";let __PRIVATE_AsyncQueueImpl=class __PRIVATE_AsyncQueueImpl{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new __PRIVATE_ExponentialBackoff(this,"async_queue_retry"),this._c=()=>{let e=getDocument();e&&__PRIVATE_logDebug(eX,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;let r=getDocument();r&&"function"==typeof r.addEventListener&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let r=getDocument();r&&"function"==typeof r.removeEventListener&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let r=new __PRIVATE_Deferred;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;__PRIVATE_logDebug(eX,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let r=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,__PRIVATE_logError("INTERNAL UNHANDLED ERROR: ",__PRIVATE_getMessageOrStack(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=r,r}enqueueAfterDelay(e,r,i){this.uc(),this.oc.indexOf(e)>-1&&(r=0);let o=DelayedOperation.createAndSchedule(this,e,r,i,e=>this.hc(e));return this.tc.push(o),o}uc(){this.nc&&fail(47125,{Pc:__PRIVATE_getMessageOrStack(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{for(let r of(this.tc.sort((e,r)=>e.targetTimeMs-r.targetTimeMs),this.tc))if(r.skipDelay(),"all"!==e&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){let r=this.tc.indexOf(e);this.tc.splice(r,1)}};function __PRIVATE_getMessageOrStack(e){let r=e.message||"";return e.stack&&(r=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),r}let Firestore=class Firestore extends Firestore$1{constructor(e,r,i,o){super(e,r,i,o),this.type="firestore",this._queue=new __PRIVATE_AsyncQueueImpl,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new __PRIVATE_AsyncQueueImpl(e),this._firestoreClient=void 0,await e}}};function getFirestore(e,r){let i="object"==typeof e?e:(0,$.Mq)(),o=(0,$.qX)(i,"firestore").getImmediate({identifier:"string"==typeof e?e:r||eT});if(!o._initialized){let e=(0,en.P0)("firestore");e&&connectFirestoreEmulator(o,...e)}return o}function ensureFirestoreConfigured(e){if(e._terminated)throw new FirestoreError(ef.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||__PRIVATE_configureFirestore(e),e._firestoreClient}function __PRIVATE_configureFirestore(e){var r;let i=e._freezeSettings(),o=(r=e._databaseId,new DatabaseInfo(r,e._app?.options.appId||"",e._persistenceKey,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,__PRIVATE_cloneLongPollingOptions(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator));e._componentsProvider||i.localCache?._offlineComponentProvider&&i.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new FirestoreClient(e._authCredentials,e._appCheckCredentials,e._queue,o,e._componentsProvider&&function(e){let r=e?._online.build();return{_offline:e?._offline.build(r),_online:r}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bytes=class Bytes{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bytes(ByteString.fromBase64String(e))}catch(e){throw new FirestoreError(ef.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Bytes(ByteString.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Bytes._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(__PRIVATE_validateJSON(e,Bytes._jsonSchema))return Bytes.fromBase64String(e.bytes)}};Bytes._jsonSchemaVersion="firestore/bytes/1.0",Bytes._jsonSchema={type:property("string",Bytes._jsonSchemaVersion),bytes:property("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FieldPath=class FieldPath{constructor(...e){for(let r=0;r<e.length;++r)if(0===e[r].length)throw new FirestoreError(ef.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new FieldPath$1(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FieldValue=class FieldValue{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GeoPoint=class GeoPoint{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new FirestoreError(ef.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new FirestoreError(ef.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return __PRIVATE_primitiveComparator(this._lat,e._lat)||__PRIVATE_primitiveComparator(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:GeoPoint._jsonSchemaVersion}}static fromJSON(e){if(__PRIVATE_validateJSON(e,GeoPoint._jsonSchema))return new GeoPoint(e.latitude,e.longitude)}};GeoPoint._jsonSchemaVersion="firestore/geoPoint/1.0",GeoPoint._jsonSchema={type:property("string",GeoPoint._jsonSchemaVersion),latitude:property("number"),longitude:property("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VectorValue=class VectorValue{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,r){if(e.length!==r.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:VectorValue._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(__PRIVATE_validateJSON(e,VectorValue._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new VectorValue(e.vectorValues);throw new FirestoreError(ef.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};VectorValue._jsonSchemaVersion="firestore/vectorValue/1.0",VectorValue._jsonSchema={type:property("string",VectorValue._jsonSchemaVersion),vectorValues:property("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eY=/^__.*__$/;let ParsedSetData=class ParsedSetData{constructor(e,r,i){this.data=e,this.fieldMask=r,this.fieldTransforms=i}toMutation(e,r){return null!==this.fieldMask?new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,r,this.fieldTransforms):new __PRIVATE_SetMutation(e,this.data,r,this.fieldTransforms)}};function __PRIVATE_isWrite(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fail(40011,{Ac:e})}}let __PRIVATE_ParseContextImpl=class __PRIVATE_ParseContextImpl{constructor(e,r,i,o,s,l){this.settings=e,this.databaseId=r,this.serializer=i,this.ignoreUndefinedProperties=o,void 0===s&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new __PRIVATE_ParseContextImpl({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let r=this.path?.child(e),i=this.Vc({path:r,fc:!1});return i.gc(e),i}yc(e){let r=this.path?.child(e),i=this.Vc({path:r,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return __PRIVATE_createError(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(r=>e.isPrefixOf(r))||void 0!==this.fieldTransforms.find(r=>e.isPrefixOf(r.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(__PRIVATE_isWrite(this.Ac)&&eY.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}};let __PRIVATE_UserDataReader=class __PRIVATE_UserDataReader{constructor(e,r,i){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=i||__PRIVATE_newSerializer(e)}Cc(e,r,i,o=!1){return new __PRIVATE_ParseContextImpl({Ac:e,methodName:r,Dc:i,path:FieldPath$1.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function __PRIVATE_newUserDataReader(e){let r=e._freezeSettings(),i=__PRIVATE_newSerializer(e._databaseId);return new __PRIVATE_UserDataReader(e._databaseId,!!r.ignoreUndefinedProperties,i)}function __PRIVATE_parseSetData(e,r,i,o,s,l={}){let h,d;let f=e.Cc(l.merge||l.mergeFields?2:0,r,i,s);__PRIVATE_validatePlainObject("Data must be an object, but it was:",f,o);let _=__PRIVATE_parseObject(o,f);if(l.merge)h=new FieldMask(f.fieldMask),d=f.fieldTransforms;else if(l.mergeFields){let e=[];for(let o of l.mergeFields){let s=__PRIVATE_fieldPathFromArgument$1(r,o,i);if(!f.contains(s))throw new FirestoreError(ef.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);__PRIVATE_fieldMaskContains(e,s)||e.push(s)}h=new FieldMask(e),d=f.fieldTransforms.filter(e=>h.covers(e.field))}else h=null,d=f.fieldTransforms;return new ParsedSetData(new ObjectValue(_),h,d)}let __PRIVATE_ServerTimestampFieldValueImpl=class __PRIVATE_ServerTimestampFieldValueImpl extends FieldValue{_toFieldTransform(e){return new FieldTransform(e.path,new __PRIVATE_ServerTimestampTransform)}isEqual(e){return e instanceof __PRIVATE_ServerTimestampFieldValueImpl}};function __PRIVATE_parseData(e,r){if(__PRIVATE_looksLikeJsonObject(e=(0,en.m9)(e)))return __PRIVATE_validatePlainObject("Unsupported field value:",r,e),__PRIVATE_parseObject(e,r);if(e instanceof FieldValue)return function(e,r){if(!__PRIVATE_isWrite(r.Ac))throw r.Sc(`${e._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${e._methodName}() is not currently supported inside arrays`);let i=e._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(e,r),null;if(void 0===e&&r.ignoreUndefinedProperties)return null;if(r.path&&r.fieldMask.push(r.path),e instanceof Array){if(r.settings.fc&&4!==r.Ac)throw r.Sc("Nested arrays are not supported");return function(e,r){let i=[],o=0;for(let s of e){let e=__PRIVATE_parseData(s,r.wc(o));null==e&&(e={nullValue:"NULL_VALUE"}),i.push(e),o++}return{arrayValue:{values:i}}}(e,r)}return function(e,r){if(null===(e=(0,en.m9)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return toNumber(r.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let i=Timestamp.fromDate(e);return{timestampValue:toTimestamp(r.serializer,i)}}if(e instanceof Timestamp){let i=new Timestamp(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:toTimestamp(r.serializer,i)}}if(e instanceof GeoPoint)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Bytes)return{bytesValue:__PRIVATE_toBytes(r.serializer,e._byteString)};if(e instanceof DocumentReference){let i=r.databaseId,o=e.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:__PRIVATE_toResourceName(e.firestore._databaseId||r.databaseId,e._key.path)}}if(e instanceof VectorValue)return function(e,r){let i={fields:{[ev]:{stringValue:eR},[ew]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw r.Sc("VectorValues must only contain numeric values.");return __PRIVATE_toDouble(r.serializer,e)})}}}};return{mapValue:i}}(e,r);throw r.Sc(`Unsupported field value: ${__PRIVATE_valueDescription(e)}`)}(e,r)}function __PRIVATE_parseObject(e,r){let i={};return isEmpty(e)?r.path&&r.path.length>0&&r.fieldMask.push(r.path):forEach(e,(e,o)=>{let s=__PRIVATE_parseData(o,r.mc(e));null!=s&&(i[e]=s)}),{mapValue:{fields:i}}}function __PRIVATE_looksLikeJsonObject(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Timestamp||e instanceof GeoPoint||e instanceof Bytes||e instanceof DocumentReference||e instanceof FieldValue||e instanceof VectorValue)}function __PRIVATE_validatePlainObject(e,r,i){if(!__PRIVATE_looksLikeJsonObject(i)||!__PRIVATE_isPlainObject(i)){let o=__PRIVATE_valueDescription(i);throw"an object"===o?r.Sc(e+" a custom object"):r.Sc(e+" "+o)}}function __PRIVATE_fieldPathFromArgument$1(e,r,i){if((r=(0,en.m9)(r))instanceof FieldPath)return r._internalPath;if("string"==typeof r)return __PRIVATE_fieldPathFromDotSeparatedString(e,r);throw __PRIVATE_createError("Field path arguments must be of type string or ",e,!1,void 0,i)}let eZ=RegExp("[~\\*/\\[\\]]");function __PRIVATE_fieldPathFromDotSeparatedString(e,r,i){if(r.search(eZ)>=0)throw __PRIVATE_createError(`Invalid field path (${r}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,i);try{return new FieldPath(...r.split("."))._internalPath}catch(o){throw __PRIVATE_createError(`Invalid field path (${r}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,i)}}function __PRIVATE_createError(e,r,i,o,s){let l=o&&!o.isEmpty(),h=void 0!==s,d=`Function ${r}() called with invalid data`;i&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(l||h)&&(f+=" (found",l&&(f+=` in field ${o}`),h&&(f+=` in document ${s}`),f+=")"),new FirestoreError(ef.INVALID_ARGUMENT,d+e+f)}function __PRIVATE_fieldMaskContains(e,r){return e.some(e=>e.isEqual(r))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DocumentSnapshot$1=class DocumentSnapshot$1{constructor(e,r,i,o,s){this._firestore=e,this._userDataWriter=r,this._key=i,this._document=o,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new DocumentReference(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){let e=new QueryDocumentSnapshot$1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let r=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r)}}};let QueryDocumentSnapshot$1=class QueryDocumentSnapshot$1 extends DocumentSnapshot$1{data(){return super.data()}};function __PRIVATE_fieldPathFromArgument(e,r){return"string"==typeof r?__PRIVATE_fieldPathFromDotSeparatedString(e,r):r instanceof FieldPath?r._internalPath:r._delegate._internalPath}let AbstractUserDataWriter=class AbstractUserDataWriter{convertValue(e,r="none"){switch(__PRIVATE_typeOrder(e)){case 0:return null;case 1:return e.booleanValue;case 2:return __PRIVATE_normalizeNumber(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(__PRIVATE_normalizeByteString(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw fail(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){let i={};return forEach(e,(e,o)=>{i[e]=this.convertValue(o,r)}),i}convertVectorValue(e){let r=e.fields?.[ew].arrayValue?.values?.map(e=>__PRIVATE_normalizeNumber(e.doubleValue));return new VectorValue(r)}convertGeoPoint(e){return new GeoPoint(__PRIVATE_normalizeNumber(e.latitude),__PRIVATE_normalizeNumber(e.longitude))}convertArray(e,r){return(e.values||[]).map(e=>this.convertValue(e,r))}convertServerTimestamp(e,r){switch(r){case"previous":let i=__PRIVATE_getPreviousValue(e);return null==i?null:this.convertValue(i,r);case"estimate":return this.convertTimestamp(__PRIVATE_getLocalWriteTime(e));default:return null}}convertTimestamp(e){let r=__PRIVATE_normalizeTimestamp(e);return new Timestamp(r.seconds,r.nanos)}convertDocumentKey(e,r){let i=ResourcePath.fromString(e);__PRIVATE_hardAssert(__PRIVATE_isValidResourceName(i),9688,{name:e});let o=new DatabaseId(i.get(1),i.get(3)),s=new DocumentKey(i.popFirst(5));return o.isEqual(r)||__PRIVATE_logError(`Document ${s} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_applyFirestoreDataConverter(e,r,i){return e?i&&(i.merge||i.mergeFields)?e.toFirestore(r,i):e.toFirestore(r):r}let SnapshotMetadata=class SnapshotMetadata{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}};let DocumentSnapshot=class DocumentSnapshot extends DocumentSnapshot$1{constructor(e,r,i,o,s,l){super(e,r,i,o,l),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let r=new QueryDocumentSnapshot(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){let i=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(null!==i)return this._userDataWriter.convertValue(i,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new FirestoreError(ef.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,r={};return r.type=DocumentSnapshot._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()&&(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED")),r}};DocumentSnapshot._jsonSchemaVersion="firestore/documentSnapshot/1.0",DocumentSnapshot._jsonSchema={type:property("string",DocumentSnapshot._jsonSchemaVersion),bundleSource:property("string","DocumentSnapshot"),bundleName:property("string"),bundle:property("string")};let QueryDocumentSnapshot=class QueryDocumentSnapshot extends DocumentSnapshot{data(e={}){return super.data(e)}};let QuerySnapshot=class QuerySnapshot{constructor(e,r,i,o){this._firestore=e,this._userDataWriter=r,this._snapshot=o,this.metadata=new SnapshotMetadata(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){let e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,r){this._snapshot.docs.forEach(i=>{e.call(r,new QueryDocumentSnapshot(this._firestore,this._userDataWriter,i.key,i,new SnapshotMetadata(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(ef.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(e,r){if(e._snapshot.oldDocs.isEmpty()){let r=0;return e._snapshot.docChanges.map(i=>{let o=new QueryDocumentSnapshot(e._firestore,e._userDataWriter,i.doc.key,i.doc,new SnapshotMetadata(e._snapshot.mutatedKeys.has(i.doc.key),e._snapshot.fromCache),e.query.converter);return i.doc,{type:"added",doc:o,oldIndex:-1,newIndex:r++}})}{let i=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>r||3!==e.type).map(r=>{let o=new QueryDocumentSnapshot(e._firestore,e._userDataWriter,r.doc.key,r.doc,new SnapshotMetadata(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter),s=-1,l=-1;return 0!==r.type&&(s=i.indexOf(r.doc.key),i=i.delete(r.doc.key)),1!==r.type&&(l=(i=i.add(r.doc)).indexOf(r.doc.key)),{type:__PRIVATE_resultChangeType(r.type),doc:o,oldIndex:s,newIndex:l}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new FirestoreError(ef.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=QuerySnapshot._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=__PRIVATE_AutoId.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let r=[],i=[],o=[];return this.docs.forEach(e=>{null!==e._document&&(r.push(e._document),i.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),o.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function __PRIVATE_resultChangeType(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fail(61501,{type:e})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getDoc(e){e=__PRIVATE_cast(e,DocumentReference);let r=__PRIVATE_cast(e.firestore,Firestore);return __PRIVATE_firestoreClientGetDocumentViaSnapshotListener(ensureFirestoreConfigured(r),e._key).then(i=>__PRIVATE_convertToDocSnapshot(r,e,i))}QuerySnapshot._jsonSchemaVersion="firestore/querySnapshot/1.0",QuerySnapshot._jsonSchema={type:property("string",QuerySnapshot._jsonSchemaVersion),bundleSource:property("string","QuerySnapshot"),bundleName:property("string"),bundle:property("string")};let __PRIVATE_ExpUserDataWriter=class __PRIVATE_ExpUserDataWriter extends AbstractUserDataWriter{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bytes(e)}convertReference(e){let r=this.convertDocumentKey(e,this.firestore._databaseId);return new DocumentReference(this.firestore,null,r)}};function setDoc(e,r,i){e=__PRIVATE_cast(e,DocumentReference);let o=__PRIVATE_cast(e.firestore,Firestore),s=__PRIVATE_applyFirestoreDataConverter(e.converter,r,i);return executeWrite(o,[__PRIVATE_parseSetData(__PRIVATE_newUserDataReader(o),"setDoc",e._key,s,null!==e.converter,i).toMutation(e._key,Precondition.none())])}function addDoc(e,r){let i=__PRIVATE_cast(e.firestore,Firestore),o=doc(e),s=__PRIVATE_applyFirestoreDataConverter(e.converter,r);return executeWrite(i,[__PRIVATE_parseSetData(__PRIVATE_newUserDataReader(e.firestore),"addDoc",o._key,s,null!==e.converter,{}).toMutation(o._key,Precondition.exists(!1))]).then(()=>o)}function executeWrite(e,r){return function(e,r){let i=new __PRIVATE_Deferred;return e.asyncQueue.enqueueAndForget(async()=>__PRIVATE_syncEngineWrite(await __PRIVATE_getSyncEngine(e),r,i)),i.promise}(ensureFirestoreConfigured(e),r)}function __PRIVATE_convertToDocSnapshot(e,r,i){let o=i.docs.get(r._key),s=new __PRIVATE_ExpUserDataWriter(e);return new DocumentSnapshot(e,s,r._key,o,new SnapshotMetadata(i.hasPendingWrites,i.fromCache),r.converter)}function serverTimestamp(){return new __PRIVATE_ServerTimestampFieldValueImpl("serverTimestamp")}new WeakMap,function(e=!0){eh=$.Jn,(0,$.Xd)(new ee.wA("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),l=new Firestore(new __PRIVATE_FirebaseAuthCredentialsProvider(r.getProvider("auth-internal")),new __PRIVATE_FirebaseAppCheckTokenProvider(s,r.getProvider("app-check-internal")),function(e,r){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new FirestoreError(ef.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new DatabaseId(e.options.projectId,r)}(s,i),s);return o={useFetchStreams:e,...o},l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),(0,$.KN)(el,eu,void 0),(0,$.KN)(el,eu,"esm2020")}()},8885:function(e,r,i){"use strict";i.d(r,{UG:function(){return Markdown}});var o={};i.r(o),i.d(o,{boolean:function(){return g},booleanish:function(){return A},commaOrSpaceSeparated:function(){return q},commaSeparated:function(){return j},number:function(){return k},overloadedBoolean:function(){return b},spaceSeparated:function(){return M}});var s={};function stringify(e,r){let i=r||{},o=""===e[e.length-1]?[...e,""]:e;return o.join((i.padRight?" ":"")+","+(!1===i.padLeft?"":" ")).trim()}i.r(s),i.d(s,{attentionMarkers:function(){return tm},contentInitial:function(){return tu},disable:function(){return t_},document:function(){return tl},flow:function(){return th},flowInitial:function(){return tc},insideSpan:function(){return tp},string:function(){return td},text:function(){return tf}});let l=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,h=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,d={};function lib_name(e,r){let i=(r||d).jsx?h:l;return i.test(e)}let f=/[ \t\n\f\r]/g;function whitespace(e){return"object"==typeof e?"text"===e.type&&empty(e.value):empty(e)}function empty(e){return""===e.replace(f,"")}let Schema=class Schema{constructor(e,r,i){this.normal=r,this.property=e,i&&(this.space=i)}};function merge(e,r){let i={},o={};for(let r of e)Object.assign(i,r.property),Object.assign(o,r.normal);return new Schema(i,o,r)}function normalize(e){return e.toLowerCase()}Schema.prototype.normal={},Schema.prototype.property={},Schema.prototype.space=void 0;let Info=class Info{constructor(e,r){this.attribute=r,this.property=e}};Info.prototype.attribute="",Info.prototype.booleanish=!1,Info.prototype.boolean=!1,Info.prototype.commaOrSpaceSeparated=!1,Info.prototype.commaSeparated=!1,Info.prototype.defined=!1,Info.prototype.mustUseProperty=!1,Info.prototype.number=!1,Info.prototype.overloadedBoolean=!1,Info.prototype.property="",Info.prototype.spaceSeparated=!1,Info.prototype.space=void 0;let _=0,g=increment(),A=increment(),b=increment(),k=increment(),M=increment(),j=increment(),q=increment();function increment(){return 2**++_}let $=Object.keys(o);let DefinedInfo=class DefinedInfo extends Info{constructor(e,r,i,s){var l,h;let d=-1;if(super(e,r),s&&(this.space=s),"number"==typeof i)for(;++d<$.length;){let e=$[d];l=$[d],(h=(i&o[e])===o[e])&&(this[l]=h)}}};function create(e){let r={},i={};for(let[o,s]of Object.entries(e.properties)){let l=new DefinedInfo(o,e.transform(e.attributes||{},o),s,e.space);e.mustUseProperty&&e.mustUseProperty.includes(o)&&(l.mustUseProperty=!0),r[o]=l,i[normalize(o)]=o,i[normalize(l.attribute)]=o}return new Schema(r,i,e.space)}DefinedInfo.prototype.defined=!0;let ee=create({properties:{ariaActiveDescendant:null,ariaAtomic:A,ariaAutoComplete:null,ariaBusy:A,ariaChecked:A,ariaColCount:k,ariaColIndex:k,ariaColSpan:k,ariaControls:M,ariaCurrent:null,ariaDescribedBy:M,ariaDetails:null,ariaDisabled:A,ariaDropEffect:M,ariaErrorMessage:null,ariaExpanded:A,ariaFlowTo:M,ariaGrabbed:A,ariaHasPopup:null,ariaHidden:A,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:M,ariaLevel:k,ariaLive:null,ariaModal:A,ariaMultiLine:A,ariaMultiSelectable:A,ariaOrientation:null,ariaOwns:M,ariaPlaceholder:null,ariaPosInSet:k,ariaPressed:A,ariaReadOnly:A,ariaRelevant:null,ariaRequired:A,ariaRoleDescription:M,ariaRowCount:k,ariaRowIndex:k,ariaRowSpan:k,ariaSelected:A,ariaSetSize:k,ariaSort:null,ariaValueMax:k,ariaValueMin:k,ariaValueNow:k,ariaValueText:null,role:null},transform:(e,r)=>"role"===r?r:"aria-"+r.slice(4).toLowerCase()});function caseSensitiveTransform(e,r){return r in e?e[r]:r}function caseInsensitiveTransform(e,r){return caseSensitiveTransform(e,r.toLowerCase())}let et=create({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:j,acceptCharset:M,accessKey:M,action:null,allow:null,allowFullScreen:g,allowPaymentRequest:g,allowUserMedia:g,alt:null,as:null,async:g,autoCapitalize:null,autoComplete:M,autoFocus:g,autoPlay:g,blocking:M,capture:null,charSet:null,checked:g,cite:null,className:M,cols:k,colSpan:null,content:null,contentEditable:A,controls:g,controlsList:M,coords:k|j,crossOrigin:null,data:null,dateTime:null,decoding:null,default:g,defer:g,dir:null,dirName:null,disabled:g,download:b,draggable:A,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:g,formTarget:null,headers:M,height:k,hidden:b,high:k,href:null,hrefLang:null,htmlFor:M,httpEquiv:M,id:null,imageSizes:null,imageSrcSet:null,inert:g,inputMode:null,integrity:null,is:null,isMap:g,itemId:null,itemProp:M,itemRef:M,itemScope:g,itemType:M,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:g,low:k,manifest:null,max:null,maxLength:k,media:null,method:null,min:null,minLength:k,multiple:g,muted:g,name:null,nonce:null,noModule:g,noValidate:g,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:g,optimum:k,pattern:null,ping:M,placeholder:null,playsInline:g,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:g,referrerPolicy:null,rel:M,required:g,reversed:g,rows:k,rowSpan:k,sandbox:M,scope:null,scoped:g,seamless:g,selected:g,shadowRootClonable:g,shadowRootDelegatesFocus:g,shadowRootMode:null,shape:null,size:k,sizes:null,slot:null,span:k,spellCheck:A,src:null,srcDoc:null,srcLang:null,srcSet:null,start:k,step:null,style:null,tabIndex:k,target:null,title:null,translate:null,type:null,typeMustMatch:g,useMap:null,value:A,width:k,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:M,axis:null,background:null,bgColor:null,border:k,borderColor:null,bottomMargin:k,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:g,declare:g,event:null,face:null,frame:null,frameBorder:null,hSpace:k,leftMargin:k,link:null,longDesc:null,lowSrc:null,marginHeight:k,marginWidth:k,noResize:g,noHref:g,noShade:g,noWrap:g,object:null,profile:null,prompt:null,rev:null,rightMargin:k,rules:null,scheme:null,scrolling:A,standby:null,summary:null,text:null,topMargin:k,valueType:null,version:null,vAlign:null,vLink:null,vSpace:k,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:g,disableRemotePlayback:g,prefix:null,property:null,results:k,security:null,unselectable:null},space:"html",transform:caseInsensitiveTransform}),en=create({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:q,accentHeight:k,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:k,amplitude:k,arabicForm:null,ascent:k,attributeName:null,attributeType:null,azimuth:k,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:k,by:null,calcMode:null,capHeight:k,className:M,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:k,diffuseConstant:k,direction:null,display:null,dur:null,divisor:k,dominantBaseline:null,download:g,dx:null,dy:null,edgeMode:null,editable:null,elevation:k,enableBackground:null,end:null,event:null,exponent:k,externalResourcesRequired:null,fill:null,fillOpacity:k,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:j,g2:j,glyphName:j,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:k,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:k,horizOriginX:k,horizOriginY:k,id:null,ideographic:k,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:k,k:k,k1:k,k2:k,k3:k,k4:k,kernelMatrix:q,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:k,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:k,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:k,overlineThickness:k,paintOrder:null,panose1:null,path:null,pathLength:k,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:M,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:k,pointsAtY:k,pointsAtZ:k,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:q,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:q,rev:q,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:q,requiredFeatures:q,requiredFonts:q,requiredFormats:q,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:k,specularExponent:k,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:k,strikethroughThickness:k,string:null,stroke:null,strokeDashArray:q,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:k,strokeOpacity:k,strokeWidth:null,style:null,surfaceScale:k,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:q,tabIndex:k,tableValues:null,target:null,targetX:k,targetY:k,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:q,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:k,underlineThickness:k,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:k,values:null,vAlphabetic:k,vMathematical:k,vectorEffect:null,vHanging:k,vIdeographic:k,version:null,vertAdvY:k,vertOriginX:k,vertOriginY:k,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:k,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:caseSensitiveTransform}),er=create({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform:(e,r)=>"xlink:"+r.slice(5).toLowerCase()}),ei=create({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:caseInsensitiveTransform}),eo=create({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform:(e,r)=>"xml:"+r.slice(3).toLowerCase()}),es=merge([ee,et,er,ei,eo],"html"),ea=merge([ee,en,er,ei,eo],"svg"),el=/[A-Z]/g,eu=/-[a-z]/g,eh=/^data[-\w.:]+$/i;function find(e,r){let i=normalize(r),o=r,s=Info;if(i in e.normal)return e.property[e.normal[i]];if(i.length>4&&"data"===i.slice(0,4)&&eh.test(r)){if("-"===r.charAt(4)){let e=r.slice(5).replace(eu,camelcase);o="data"+e.charAt(0).toUpperCase()+e.slice(1)}else{let e=r.slice(4);if(!eu.test(e)){let i=e.replace(el,kebab);"-"!==i.charAt(0)&&(i="-"+i),r="data"+i}}s=DefinedInfo}return new s(o,r)}function kebab(e){return"-"+e.toLowerCase()}function camelcase(e){return e.charAt(1).toUpperCase()}let ed={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"};function space_separated_tokens_stringify(e){return e.join(" ").trim()}var ef=i(1476);let ep=point("end"),em=point("start");function point(e){return point;function point(r){let i=r&&r.position&&r.position[e]||{};if("number"==typeof i.line&&i.line>0&&"number"==typeof i.column&&i.column>0)return{line:i.line,column:i.column,offset:"number"==typeof i.offset&&i.offset>-1?i.offset:void 0}}}function position(e){let r=em(e),i=ep(e);if(r&&i)return{start:r,end:i}}function stringifyPosition(e){return e&&"object"==typeof e?"position"in e||"type"in e?lib_position(e.position):"start"in e||"end"in e?lib_position(e):"line"in e||"column"in e?lib_point(e):"":""}function lib_point(e){return index(e&&e.line)+":"+index(e&&e.column)}function lib_position(e){return lib_point(e&&e.start)+"-"+lib_point(e&&e.end)}function index(e){return e&&"number"==typeof e?e:1}let VFileMessage=class VFileMessage extends Error{constructor(e,r,i){super(),"string"==typeof r&&(i=r,r=void 0);let o="",s={},l=!1;if(r&&(s="line"in r&&"column"in r?{place:r}:"start"in r&&"end"in r?{place:r}:"type"in r?{ancestors:[r],place:r.position}:{...r}),"string"==typeof e?o=e:!s.cause&&e&&(l=!0,o=e.message,s.cause=e),!s.ruleId&&!s.source&&"string"==typeof i){let e=i.indexOf(":");-1===e?s.ruleId=i:(s.source=i.slice(0,e),s.ruleId=i.slice(e+1))}if(!s.place&&s.ancestors&&s.ancestors){let e=s.ancestors[s.ancestors.length-1];e&&(s.place=e.position)}let h=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=h?h.column:void 0,this.fatal=void 0,this.file="",this.message=o,this.line=h?h.line:void 0,this.name=stringifyPosition(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=l&&s.cause&&"string"==typeof s.cause.stack?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}};VFileMessage.prototype.file="",VFileMessage.prototype.name="",VFileMessage.prototype.reason="",VFileMessage.prototype.message="",VFileMessage.prototype.stack="",VFileMessage.prototype.column=void 0,VFileMessage.prototype.line=void 0,VFileMessage.prototype.ancestors=void 0,VFileMessage.prototype.cause=void 0,VFileMessage.prototype.fatal=void 0,VFileMessage.prototype.place=void 0,VFileMessage.prototype.ruleId=void 0,VFileMessage.prototype.source=void 0;let e_={}.hasOwnProperty,eg=new Map,ey=/[A-Z]/g,eE=new Set(["table","tbody","thead","tfoot","tr"]),eI=new Set(["td","th"]),eT="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function toJsxRuntime(e,r){let i;if(!r||void 0===r.Fragment)throw TypeError("Expected `Fragment` in options");let o=r.filePath||void 0;if(r.development){if("function"!=typeof r.jsxDEV)throw TypeError("Expected `jsxDEV` in options when `development: true`");i=developmentCreate(o,r.jsxDEV)}else{if("function"!=typeof r.jsx)throw TypeError("Expected `jsx` in production options");if("function"!=typeof r.jsxs)throw TypeError("Expected `jsxs` in production options");i=productionCreate(o,r.jsx,r.jsxs)}let s={Fragment:r.Fragment,ancestors:[],components:r.components||{},create:i,elementAttributeNameCase:r.elementAttributeNameCase||"react",evaluater:r.createEvaluater?r.createEvaluater():void 0,filePath:o,ignoreInvalidStyle:r.ignoreInvalidStyle||!1,passKeys:!1!==r.passKeys,passNode:r.passNode||!1,schema:"svg"===r.space?ea:es,stylePropertyNameCase:r.stylePropertyNameCase||"dom",tableCellAlignToStyle:!1!==r.tableCellAlignToStyle},l=one(s,e,void 0);return l&&"string"!=typeof l?l:s.create(e,s.Fragment,{children:l||void 0},void 0)}function one(e,r,i){return"element"===r.type?lib_element(e,r,i):"mdxFlowExpression"===r.type||"mdxTextExpression"===r.type?mdxExpression(e,r):"mdxJsxFlowElement"===r.type||"mdxJsxTextElement"===r.type?mdxJsxElement(e,r,i):"mdxjsEsm"===r.type?mdxEsm(e,r):"root"===r.type?root(e,r,i):"text"===r.type?lib_text(e,r):void 0}function lib_element(e,r,i){let o=e.schema,s=o;"svg"===r.tagName.toLowerCase()&&"html"===o.space&&(s=ea,e.schema=s),e.ancestors.push(r);let l=findComponentFromName(e,r.tagName,!1),h=createElementProps(e,r),d=createChildren(e,r);return eE.has(r.tagName)&&(d=d.filter(function(e){return"string"!=typeof e||!whitespace(e)})),addNode(e,h,l,r),addChildren(h,d),e.ancestors.pop(),e.schema=o,e.create(r,l,h,i)}function mdxExpression(e,r){if(r.data&&r.data.estree&&e.evaluater){let i=r.data.estree,o=i.body[0];return o.type,e.evaluater.evaluateExpression(o.expression)}crashEstree(e,r.position)}function mdxEsm(e,r){if(r.data&&r.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(r.data.estree);crashEstree(e,r.position)}function mdxJsxElement(e,r,i){let o=e.schema,s=o;"svg"===r.name&&"html"===o.space&&(s=ea,e.schema=s),e.ancestors.push(r);let l=null===r.name?e.Fragment:findComponentFromName(e,r.name,!0),h=createJsxElementProps(e,r),d=createChildren(e,r);return addNode(e,h,l,r),addChildren(h,d),e.ancestors.pop(),e.schema=o,e.create(r,l,h,i)}function root(e,r,i){let o={};return addChildren(o,createChildren(e,r)),e.create(r,e.Fragment,o,i)}function lib_text(e,r){return r.value}function addNode(e,r,i,o){"string"!=typeof i&&i!==e.Fragment&&e.passNode&&(r.node=o)}function addChildren(e,r){if(r.length>0){let i=r.length>1?r:r[0];i&&(e.children=i)}}function productionCreate(e,r,i){return create;function create(e,o,s,l){let h=Array.isArray(s.children),d=h?i:r;return l?d(o,s,l):d(o,s)}}function developmentCreate(e,r){return create;function create(i,o,s,l){let h=Array.isArray(s.children),d=em(i);return r(o,s,l,h,{columnNumber:d?d.column-1:void 0,fileName:e,lineNumber:d?d.line:void 0},void 0)}}function createElementProps(e,r){let i,o;let s={};for(o in r.properties)if("children"!==o&&e_.call(r.properties,o)){let l=createProperty(e,o,r.properties[o]);if(l){let[o,h]=l;e.tableCellAlignToStyle&&"align"===o&&"string"==typeof h&&eI.has(r.tagName)?i=h:s[o]=h}}if(i){let r=s.style||(s.style={});r["css"===e.stylePropertyNameCase?"text-align":"textAlign"]=i}return s}function createJsxElementProps(e,r){let i={};for(let o of r.attributes)if("mdxJsxExpressionAttribute"===o.type){if(o.data&&o.data.estree&&e.evaluater){let r=o.data.estree,s=r.body[0];s.type;let l=s.expression;l.type;let h=l.properties[0];h.type,Object.assign(i,e.evaluater.evaluateExpression(h.argument))}else crashEstree(e,r.position)}else{let s;let l=o.name;if(o.value&&"object"==typeof o.value){if(o.value.data&&o.value.data.estree&&e.evaluater){let r=o.value.data.estree,i=r.body[0];i.type,s=e.evaluater.evaluateExpression(i.expression)}else crashEstree(e,r.position)}else s=null===o.value||o.value;i[l]=s}return i}function createChildren(e,r){let i=[],o=-1,s=e.passKeys?new Map:eg;for(;++o<r.children.length;){let l;let h=r.children[o];if(e.passKeys){let e="element"===h.type?h.tagName:"mdxJsxFlowElement"===h.type||"mdxJsxTextElement"===h.type?h.name:void 0;if(e){let r=s.get(e)||0;l=e+"-"+r,s.set(e,r+1)}}let d=one(e,h,l);void 0!==d&&i.push(d)}return i}function createProperty(e,r,i){let o=find(e.schema,r);if(!(null==i||"number"==typeof i&&Number.isNaN(i))){if(Array.isArray(i)&&(i=o.commaSeparated?stringify(i):space_separated_tokens_stringify(i)),"style"===o.property){let r="object"==typeof i?i:parseStyle(e,String(i));return"css"===e.stylePropertyNameCase&&(r=transformStylesToCssCasing(r)),["style",r]}return["react"===e.elementAttributeNameCase&&o.space?ed[o.property]||o.property:o.attribute,i]}}function parseStyle(e,r){try{return ef(r,{reactCompat:!0})}catch(i){if(e.ignoreInvalidStyle)return{};let r=new VFileMessage("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=eT+"#cannot-parse-style-attribute",r}}function findComponentFromName(e,r,i){let o;if(i){if(r.includes(".")){let e;let i=r.split("."),s=-1;for(;++s<i.length;){let r=lib_name(i[s])?{type:"Identifier",name:i[s]}:{type:"Literal",value:i[s]};e=e?{type:"MemberExpression",object:e,property:r,computed:!!(s&&"Literal"===r.type),optional:!1}:r}o=e}else o=lib_name(r)&&!/^[a-z]/.test(r)?{type:"Identifier",name:r}:{type:"Literal",value:r}}else o={type:"Literal",value:r};if("Literal"===o.type){let r=o.value;return e_.call(e.components,r)?e.components[r]:r}if(e.evaluater)return e.evaluater.evaluateExpression(o);crashEstree(e)}function crashEstree(e,r){let i=new VFileMessage("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:r,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw i.file=e.filePath||void 0,i.url=eT+"#cannot-handle-mdx-estrees-without-createevaluater",i}function transformStylesToCssCasing(e){let r;let i={};for(r in e)e_.call(e,r)&&(i[transformStyleToCssCasing(r)]=e[r]);return i}function transformStyleToCssCasing(e){let r=e.replace(ey,toDash);return"ms-"===r.slice(0,3)&&(r="-"+r),r}function toDash(e){return"-"+e.toLowerCase()}let ev={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]};var eA=i(5893);i(7294);let eP={};function lib_toString(e,r){let i=r||eP,o="boolean"!=typeof i.includeImageAlt||i.includeImageAlt,s="boolean"!=typeof i.includeHtml||i.includeHtml;return lib_one(e,o,s)}function lib_one(e,r,i){if(node(e)){if("value"in e)return"html"!==e.type||i?e.value:"";if(r&&"alt"in e&&e.alt)return e.alt;if("children"in e)return lib_all(e.children,r,i)}return Array.isArray(e)?lib_all(e,r,i):""}function lib_all(e,r,i){let o=[],s=-1;for(;++s<e.length;)o[s]=lib_one(e[s],r,i);return o.join("")}function node(e){return!!(e&&"object"==typeof e)}function splice(e,r,i,o){let s;let l=e.length,h=0;if(r=r<0?-r>l?0:l+r:r>l?l:r,i=i>0?i:0,o.length<1e4)(s=Array.from(o)).unshift(r,i),e.splice(...s);else for(i&&e.splice(r,i);h<o.length;)(s=o.slice(h,h+1e4)).unshift(r,0),e.splice(...s),h+=1e4,r+=1e4}function push(e,r){return e.length>0?(splice(e,e.length,0,r),e):r}let SpliceBuffer=class SpliceBuffer{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,r){let i=null==r?Number.POSITIVE_INFINITY:r;return i<this.left.length?this.left.slice(e,i):e>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(e,r,i){let o=r||0;this.setCursor(Math.trunc(e));let s=this.right.splice(this.right.length-o,Number.POSITIVE_INFINITY);return i&&chunkedPush(this.left,i),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),chunkedPush(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),chunkedPush(this.right,e.reverse())}setCursor(e){if(e!==this.left.length&&(!(e>this.left.length)||0!==this.right.length)&&(!(e<0)||0!==this.left.length)){if(e<this.left.length){let r=this.left.splice(e,Number.POSITIVE_INFINITY);chunkedPush(this.right,r.reverse())}else{let r=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);chunkedPush(this.left,r.reverse())}}}};function chunkedPush(e,r){let i=0;if(r.length<1e4)e.push(...r);else for(;i<r.length;)e.push(...r.slice(i,i+1e4)),i+=1e4}function subtokenize(e){let r,i,o,s,l,h,d;let f={},_=-1,g=new SpliceBuffer(e);for(;++_<g.length;){for(;(_ in f);)_=f[_];if(r=g.get(_),_&&"chunkFlow"===r[1].type&&"listItemPrefix"===g.get(_-1)[1].type&&((o=0)<(h=r[1]._tokenizer.events).length&&"lineEndingBlank"===h[o][1].type&&(o+=2),o<h.length&&"content"===h[o][1].type))for(;++o<h.length&&"content"!==h[o][1].type;)"chunkText"===h[o][1].type&&(h[o][1]._isInFirstContentOfListItem=!0,o++);if("enter"===r[0])r[1].contentType&&(Object.assign(f,subcontent(g,_)),_=f[_],d=!0);else if(r[1]._container){for(o=_,i=void 0;o--;)if("lineEnding"===(s=g.get(o))[1].type||"lineEndingBlank"===s[1].type)"enter"===s[0]&&(i&&(g.get(i)[1].type="lineEndingBlank"),s[1].type="lineEnding",i=o);else if("linePrefix"===s[1].type||"listItemIndent"===s[1].type);else break;i&&(r[1].end={...g.get(i)[1].start},(l=g.slice(i,_)).unshift(r),g.splice(i,_-i+1,l))}}return splice(e,0,Number.POSITIVE_INFINITY,g.slice(0)),!d}function subcontent(e,r){let i,o;let s=e.get(r)[1],l=e.get(r)[2],h=r-1,d=[],f=s._tokenizer;!f&&(f=l.parser[s.contentType](s.start),s._contentTypeTextTrailing&&(f._contentTypeTextTrailing=!0));let _=f.events,g=[],A={},b=-1,k=s,M=0,j=0,q=[j];for(;k;){for(;e.get(++h)[1]!==k;);d.push(h),!k._tokenizer&&(i=l.sliceStream(k),k.next||i.push(null),o&&f.defineSkip(k.start),k._isInFirstContentOfListItem&&(f._gfmTasklistFirstContentOfListItem=!0),f.write(i),k._isInFirstContentOfListItem&&(f._gfmTasklistFirstContentOfListItem=void 0)),o=k,k=k.next}for(k=s;++b<_.length;)"exit"===_[b][0]&&"enter"===_[b-1][0]&&_[b][1].type===_[b-1][1].type&&_[b][1].start.line!==_[b][1].end.line&&(j=b+1,q.push(j),k._tokenizer=void 0,k.previous=void 0,k=k.next);for(f.events=[],k?(k._tokenizer=void 0,k.previous=void 0):q.pop(),b=q.length;b--;){let r=_.slice(q[b],q[b+1]),i=d.pop();g.push([i,i+r.length-1]),e.splice(i,2,r)}for(g.reverse(),b=-1;++b<g.length;)A[M+g[b][0]]=M+g[b][1],M+=g[b][1]-g[b][0]-1;return A}function postprocess(e){for(;!subtokenize(e););return e}let eR={}.hasOwnProperty;function combineExtensions(e){let r={},i=-1;for(;++i<e.length;)syntaxExtension(r,e[i]);return r}function syntaxExtension(e,r){let i;for(i in r){let o;let s=eR.call(e,i)?e[i]:void 0,l=s||(e[i]={}),h=r[i];if(h)for(o in h){eR.call(l,o)||(l[o]=[]);let e=h[o];constructs(l[o],Array.isArray(e)?e:e?[e]:[])}}}function constructs(e,r){let i=-1,o=[];for(;++i<r.length;)("after"===r[i].add?e:o).push(r[i]);splice(e,0,0,o)}let ew=regexCheck(/[A-Za-z]/),eS=regexCheck(/[\dA-Za-z]/),ek=regexCheck(/[#-'*+\--9=?A-Z^-~]/);function asciiControl(e){return null!==e&&(e<32||127===e)}let eV=regexCheck(/\d/),eC=regexCheck(/[\dA-Fa-f]/),ex=regexCheck(/[!-/:-@[-`{-~]/);function markdownLineEnding(e){return null!==e&&e<-2}function markdownLineEndingOrSpace(e){return null!==e&&(e<0||32===e)}function markdownSpace(e){return -2===e||-1===e||32===e}let eD=regexCheck(/\p{P}|\p{S}/u),eO=regexCheck(/\s/);function regexCheck(e){return check;function check(r){return null!==r&&r>-1&&e.test(String.fromCharCode(r))}}function factorySpace(e,r,i,o){let s=o?o-1:Number.POSITIVE_INFINITY,l=0;return start;function start(o){return markdownSpace(o)?(e.enter(i),prefix(o)):r(o)}function prefix(o){return markdownSpace(o)&&l++<s?(e.consume(o),prefix):(e.exit(i),r(o))}}let eN={tokenize:initializeContent};function initializeContent(e){let r;let i=e.attempt(this.parser.constructs.contentInitial,afterContentStartConstruct,paragraphInitial);return i;function afterContentStartConstruct(r){if(null===r){e.consume(r);return}return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),factorySpace(e,i,"linePrefix")}function paragraphInitial(r){return e.enter("paragraph"),lineStart(r)}function lineStart(i){let o=e.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=o),r=o,data(i)}function data(r){if(null===r){e.exit("chunkText"),e.exit("paragraph"),e.consume(r);return}return markdownLineEnding(r)?(e.consume(r),e.exit("chunkText"),lineStart):(e.consume(r),data)}}let eL={tokenize:initializeDocument},eM={tokenize:tokenizeContainer};function initializeDocument(e){let r,i,o;let s=this,l=[],h=0;return start;function start(r){if(h<l.length){let i=l[h];return s.containerState=i[1],e.attempt(i[0].continuation,documentContinue,checkNewContainers)(r)}return checkNewContainers(r)}function documentContinue(e){if(h++,s.containerState._closeFlow){let i;s.containerState._closeFlow=void 0,r&&closeFlow();let o=s.events.length,l=o;for(;l--;)if("exit"===s.events[l][0]&&"chunkFlow"===s.events[l][1].type){i=s.events[l][1].end;break}exitContainers(h);let d=o;for(;d<s.events.length;)s.events[d][1].end={...i},d++;return splice(s.events,l+1,0,s.events.slice(o)),s.events.length=d,checkNewContainers(e)}return start(e)}function checkNewContainers(i){if(h===l.length){if(!r)return documentContinued(i);if(r.currentConstruct&&r.currentConstruct.concrete)return flowStart(i);s.interrupt=!!(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return s.containerState={},e.check(eM,thereIsANewContainer,thereIsNoNewContainer)(i)}function thereIsANewContainer(e){return r&&closeFlow(),exitContainers(h),documentContinued(e)}function thereIsNoNewContainer(e){return s.parser.lazy[s.now().line]=h!==l.length,o=s.now().offset,flowStart(e)}function documentContinued(r){return s.containerState={},e.attempt(eM,containerContinue,flowStart)(r)}function containerContinue(e){return h++,l.push([s.currentConstruct,s.containerState]),documentContinued(e)}function flowStart(o){if(null===o){r&&closeFlow(),exitContainers(0),e.consume(o);return}return r=r||s.parser.flow(s.now()),e.enter("chunkFlow",{_tokenizer:r,contentType:"flow",previous:i}),flowContinue(o)}function flowContinue(r){if(null===r){writeToChild(e.exit("chunkFlow"),!0),exitContainers(0),e.consume(r);return}return markdownLineEnding(r)?(e.consume(r),writeToChild(e.exit("chunkFlow")),h=0,s.interrupt=void 0,start):(e.consume(r),flowContinue)}function writeToChild(e,l){let d=s.sliceStream(e);if(l&&d.push(null),e.previous=i,i&&(i.next=e),i=e,r.defineSkip(e.start),r.write(d),s.parser.lazy[e.start.line]){let e,i,l=r.events.length;for(;l--;)if(r.events[l][1].start.offset<o&&(!r.events[l][1].end||r.events[l][1].end.offset>o))return;let d=s.events.length,f=d;for(;f--;)if("exit"===s.events[f][0]&&"chunkFlow"===s.events[f][1].type){if(e){i=s.events[f][1].end;break}e=!0}for(exitContainers(h),l=d;l<s.events.length;)s.events[l][1].end={...i},l++;splice(s.events,f+1,0,s.events.slice(d)),s.events.length=l}}function exitContainers(r){let i=l.length;for(;i-- >r;){let r=l[i];s.containerState=r[1],r[0].exit.call(s,e)}l.length=r}function closeFlow(){r.write([null]),i=void 0,r=void 0,s.containerState._closeFlow=void 0}}function tokenizeContainer(e,r,i){return factorySpace(e,e.attempt(this.parser.constructs.document,r,i),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}let eF={partial:!0,tokenize:tokenizeBlankLine};function tokenizeBlankLine(e,r,i){return start;function start(r){return markdownSpace(r)?factorySpace(e,after,"linePrefix")(r):after(r)}function after(e){return null===e||markdownLineEnding(e)?r(e):i(e)}}let eB={resolve:resolveContent,tokenize:tokenizeContent},eU={partial:!0,tokenize:tokenizeContinuation};function resolveContent(e){return subtokenize(e),e}function tokenizeContent(e,r){let i;return chunkStart;function chunkStart(r){return e.enter("content"),i=e.enter("chunkContent",{contentType:"content"}),chunkInside(r)}function chunkInside(r){return null===r?contentEnd(r):markdownLineEnding(r)?e.check(eU,contentContinue,contentEnd)(r):(e.consume(r),chunkInside)}function contentEnd(i){return e.exit("chunkContent"),e.exit("content"),r(i)}function contentContinue(r){return e.consume(r),e.exit("chunkContent"),i.next=e.enter("chunkContent",{contentType:"content",previous:i}),i=i.next,chunkInside}}function tokenizeContinuation(e,r,i){let o=this;return startLookahead;function startLookahead(r){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),factorySpace(e,prefixed,"linePrefix")}function prefixed(s){if(null===s||markdownLineEnding(s))return i(s);let l=o.events[o.events.length-1];return!o.parser.constructs.disable.null.includes("codeIndented")&&l&&"linePrefix"===l[1].type&&l[2].sliceSerialize(l[1],!0).length>=4?r(s):e.interrupt(o.parser.constructs.flow,i,r)(s)}}let ez={tokenize:initializeFlow};function initializeFlow(e){let r=this,i=e.attempt(eF,atBlankEnding,e.attempt(this.parser.constructs.flowInitial,afterConstruct,factorySpace(e,e.attempt(this.parser.constructs.flow,afterConstruct,e.attempt(eB,afterConstruct)),"linePrefix")));return i;function atBlankEnding(o){if(null===o){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),r.currentConstruct=void 0,i}function afterConstruct(o){if(null===o){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),r.currentConstruct=void 0,i}}let ej={resolveAll:createResolver()},eq=initializeFactory("string"),eW=initializeFactory("text");function initializeFactory(e){return{resolveAll:createResolver("text"===e?resolveAllLineSuffixes:void 0),tokenize:initializeText};function initializeText(r){let i=this,o=this.parser.constructs[e],s=r.attempt(o,start,notText);return start;function start(e){return atBreak(e)?s(e):notText(e)}function notText(e){if(null===e){r.consume(e);return}return r.enter("data"),r.consume(e),data}function data(e){return atBreak(e)?(r.exit("data"),s(e)):(r.consume(e),data)}function atBreak(e){if(null===e)return!0;let r=o[e],s=-1;if(r)for(;++s<r.length;){let e=r[s];if(!e.previous||e.previous.call(i,i.previous))return!0}return!1}}}function createResolver(e){return resolveAllText;function resolveAllText(r,i){let o,s=-1;for(;++s<=r.length;)void 0===o?r[s]&&"data"===r[s][1].type&&(o=s,s++):r[s]&&"data"===r[s][1].type||(s!==o+2&&(r[o][1].end=r[s-1][1].end,r.splice(o+2,s-o-2),s=o+2),o=void 0);return e?e(r,i):r}}function resolveAllLineSuffixes(e,r){let i=0;for(;++i<=e.length;)if((i===e.length||"lineEnding"===e[i][1].type)&&"data"===e[i-1][1].type){let o;let s=e[i-1][1],l=r.sliceStream(s),h=l.length,d=-1,f=0;for(;h--;){let e=l[h];if("string"==typeof e){for(d=e.length;32===e.charCodeAt(d-1);)f++,d--;if(d)break;d=-1}else if(-2===e)o=!0,f++;else if(-1===e);else{h++;break}}if(r._contentTypeTextTrailing&&i===e.length&&(f=0),f){let l={type:i===e.length||o||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:h?d:s.start._bufferIndex+d,_index:s.start._index+h,line:s.end.line,column:s.end.column-f,offset:s.end.offset-f},end:{...s.end}};s.end={...l.start},s.start.offset===s.end.offset?Object.assign(s,l):(e.splice(i,0,["enter",l,r],["exit",l,r]),i+=2)}i++}return e}let eH={name:"thematicBreak",tokenize:tokenizeThematicBreak};function tokenizeThematicBreak(e,r,i){let o,s=0;return start;function start(r){return e.enter("thematicBreak"),before(r)}function before(e){return o=e,atBreak(e)}function atBreak(l){return l===o?(e.enter("thematicBreakSequence"),sequence(l)):s>=3&&(null===l||markdownLineEnding(l))?(e.exit("thematicBreak"),r(l)):i(l)}function sequence(r){return r===o?(e.consume(r),s++,sequence):(e.exit("thematicBreakSequence"),markdownSpace(r)?factorySpace(e,atBreak,"whitespace")(r):atBreak(r))}}let eK={continuation:{tokenize:tokenizeListContinuation},exit:tokenizeListEnd,name:"list",tokenize:tokenizeListStart},e$={partial:!0,tokenize:tokenizeListItemPrefixWhitespace},eG={partial:!0,tokenize:tokenizeIndent};function tokenizeListStart(e,r,i){let o=this,s=o.events[o.events.length-1],l=s&&"linePrefix"===s[1].type?s[2].sliceSerialize(s[1],!0).length:0,h=0;return start;function start(r){let s=o.containerState.type||(42===r||43===r||45===r?"listUnordered":"listOrdered");if("listUnordered"===s?!o.containerState.marker||r===o.containerState.marker:eV(r)){if(o.containerState.type||(o.containerState.type=s,e.enter(s,{_container:!0})),"listUnordered"===s)return e.enter("listItemPrefix"),42===r||45===r?e.check(eH,i,atMarker)(r):atMarker(r);if(!o.interrupt||49===r)return e.enter("listItemPrefix"),e.enter("listItemValue"),inside(r)}return i(r)}function inside(r){return eV(r)&&++h<10?(e.consume(r),inside):(!o.interrupt||h<2)&&(o.containerState.marker?r===o.containerState.marker:41===r||46===r)?(e.exit("listItemValue"),atMarker(r)):i(r)}function atMarker(r){return e.enter("listItemMarker"),e.consume(r),e.exit("listItemMarker"),o.containerState.marker=o.containerState.marker||r,e.check(eF,o.interrupt?i:onBlank,e.attempt(e$,endOfPrefix,otherPrefix))}function onBlank(e){return o.containerState.initialBlankLine=!0,l++,endOfPrefix(e)}function otherPrefix(r){return markdownSpace(r)?(e.enter("listItemPrefixWhitespace"),e.consume(r),e.exit("listItemPrefixWhitespace"),endOfPrefix):i(r)}function endOfPrefix(i){return o.containerState.size=l+o.sliceSerialize(e.exit("listItemPrefix"),!0).length,r(i)}}function tokenizeListContinuation(e,r,i){let o=this;return o.containerState._closeFlow=void 0,e.check(eF,onBlank,notBlank);function onBlank(i){return o.containerState.furtherBlankLines=o.containerState.furtherBlankLines||o.containerState.initialBlankLine,factorySpace(e,r,"listItemIndent",o.containerState.size+1)(i)}function notBlank(i){return o.containerState.furtherBlankLines||!markdownSpace(i)?(o.containerState.furtherBlankLines=void 0,o.containerState.initialBlankLine=void 0,notInCurrentItem(i)):(o.containerState.furtherBlankLines=void 0,o.containerState.initialBlankLine=void 0,e.attempt(eG,r,notInCurrentItem)(i))}function notInCurrentItem(s){return o.containerState._closeFlow=!0,o.interrupt=void 0,factorySpace(e,e.attempt(eK,r,i),"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s)}}function tokenizeIndent(e,r,i){let o=this;return factorySpace(e,afterPrefix,"listItemIndent",o.containerState.size+1);function afterPrefix(e){let s=o.events[o.events.length-1];return s&&"listItemIndent"===s[1].type&&s[2].sliceSerialize(s[1],!0).length===o.containerState.size?r(e):i(e)}}function tokenizeListEnd(e){e.exit(this.containerState.type)}function tokenizeListItemPrefixWhitespace(e,r,i){let o=this;return factorySpace(e,afterPrefix,"listItemPrefixWhitespace",o.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function afterPrefix(e){let s=o.events[o.events.length-1];return!markdownSpace(e)&&s&&"listItemPrefixWhitespace"===s[1].type?r(e):i(e)}}let eQ={continuation:{tokenize:tokenizeBlockQuoteContinuation},exit,name:"blockQuote",tokenize:tokenizeBlockQuoteStart};function tokenizeBlockQuoteStart(e,r,i){let o=this;return start;function start(r){if(62===r){let i=o.containerState;return i.open||(e.enter("blockQuote",{_container:!0}),i.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(r),e.exit("blockQuoteMarker"),after}return i(r)}function after(i){return markdownSpace(i)?(e.enter("blockQuotePrefixWhitespace"),e.consume(i),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),r):(e.exit("blockQuotePrefix"),r(i))}}function tokenizeBlockQuoteContinuation(e,r,i){let o=this;return contStart;function contStart(r){return markdownSpace(r)?factorySpace(e,contBefore,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(r):contBefore(r)}function contBefore(o){return e.attempt(eQ,r,i)(o)}}function exit(e){e.exit("blockQuote")}function factoryDestination(e,r,i,o,s,l,h,d,f){let _=f||Number.POSITIVE_INFINITY,g=0;return start;function start(r){return 60===r?(e.enter(o),e.enter(s),e.enter(l),e.consume(r),e.exit(l),enclosedBefore):null===r||32===r||41===r||asciiControl(r)?i(r):(e.enter(o),e.enter(h),e.enter(d),e.enter("chunkString",{contentType:"string"}),raw(r))}function enclosedBefore(i){return 62===i?(e.enter(l),e.consume(i),e.exit(l),e.exit(s),e.exit(o),r):(e.enter(d),e.enter("chunkString",{contentType:"string"}),enclosed(i))}function enclosed(r){return 62===r?(e.exit("chunkString"),e.exit(d),enclosedBefore(r)):null===r||60===r||markdownLineEnding(r)?i(r):(e.consume(r),92===r?enclosedEscape:enclosed)}function enclosedEscape(r){return 60===r||62===r||92===r?(e.consume(r),enclosed):enclosed(r)}function raw(s){return!g&&(null===s||41===s||markdownLineEndingOrSpace(s))?(e.exit("chunkString"),e.exit(d),e.exit(h),e.exit(o),r(s)):g<_&&40===s?(e.consume(s),g++,raw):41===s?(e.consume(s),g--,raw):null===s||32===s||40===s||asciiControl(s)?i(s):(e.consume(s),92===s?rawEscape:raw)}function rawEscape(r){return 40===r||41===r||92===r?(e.consume(r),raw):raw(r)}}function factoryLabel(e,r,i,o,s,l){let h;let d=this,f=0;return start;function start(r){return e.enter(o),e.enter(s),e.consume(r),e.exit(s),e.enter(l),atBreak}function atBreak(_){return f>999||null===_||91===_||93===_&&!h||94===_&&!f&&"_hiddenFootnoteSupport"in d.parser.constructs?i(_):93===_?(e.exit(l),e.enter(s),e.consume(_),e.exit(s),e.exit(o),r):markdownLineEnding(_)?(e.enter("lineEnding"),e.consume(_),e.exit("lineEnding"),atBreak):(e.enter("chunkString",{contentType:"string"}),labelInside(_))}function labelInside(r){return null===r||91===r||93===r||markdownLineEnding(r)||f++>999?(e.exit("chunkString"),atBreak(r)):(e.consume(r),h||(h=!markdownSpace(r)),92===r?labelEscape:labelInside)}function labelEscape(r){return 91===r||92===r||93===r?(e.consume(r),f++,labelInside):labelInside(r)}}function factoryTitle(e,r,i,o,s,l){let h;return start;function start(r){return 34===r||39===r||40===r?(e.enter(o),e.enter(s),e.consume(r),e.exit(s),h=40===r?41:r,begin):i(r)}function begin(i){return i===h?(e.enter(s),e.consume(i),e.exit(s),e.exit(o),r):(e.enter(l),atBreak(i))}function atBreak(r){return r===h?(e.exit(l),begin(h)):null===r?i(r):markdownLineEnding(r)?(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),factorySpace(e,atBreak,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),inside(r))}function inside(r){return r===h||null===r||markdownLineEnding(r)?(e.exit("chunkString"),atBreak(r)):(e.consume(r),92===r?escape:inside)}function escape(r){return r===h||92===r?(e.consume(r),inside):inside(r)}}function factoryWhitespace(e,r){let i;return start;function start(o){return markdownLineEnding(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),i=!0,start):markdownSpace(o)?factorySpace(e,start,i?"linePrefix":"lineSuffix")(o):r(o)}}function normalizeIdentifier(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}let eJ={partial:!0,tokenize:tokenizeTitleBefore};function tokenizeDefinition(e,r,i){let o;let s=this;return start;function start(r){return e.enter("definition"),before(r)}function before(r){return factoryLabel.call(s,e,labelAfter,i,"definitionLabel","definitionLabelMarker","definitionLabelString")(r)}function labelAfter(r){return(o=normalizeIdentifier(s.sliceSerialize(s.events[s.events.length-1][1]).slice(1,-1)),58===r)?(e.enter("definitionMarker"),e.consume(r),e.exit("definitionMarker"),markerAfter):i(r)}function markerAfter(r){return markdownLineEndingOrSpace(r)?factoryWhitespace(e,destinationBefore)(r):destinationBefore(r)}function destinationBefore(r){return factoryDestination(e,destinationAfter,i,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(r)}function destinationAfter(r){return e.attempt(eJ,after,after)(r)}function after(r){return markdownSpace(r)?factorySpace(e,afterWhitespace,"whitespace")(r):afterWhitespace(r)}function afterWhitespace(l){return null===l||markdownLineEnding(l)?(e.exit("definition"),s.parser.defined.push(o),r(l)):i(l)}}function tokenizeTitleBefore(e,r,i){return titleBefore;function titleBefore(r){return markdownLineEndingOrSpace(r)?factoryWhitespace(e,beforeMarker)(r):i(r)}function beforeMarker(r){return factoryTitle(e,titleAfter,i,"definitionTitle","definitionTitleMarker","definitionTitleString")(r)}function titleAfter(r){return markdownSpace(r)?factorySpace(e,titleAfterOptionalWhitespace,"whitespace")(r):titleAfterOptionalWhitespace(r)}function titleAfterOptionalWhitespace(e){return null===e||markdownLineEnding(e)?r(e):i(e)}}let eX={name:"codeIndented",tokenize:tokenizeCodeIndented},eY={partial:!0,tokenize:tokenizeFurtherStart};function tokenizeCodeIndented(e,r,i){let o=this;return start;function start(r){return e.enter("codeIndented"),factorySpace(e,afterPrefix,"linePrefix",5)(r)}function afterPrefix(e){let r=o.events[o.events.length-1];return r&&"linePrefix"===r[1].type&&r[2].sliceSerialize(r[1],!0).length>=4?atBreak(e):i(e)}function atBreak(r){return null===r?after(r):markdownLineEnding(r)?e.attempt(eY,atBreak,after)(r):(e.enter("codeFlowValue"),inside(r))}function inside(r){return null===r||markdownLineEnding(r)?(e.exit("codeFlowValue"),atBreak(r)):(e.consume(r),inside)}function after(i){return e.exit("codeIndented"),r(i)}}function tokenizeFurtherStart(e,r,i){let o=this;return furtherStart;function furtherStart(r){return o.parser.lazy[o.now().line]?i(r):markdownLineEnding(r)?(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),furtherStart):factorySpace(e,afterPrefix,"linePrefix",5)(r)}function afterPrefix(e){let s=o.events[o.events.length-1];return s&&"linePrefix"===s[1].type&&s[2].sliceSerialize(s[1],!0).length>=4?r(e):markdownLineEnding(e)?furtherStart(e):i(e)}}function resolveHeadingAtx(e,r){let i,o,s=e.length-2,l=3;return"whitespace"===e[3][1].type&&(l+=2),s-2>l&&"whitespace"===e[s][1].type&&(s-=2),"atxHeadingSequence"===e[s][1].type&&(l===s-1||s-4>l&&"whitespace"===e[s-2][1].type)&&(s-=l+1===s?2:4),s>l&&(i={type:"atxHeadingText",start:e[l][1].start,end:e[s][1].end},o={type:"chunkText",start:e[l][1].start,end:e[s][1].end,contentType:"text"},splice(e,l,s-l+1,[["enter",i,r],["enter",o,r],["exit",o,r],["exit",i,r]])),e}function tokenizeHeadingAtx(e,r,i){let o=0;return start;function start(r){return e.enter("atxHeading"),before(r)}function before(r){return e.enter("atxHeadingSequence"),sequenceOpen(r)}function sequenceOpen(r){return 35===r&&o++<6?(e.consume(r),sequenceOpen):null===r||markdownLineEndingOrSpace(r)?(e.exit("atxHeadingSequence"),atBreak(r)):i(r)}function atBreak(i){return 35===i?(e.enter("atxHeadingSequence"),sequenceFurther(i)):null===i||markdownLineEnding(i)?(e.exit("atxHeading"),r(i)):markdownSpace(i)?factorySpace(e,atBreak,"whitespace")(i):(e.enter("atxHeadingText"),data(i))}function sequenceFurther(r){return 35===r?(e.consume(r),sequenceFurther):(e.exit("atxHeadingSequence"),atBreak(r))}function data(r){return null===r||35===r||markdownLineEndingOrSpace(r)?(e.exit("atxHeadingText"),atBreak(r)):(e.consume(r),data)}}let eZ={name:"setextUnderline",resolveTo:resolveToSetextUnderline,tokenize:tokenizeSetextUnderline};function resolveToSetextUnderline(e,r){let i,o,s,l=e.length;for(;l--;)if("enter"===e[l][0]){if("content"===e[l][1].type){i=l;break}"paragraph"===e[l][1].type&&(o=l)}else"content"===e[l][1].type&&e.splice(l,1),s||"definition"!==e[l][1].type||(s=l);let h={type:"setextHeading",start:{...e[i][1].start},end:{...e[e.length-1][1].end}};return e[o][1].type="setextHeadingText",s?(e.splice(o,0,["enter",h,r]),e.splice(s+1,0,["exit",e[i][1],r]),e[i][1].end={...e[s][1].end}):e[i][1]=h,e.push(["exit",h,r]),e}function tokenizeSetextUnderline(e,r,i){let o;let s=this;return start;function start(r){let l,h=s.events.length;for(;h--;)if("lineEnding"!==s.events[h][1].type&&"linePrefix"!==s.events[h][1].type&&"content"!==s.events[h][1].type){l="paragraph"===s.events[h][1].type;break}return!s.parser.lazy[s.now().line]&&(s.interrupt||l)?(e.enter("setextHeadingLine"),o=r,before(r)):i(r)}function before(r){return e.enter("setextHeadingLineSequence"),inside(r)}function inside(r){return r===o?(e.consume(r),inside):(e.exit("setextHeadingLineSequence"),markdownSpace(r)?factorySpace(e,after,"lineSuffix")(r):after(r))}function after(o){return null===o||markdownLineEnding(o)?(e.exit("setextHeadingLine"),r(o)):i(o)}}let e0=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],e1=["pre","script","style","textarea"],e2={partial:!0,tokenize:tokenizeBlankLineBefore},e4={partial:!0,tokenize:tokenizeNonLazyContinuationStart};function resolveToHtmlFlow(e){let r=e.length;for(;r--&&("enter"!==e[r][0]||"htmlFlow"!==e[r][1].type););return r>1&&"linePrefix"===e[r-2][1].type&&(e[r][1].start=e[r-2][1].start,e[r+1][1].start=e[r-2][1].start,e.splice(r-2,2)),e}function tokenizeHtmlFlow(e,r,i){let o,s,l,h,d;let f=this;return start;function start(e){return before(e)}function before(r){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(r),open}function open(h){return 33===h?(e.consume(h),declarationOpen):47===h?(e.consume(h),s=!0,tagCloseStart):63===h?(e.consume(h),o=3,f.interrupt?r:continuationDeclarationInside):ew(h)?(e.consume(h),l=String.fromCharCode(h),tagName):i(h)}function declarationOpen(s){return 45===s?(e.consume(s),o=2,commentOpenInside):91===s?(e.consume(s),o=5,h=0,cdataOpenInside):ew(s)?(e.consume(s),o=4,f.interrupt?r:continuationDeclarationInside):i(s)}function commentOpenInside(o){return 45===o?(e.consume(o),f.interrupt?r:continuationDeclarationInside):i(o)}function cdataOpenInside(o){let s="CDATA[";return o===s.charCodeAt(h++)?(e.consume(o),h===s.length)?f.interrupt?r:continuation:cdataOpenInside:i(o)}function tagCloseStart(r){return ew(r)?(e.consume(r),l=String.fromCharCode(r),tagName):i(r)}function tagName(h){if(null===h||47===h||62===h||markdownLineEndingOrSpace(h)){let d=47===h,_=l.toLowerCase();return!d&&!s&&e1.includes(_)?(o=1,f.interrupt?r(h):continuation(h)):e0.includes(l.toLowerCase())?(o=6,d)?(e.consume(h),basicSelfClosing):f.interrupt?r(h):continuation(h):(o=7,f.interrupt&&!f.parser.lazy[f.now().line]?i(h):s?completeClosingTagAfter(h):completeAttributeNameBefore(h))}return 45===h||eS(h)?(e.consume(h),l+=String.fromCharCode(h),tagName):i(h)}function basicSelfClosing(o){return 62===o?(e.consume(o),f.interrupt?r:continuation):i(o)}function completeClosingTagAfter(r){return markdownSpace(r)?(e.consume(r),completeClosingTagAfter):completeEnd(r)}function completeAttributeNameBefore(r){return 47===r?(e.consume(r),completeEnd):58===r||95===r||ew(r)?(e.consume(r),completeAttributeName):markdownSpace(r)?(e.consume(r),completeAttributeNameBefore):completeEnd(r)}function completeAttributeName(r){return 45===r||46===r||58===r||95===r||eS(r)?(e.consume(r),completeAttributeName):completeAttributeNameAfter(r)}function completeAttributeNameAfter(r){return 61===r?(e.consume(r),completeAttributeValueBefore):markdownSpace(r)?(e.consume(r),completeAttributeNameAfter):completeAttributeNameBefore(r)}function completeAttributeValueBefore(r){return null===r||60===r||61===r||62===r||96===r?i(r):34===r||39===r?(e.consume(r),d=r,completeAttributeValueQuoted):markdownSpace(r)?(e.consume(r),completeAttributeValueBefore):completeAttributeValueUnquoted(r)}function completeAttributeValueQuoted(r){return r===d?(e.consume(r),d=null,completeAttributeValueQuotedAfter):null===r||markdownLineEnding(r)?i(r):(e.consume(r),completeAttributeValueQuoted)}function completeAttributeValueUnquoted(r){return null===r||34===r||39===r||47===r||60===r||61===r||62===r||96===r||markdownLineEndingOrSpace(r)?completeAttributeNameAfter(r):(e.consume(r),completeAttributeValueUnquoted)}function completeAttributeValueQuotedAfter(e){return 47===e||62===e||markdownSpace(e)?completeAttributeNameBefore(e):i(e)}function completeEnd(r){return 62===r?(e.consume(r),completeAfter):i(r)}function completeAfter(r){return null===r||markdownLineEnding(r)?continuation(r):markdownSpace(r)?(e.consume(r),completeAfter):i(r)}function continuation(r){return 45===r&&2===o?(e.consume(r),continuationCommentInside):60===r&&1===o?(e.consume(r),continuationRawTagOpen):62===r&&4===o?(e.consume(r),continuationClose):63===r&&3===o?(e.consume(r),continuationDeclarationInside):93===r&&5===o?(e.consume(r),continuationCdataInside):markdownLineEnding(r)&&(6===o||7===o)?(e.exit("htmlFlowData"),e.check(e2,continuationAfter,continuationStart)(r)):null===r||markdownLineEnding(r)?(e.exit("htmlFlowData"),continuationStart(r)):(e.consume(r),continuation)}function continuationStart(r){return e.check(e4,continuationStartNonLazy,continuationAfter)(r)}function continuationStartNonLazy(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),continuationBefore}function continuationBefore(r){return null===r||markdownLineEnding(r)?continuationStart(r):(e.enter("htmlFlowData"),continuation(r))}function continuationCommentInside(r){return 45===r?(e.consume(r),continuationDeclarationInside):continuation(r)}function continuationRawTagOpen(r){return 47===r?(e.consume(r),l="",continuationRawEndTag):continuation(r)}function continuationRawEndTag(r){if(62===r){let i=l.toLowerCase();return e1.includes(i)?(e.consume(r),continuationClose):continuation(r)}return ew(r)&&l.length<8?(e.consume(r),l+=String.fromCharCode(r),continuationRawEndTag):continuation(r)}function continuationCdataInside(r){return 93===r?(e.consume(r),continuationDeclarationInside):continuation(r)}function continuationDeclarationInside(r){return 62===r?(e.consume(r),continuationClose):45===r&&2===o?(e.consume(r),continuationDeclarationInside):continuation(r)}function continuationClose(r){return null===r||markdownLineEnding(r)?(e.exit("htmlFlowData"),continuationAfter(r)):(e.consume(r),continuationClose)}function continuationAfter(i){return e.exit("htmlFlow"),r(i)}}function tokenizeNonLazyContinuationStart(e,r,i){let o=this;return start;function start(r){return markdownLineEnding(r)?(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),after):i(r)}function after(e){return o.parser.lazy[o.now().line]?i(e):r(e)}}function tokenizeBlankLineBefore(e,r,i){return start;function start(o){return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),e.attempt(eF,r,i)}}let e6={partial:!0,tokenize:tokenizeNonLazyContinuation},e9={concrete:!0,name:"codeFenced",tokenize:tokenizeCodeFenced};function tokenizeCodeFenced(e,r,i){let o;let s=this,l={partial:!0,tokenize:tokenizeCloseStart},h=0,d=0;return start;function start(e){return beforeSequenceOpen(e)}function beforeSequenceOpen(r){let i=s.events[s.events.length-1];return h=i&&"linePrefix"===i[1].type?i[2].sliceSerialize(i[1],!0).length:0,o=r,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),sequenceOpen(r)}function sequenceOpen(r){return r===o?(d++,e.consume(r),sequenceOpen):d<3?i(r):(e.exit("codeFencedFenceSequence"),markdownSpace(r)?factorySpace(e,infoBefore,"whitespace")(r):infoBefore(r))}function infoBefore(i){return null===i||markdownLineEnding(i)?(e.exit("codeFencedFence"),s.interrupt?r(i):e.check(e6,atNonLazyBreak,after)(i)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),info(i))}function info(r){return null===r||markdownLineEnding(r)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),infoBefore(r)):markdownSpace(r)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),factorySpace(e,metaBefore,"whitespace")(r)):96===r&&r===o?i(r):(e.consume(r),info)}function metaBefore(r){return null===r||markdownLineEnding(r)?infoBefore(r):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),meta(r))}function meta(r){return null===r||markdownLineEnding(r)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),infoBefore(r)):96===r&&r===o?i(r):(e.consume(r),meta)}function atNonLazyBreak(r){return e.attempt(l,after,contentBefore)(r)}function contentBefore(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),contentStart}function contentStart(r){return h>0&&markdownSpace(r)?factorySpace(e,beforeContentChunk,"linePrefix",h+1)(r):beforeContentChunk(r)}function beforeContentChunk(r){return null===r||markdownLineEnding(r)?e.check(e6,atNonLazyBreak,after)(r):(e.enter("codeFlowValue"),contentChunk(r))}function contentChunk(r){return null===r||markdownLineEnding(r)?(e.exit("codeFlowValue"),beforeContentChunk(r)):(e.consume(r),contentChunk)}function after(i){return e.exit("codeFenced"),r(i)}function tokenizeCloseStart(e,r,i){let l=0;return startBefore;function startBefore(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),start}function start(r){return e.enter("codeFencedFence"),markdownSpace(r)?factorySpace(e,beforeSequenceClose,"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(r):beforeSequenceClose(r)}function beforeSequenceClose(r){return r===o?(e.enter("codeFencedFenceSequence"),sequenceClose(r)):i(r)}function sequenceClose(r){return r===o?(l++,e.consume(r),sequenceClose):l>=d?(e.exit("codeFencedFenceSequence"),markdownSpace(r)?factorySpace(e,sequenceCloseAfter,"whitespace")(r):sequenceCloseAfter(r)):i(r)}function sequenceCloseAfter(o){return null===o||markdownLineEnding(o)?(e.exit("codeFencedFence"),r(o)):i(o)}}}function tokenizeNonLazyContinuation(e,r,i){let o=this;return start;function start(r){return null===r?i(r):(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),lineStart)}function lineStart(e){return o.parser.lazy[o.now().line]?i(e):r(e)}}let e5=document.createElement("i");function decodeNamedCharacterReference(e){let r="&"+e+";";e5.innerHTML=r;let i=e5.textContent;return(59!==i.charCodeAt(i.length-1)||"semi"===e)&&i!==r&&i}let e3={name:"characterReference",tokenize:tokenizeCharacterReference};function tokenizeCharacterReference(e,r,i){let o,s;let l=this,h=0;return start;function start(r){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(r),e.exit("characterReferenceMarker"),open}function open(r){return 35===r?(e.enter("characterReferenceMarkerNumeric"),e.consume(r),e.exit("characterReferenceMarkerNumeric"),numeric):(e.enter("characterReferenceValue"),o=31,s=eS,value(r))}function numeric(r){return 88===r||120===r?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(r),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,s=eC,value):(e.enter("characterReferenceValue"),o=7,s=eV,value(r))}function value(d){if(59===d&&h){let o=e.exit("characterReferenceValue");return s!==eS||decodeNamedCharacterReference(l.sliceSerialize(o))?(e.enter("characterReferenceMarker"),e.consume(d),e.exit("characterReferenceMarker"),e.exit("characterReference"),r):i(d)}return s(d)&&h++<o?(e.consume(d),value):i(d)}}let e7={name:"characterEscape",tokenize:tokenizeCharacterEscape};function tokenizeCharacterEscape(e,r,i){return start;function start(r){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(r),e.exit("escapeMarker"),inside}function inside(o){return ex(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),r):i(o)}}let e8={name:"lineEnding",tokenize:tokenizeLineEnding};function tokenizeLineEnding(e,r){return start;function start(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),factorySpace(e,r,"linePrefix")}}function resolveAll(e,r,i){let o=[],s=-1;for(;++s<e.length;){let l=e[s].resolveAll;l&&!o.includes(l)&&(r=l(r,i),o.push(l))}return r}let te={name:"labelEnd",resolveAll:resolveAllLabelEnd,resolveTo:resolveToLabelEnd,tokenize:tokenizeLabelEnd},tt={tokenize:tokenizeResource},tn={tokenize:tokenizeReferenceFull},tr={tokenize:tokenizeReferenceCollapsed};function resolveAllLabelEnd(e){let r=-1,i=[];for(;++r<e.length;){let o=e[r][1];if(i.push(e[r]),"labelImage"===o.type||"labelLink"===o.type||"labelEnd"===o.type){let e="labelImage"===o.type?4:2;o.type="data",r+=e}}return e.length!==i.length&&splice(e,0,e.length,i),e}function resolveToLabelEnd(e,r){let i,o,s,l,h=e.length,d=0;for(;h--;)if(i=e[h][1],o){if("link"===i.type||"labelLink"===i.type&&i._inactive)break;"enter"===e[h][0]&&"labelLink"===i.type&&(i._inactive=!0)}else if(s){if("enter"===e[h][0]&&("labelImage"===i.type||"labelLink"===i.type)&&!i._balanced&&(o=h,"labelLink"!==i.type)){d=2;break}}else"labelEnd"===i.type&&(s=h);let f={type:"labelLink"===e[o][1].type?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},_={type:"label",start:{...e[o][1].start},end:{...e[s][1].end}},g={type:"labelText",start:{...e[o+d+2][1].end},end:{...e[s-2][1].start}};return l=push(l=[["enter",f,r],["enter",_,r]],e.slice(o+1,o+d+3)),l=push(l,[["enter",g,r]]),l=push(l,resolveAll(r.parser.constructs.insideSpan.null,e.slice(o+d+4,s-3),r)),l=push(l,[["exit",g,r],e[s-2],e[s-1],["exit",_,r]]),l=push(l,e.slice(s+1)),l=push(l,[["exit",f,r]]),splice(e,o,e.length,l),e}function tokenizeLabelEnd(e,r,i){let o,s;let l=this,h=l.events.length;for(;h--;)if(("labelImage"===l.events[h][1].type||"labelLink"===l.events[h][1].type)&&!l.events[h][1]._balanced){o=l.events[h][1];break}return start;function start(r){return o?o._inactive?labelEndNok(r):(s=l.parser.defined.includes(normalizeIdentifier(l.sliceSerialize({start:o.end,end:l.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(r),e.exit("labelMarker"),e.exit("labelEnd"),after):i(r)}function after(r){return 40===r?e.attempt(tt,labelEndOk,s?labelEndOk:labelEndNok)(r):91===r?e.attempt(tn,labelEndOk,s?referenceNotFull:labelEndNok)(r):s?labelEndOk(r):labelEndNok(r)}function referenceNotFull(r){return e.attempt(tr,labelEndOk,labelEndNok)(r)}function labelEndOk(e){return r(e)}function labelEndNok(e){return o._balanced=!0,i(e)}}function tokenizeResource(e,r,i){return resourceStart;function resourceStart(r){return e.enter("resource"),e.enter("resourceMarker"),e.consume(r),e.exit("resourceMarker"),resourceBefore}function resourceBefore(r){return markdownLineEndingOrSpace(r)?factoryWhitespace(e,resourceOpen)(r):resourceOpen(r)}function resourceOpen(r){return 41===r?resourceEnd(r):factoryDestination(e,resourceDestinationAfter,resourceDestinationMissing,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(r)}function resourceDestinationAfter(r){return markdownLineEndingOrSpace(r)?factoryWhitespace(e,resourceBetween)(r):resourceEnd(r)}function resourceDestinationMissing(e){return i(e)}function resourceBetween(r){return 34===r||39===r||40===r?factoryTitle(e,resourceTitleAfter,i,"resourceTitle","resourceTitleMarker","resourceTitleString")(r):resourceEnd(r)}function resourceTitleAfter(r){return markdownLineEndingOrSpace(r)?factoryWhitespace(e,resourceEnd)(r):resourceEnd(r)}function resourceEnd(o){return 41===o?(e.enter("resourceMarker"),e.consume(o),e.exit("resourceMarker"),e.exit("resource"),r):i(o)}}function tokenizeReferenceFull(e,r,i){let o=this;return referenceFull;function referenceFull(r){return factoryLabel.call(o,e,referenceFullAfter,referenceFullMissing,"reference","referenceMarker","referenceString")(r)}function referenceFullAfter(e){return o.parser.defined.includes(normalizeIdentifier(o.sliceSerialize(o.events[o.events.length-1][1]).slice(1,-1)))?r(e):i(e)}function referenceFullMissing(e){return i(e)}}function tokenizeReferenceCollapsed(e,r,i){return referenceCollapsedStart;function referenceCollapsedStart(r){return e.enter("reference"),e.enter("referenceMarker"),e.consume(r),e.exit("referenceMarker"),referenceCollapsedOpen}function referenceCollapsedOpen(o){return 93===o?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),r):i(o)}}let ti={name:"labelStartImage",resolveAll:te.resolveAll,tokenize:tokenizeLabelStartImage};function tokenizeLabelStartImage(e,r,i){let o=this;return start;function start(r){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(r),e.exit("labelImageMarker"),open}function open(r){return 91===r?(e.enter("labelMarker"),e.consume(r),e.exit("labelMarker"),e.exit("labelImage"),after):i(r)}function after(e){return 94===e&&"_hiddenFootnoteSupport"in o.parser.constructs?i(e):r(e)}}function classifyCharacter(e){return null===e||markdownLineEndingOrSpace(e)||eO(e)?1:eD(e)?2:void 0}let to={name:"attention",resolveAll:resolveAllAttention,tokenize:tokenizeAttention};function resolveAllAttention(e,r){let i,o,s,l,h,d,f,_,g=-1;for(;++g<e.length;)if("enter"===e[g][0]&&"attentionSequence"===e[g][1].type&&e[g][1]._close){for(i=g;i--;)if("exit"===e[i][0]&&"attentionSequence"===e[i][1].type&&e[i][1]._open&&r.sliceSerialize(e[i][1]).charCodeAt(0)===r.sliceSerialize(e[g][1]).charCodeAt(0)){if((e[i][1]._close||e[g][1]._open)&&(e[g][1].end.offset-e[g][1].start.offset)%3&&!((e[i][1].end.offset-e[i][1].start.offset+e[g][1].end.offset-e[g][1].start.offset)%3))continue;d=e[i][1].end.offset-e[i][1].start.offset>1&&e[g][1].end.offset-e[g][1].start.offset>1?2:1;let A={...e[i][1].end},b={...e[g][1].start};movePoint(A,-d),movePoint(b,d),l={type:d>1?"strongSequence":"emphasisSequence",start:A,end:{...e[i][1].end}},h={type:d>1?"strongSequence":"emphasisSequence",start:{...e[g][1].start},end:b},s={type:d>1?"strongText":"emphasisText",start:{...e[i][1].end},end:{...e[g][1].start}},o={type:d>1?"strong":"emphasis",start:{...l.start},end:{...h.end}},e[i][1].end={...l.start},e[g][1].start={...h.end},f=[],e[i][1].end.offset-e[i][1].start.offset&&(f=push(f,[["enter",e[i][1],r],["exit",e[i][1],r]])),f=push(f,[["enter",o,r],["enter",l,r],["exit",l,r],["enter",s,r]]),f=push(f,resolveAll(r.parser.constructs.insideSpan.null,e.slice(i+1,g),r)),f=push(f,[["exit",s,r],["enter",h,r],["exit",h,r],["exit",o,r]]),e[g][1].end.offset-e[g][1].start.offset?(_=2,f=push(f,[["enter",e[g][1],r],["exit",e[g][1],r]])):_=0,splice(e,i-1,g-i+3,f),g=i+f.length-_-2;break}}for(g=-1;++g<e.length;)"attentionSequence"===e[g][1].type&&(e[g][1].type="data");return e}function tokenizeAttention(e,r){let i;let o=this.parser.constructs.attentionMarkers.null,s=this.previous,l=classifyCharacter(s);return start;function start(r){return i=r,e.enter("attentionSequence"),inside(r)}function inside(h){if(h===i)return e.consume(h),inside;let d=e.exit("attentionSequence"),f=classifyCharacter(h),_=!f||2===f&&l||o.includes(h),g=!l||2===l&&f||o.includes(s);return d._open=!!(42===i?_:_&&(l||!g)),d._close=!!(42===i?g:g&&(f||!_)),r(h)}}function movePoint(e,r){e.column+=r,e.offset+=r,e._bufferIndex+=r}function tokenizeAutolink(e,r,i){let o=0;return start;function start(r){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(r),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),open}function open(r){return ew(r)?(e.consume(r),schemeOrEmailAtext):64===r?i(r):emailAtext(r)}function schemeOrEmailAtext(e){return 43===e||45===e||46===e||eS(e)?(o=1,schemeInsideOrEmailAtext(e)):emailAtext(e)}function schemeInsideOrEmailAtext(r){return 58===r?(e.consume(r),o=0,urlInside):(43===r||45===r||46===r||eS(r))&&o++<32?(e.consume(r),schemeInsideOrEmailAtext):(o=0,emailAtext(r))}function urlInside(o){return 62===o?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(o),e.exit("autolinkMarker"),e.exit("autolink"),r):null===o||32===o||60===o||asciiControl(o)?i(o):(e.consume(o),urlInside)}function emailAtext(r){return 64===r?(e.consume(r),emailAtSignOrDot):ek(r)?(e.consume(r),emailAtext):i(r)}function emailAtSignOrDot(e){return eS(e)?emailLabel(e):i(e)}function emailLabel(i){return 46===i?(e.consume(i),o=0,emailAtSignOrDot):62===i?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(i),e.exit("autolinkMarker"),e.exit("autolink"),r):emailValue(i)}function emailValue(r){if((45===r||eS(r))&&o++<63){let i=45===r?emailValue:emailLabel;return e.consume(r),i}return i(r)}}function tokenizeHtmlText(e,r,i){let o,s,l;let h=this;return start;function start(r){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(r),open}function open(r){return 33===r?(e.consume(r),declarationOpen):47===r?(e.consume(r),tagCloseStart):63===r?(e.consume(r),instruction):ew(r)?(e.consume(r),tagOpen):i(r)}function declarationOpen(r){return 45===r?(e.consume(r),commentOpenInside):91===r?(e.consume(r),s=0,cdataOpenInside):ew(r)?(e.consume(r),declaration):i(r)}function commentOpenInside(r){return 45===r?(e.consume(r),commentEnd):i(r)}function comment(r){return null===r?i(r):45===r?(e.consume(r),commentClose):markdownLineEnding(r)?(l=comment,lineEndingBefore(r)):(e.consume(r),comment)}function commentClose(r){return 45===r?(e.consume(r),commentEnd):comment(r)}function commentEnd(e){return 62===e?end(e):45===e?commentClose(e):comment(e)}function cdataOpenInside(r){let o="CDATA[";return r===o.charCodeAt(s++)?(e.consume(r),s===o.length?cdata:cdataOpenInside):i(r)}function cdata(r){return null===r?i(r):93===r?(e.consume(r),cdataClose):markdownLineEnding(r)?(l=cdata,lineEndingBefore(r)):(e.consume(r),cdata)}function cdataClose(r){return 93===r?(e.consume(r),cdataEnd):cdata(r)}function cdataEnd(r){return 62===r?end(r):93===r?(e.consume(r),cdataEnd):cdata(r)}function declaration(r){return null===r||62===r?end(r):markdownLineEnding(r)?(l=declaration,lineEndingBefore(r)):(e.consume(r),declaration)}function instruction(r){return null===r?i(r):63===r?(e.consume(r),instructionClose):markdownLineEnding(r)?(l=instruction,lineEndingBefore(r)):(e.consume(r),instruction)}function instructionClose(e){return 62===e?end(e):instruction(e)}function tagCloseStart(r){return ew(r)?(e.consume(r),tagClose):i(r)}function tagClose(r){return 45===r||eS(r)?(e.consume(r),tagClose):tagCloseBetween(r)}function tagCloseBetween(r){return markdownLineEnding(r)?(l=tagCloseBetween,lineEndingBefore(r)):markdownSpace(r)?(e.consume(r),tagCloseBetween):end(r)}function tagOpen(r){return 45===r||eS(r)?(e.consume(r),tagOpen):47===r||62===r||markdownLineEndingOrSpace(r)?tagOpenBetween(r):i(r)}function tagOpenBetween(r){return 47===r?(e.consume(r),end):58===r||95===r||ew(r)?(e.consume(r),tagOpenAttributeName):markdownLineEnding(r)?(l=tagOpenBetween,lineEndingBefore(r)):markdownSpace(r)?(e.consume(r),tagOpenBetween):end(r)}function tagOpenAttributeName(r){return 45===r||46===r||58===r||95===r||eS(r)?(e.consume(r),tagOpenAttributeName):tagOpenAttributeNameAfter(r)}function tagOpenAttributeNameAfter(r){return 61===r?(e.consume(r),tagOpenAttributeValueBefore):markdownLineEnding(r)?(l=tagOpenAttributeNameAfter,lineEndingBefore(r)):markdownSpace(r)?(e.consume(r),tagOpenAttributeNameAfter):tagOpenBetween(r)}function tagOpenAttributeValueBefore(r){return null===r||60===r||61===r||62===r||96===r?i(r):34===r||39===r?(e.consume(r),o=r,tagOpenAttributeValueQuoted):markdownLineEnding(r)?(l=tagOpenAttributeValueBefore,lineEndingBefore(r)):markdownSpace(r)?(e.consume(r),tagOpenAttributeValueBefore):(e.consume(r),tagOpenAttributeValueUnquoted)}function tagOpenAttributeValueQuoted(r){return r===o?(e.consume(r),o=void 0,tagOpenAttributeValueQuotedAfter):null===r?i(r):markdownLineEnding(r)?(l=tagOpenAttributeValueQuoted,lineEndingBefore(r)):(e.consume(r),tagOpenAttributeValueQuoted)}function tagOpenAttributeValueUnquoted(r){return null===r||34===r||39===r||60===r||61===r||96===r?i(r):47===r||62===r||markdownLineEndingOrSpace(r)?tagOpenBetween(r):(e.consume(r),tagOpenAttributeValueUnquoted)}function tagOpenAttributeValueQuotedAfter(e){return 47===e||62===e||markdownLineEndingOrSpace(e)?tagOpenBetween(e):i(e)}function end(o){return 62===o?(e.consume(o),e.exit("htmlTextData"),e.exit("htmlText"),r):i(o)}function lineEndingBefore(r){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),lineEndingAfter}function lineEndingAfter(r){return markdownSpace(r)?factorySpace(e,lineEndingAfterPrefix,"linePrefix",h.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(r):lineEndingAfterPrefix(r)}function lineEndingAfterPrefix(r){return e.enter("htmlTextData"),l(r)}}let ts={name:"labelStartLink",resolveAll:te.resolveAll,tokenize:tokenizeLabelStartLink};function tokenizeLabelStartLink(e,r,i){let o=this;return start;function start(r){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(r),e.exit("labelMarker"),e.exit("labelLink"),after}function after(e){return 94===e&&"_hiddenFootnoteSupport"in o.parser.constructs?i(e):r(e)}}function tokenizeHardBreakEscape(e,r,i){return start;function start(r){return e.enter("hardBreakEscape"),e.consume(r),after}function after(o){return markdownLineEnding(o)?(e.exit("hardBreakEscape"),r(o)):i(o)}}function resolveCodeText(e){let r,i,o=e.length-4,s=3;if(("lineEnding"===e[3][1].type||"space"===e[s][1].type)&&("lineEnding"===e[o][1].type||"space"===e[o][1].type)){for(r=s;++r<o;)if("codeTextData"===e[r][1].type){e[s][1].type="codeTextPadding",e[o][1].type="codeTextPadding",s+=2,o-=2;break}}for(r=s-1,o++;++r<=o;)void 0===i?r!==o&&"lineEnding"!==e[r][1].type&&(i=r):(r===o||"lineEnding"===e[r][1].type)&&(e[i][1].type="codeTextData",r!==i+2&&(e[i][1].end=e[r-1][1].end,e.splice(i+2,r-i-2),o-=r-i-2,r=i+2),i=void 0);return e}function previous(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}function tokenizeCodeText(e,r,i){let o,s,l=0;return start;function start(r){return e.enter("codeText"),e.enter("codeTextSequence"),sequenceOpen(r)}function sequenceOpen(r){return 96===r?(e.consume(r),l++,sequenceOpen):(e.exit("codeTextSequence"),between(r))}function between(r){return null===r?i(r):32===r?(e.enter("space"),e.consume(r),e.exit("space"),between):96===r?(s=e.enter("codeTextSequence"),o=0,sequenceClose(r)):markdownLineEnding(r)?(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),between):(e.enter("codeTextData"),data(r))}function data(r){return null===r||32===r||96===r||markdownLineEnding(r)?(e.exit("codeTextData"),between(r)):(e.consume(r),data)}function sequenceClose(i){return 96===i?(e.consume(i),o++,sequenceClose):o===l?(e.exit("codeTextSequence"),e.exit("codeText"),r(i)):(s.type="codeTextData",data(i))}}let tl={42:eK,43:eK,45:eK,48:eK,49:eK,50:eK,51:eK,52:eK,53:eK,54:eK,55:eK,56:eK,57:eK,62:eQ},tu={91:{name:"definition",tokenize:tokenizeDefinition}},tc={[-2]:eX,[-1]:eX,32:eX},th={35:{name:"headingAtx",resolve:resolveHeadingAtx,tokenize:tokenizeHeadingAtx},42:eH,45:[eZ,eH],60:{concrete:!0,name:"htmlFlow",resolveTo:resolveToHtmlFlow,tokenize:tokenizeHtmlFlow},61:eZ,95:eH,96:e9,126:e9},td={38:e3,92:e7},tf={[-5]:e8,[-4]:e8,[-3]:e8,33:ti,38:e3,42:to,60:[{name:"autolink",tokenize:tokenizeAutolink},{name:"htmlText",tokenize:tokenizeHtmlText}],91:ts,92:[{name:"hardBreakEscape",tokenize:tokenizeHardBreakEscape},e7],93:te,95:to,96:{name:"codeText",previous,resolve:resolveCodeText,tokenize:tokenizeCodeText}},tp={null:[to,ej]},tm={null:[42,95]},t_={null:[]};function createTokenizer(e,r,i){let o={_bufferIndex:-1,_index:0,line:i&&i.line||1,column:i&&i.column||1,offset:i&&i.offset||0},s={},l=[],h=[],d=[],f={attempt:constructFactory(onsuccessfulconstruct),check:constructFactory(onsuccessfulcheck),consume,enter,exit,interrupt:constructFactory(onsuccessfulcheck,{interrupt:!0})},_={code:null,containerState:{},defineSkip,events:[],now,parser:e,previous:null,sliceSerialize,sliceStream,write},g=r.tokenize.call(_,f);return r.resolveAll&&l.push(r),_;function write(e){return(h=push(h,e),main(),null!==h[h.length-1])?[]:(addResult(r,0),_.events=resolveAll(l,_.events,_),_.events)}function sliceSerialize(e,r){return serializeChunks(sliceStream(e),r)}function sliceStream(e){return sliceChunks(h,e)}function now(){let{_bufferIndex:e,_index:r,line:i,column:s,offset:l}=o;return{_bufferIndex:e,_index:r,line:i,column:s,offset:l}}function defineSkip(e){s[e.line]=e.column,accountForPotentialSkip()}function main(){let e;for(;o._index<h.length;){var r;let i=h[o._index];if("string"==typeof i)for(e=o._index,o._bufferIndex<0&&(o._bufferIndex=0);o._index===e&&o._bufferIndex<i.length;)r=i.charCodeAt(o._bufferIndex),g=g(r);else g=g(i)}}function consume(e){markdownLineEnding(e)?(o.line++,o.column=1,o.offset+=-3===e?2:1,accountForPotentialSkip()):-1!==e&&(o.column++,o.offset++),o._bufferIndex<0?o._index++:(o._bufferIndex++,o._bufferIndex===h[o._index].length&&(o._bufferIndex=-1,o._index++)),_.previous=e}function enter(e,r){let i=r||{};return i.type=e,i.start=now(),_.events.push(["enter",i,_]),d.push(i),i}function exit(e){let r=d.pop();return r.end=now(),_.events.push(["exit",r,_]),r}function onsuccessfulconstruct(e,r){addResult(e,r.from)}function onsuccessfulcheck(e,r){r.restore()}function constructFactory(e,r){return hook;function hook(i,o,s){let l,h,d,g;return Array.isArray(i)?handleListOfConstructs(i):"tokenize"in i?handleListOfConstructs([i]):handleMapOfConstructs(i);function handleMapOfConstructs(e){return start;function start(r){let i=null!==r&&e[r],o=null!==r&&e.null,s=[...Array.isArray(i)?i:i?[i]:[],...Array.isArray(o)?o:o?[o]:[]];return handleListOfConstructs(s)(r)}}function handleListOfConstructs(e){return(l=e,h=0,0===e.length)?s:handleConstruct(e[h])}function handleConstruct(e){return start;function start(i){return(g=store(),d=e,e.partial||(_.currentConstruct=e),e.name&&_.parser.constructs.disable.null.includes(e.name))?nok(i):e.tokenize.call(r?Object.assign(Object.create(_),r):_,f,ok,nok)(i)}}function ok(r){return e(d,g),o}function nok(e){return(g.restore(),++h<l.length)?handleConstruct(l[h]):s}}}function addResult(e,r){e.resolveAll&&!l.includes(e)&&l.push(e),e.resolve&&splice(_.events,r,_.events.length-r,e.resolve(_.events.slice(r),_)),e.resolveTo&&(_.events=e.resolveTo(_.events,_))}function store(){let e=now(),r=_.previous,i=_.currentConstruct,s=_.events.length,l=Array.from(d);return{from:s,restore};function restore(){o=e,_.previous=r,_.currentConstruct=i,_.events.length=s,d=l,accountForPotentialSkip()}}function accountForPotentialSkip(){o.line in s&&o.column<2&&(o.column=s[o.line],o.offset+=s[o.line]-1)}}function sliceChunks(e,r){let i;let o=r.start._index,s=r.start._bufferIndex,l=r.end._index,h=r.end._bufferIndex;if(o===l)i=[e[o].slice(s,h)];else{if(i=e.slice(o,l),s>-1){let e=i[0];"string"==typeof e?i[0]=e.slice(s):i.shift()}h>0&&i.push(e[l].slice(0,h))}return i}function serializeChunks(e,r){let i,o=-1,s=[];for(;++o<e.length;){let l;let h=e[o];if("string"==typeof h)l=h;else switch(h){case -5:l="\r";break;case -4:l="\n";break;case -3:l="\r\n";break;case -2:l=r?" ":"	";break;case -1:if(!r&&i)continue;l=" ";break;default:l=String.fromCharCode(h)}i=-2===h,s.push(l)}return s.join("")}function parse_parse(e){let r=combineExtensions([s,...(e||{}).extensions||[]]),i={constructs:r,content:create(eN),defined:[],document:create(eL),flow:create(ez),lazy:{},string:create(eq),text:create(eW)};return i;function create(e){return creator;function creator(r){return createTokenizer(i,e,r)}}}let tg=/[\0\t\n\r]/g;function preprocess(){let e,r=1,i="",o=!0;return preprocessor;function preprocessor(s,l,h){let d,f,_,g,A;let b=[];for(s=i+("string"==typeof s?s.toString():new TextDecoder(l||void 0).decode(s)),_=0,i="",o&&(65279===s.charCodeAt(0)&&_++,o=void 0);_<s.length;){if(tg.lastIndex=_,g=(d=tg.exec(s))&&void 0!==d.index?d.index:s.length,A=s.charCodeAt(g),!d){i=s.slice(_);break}if(10===A&&_===g&&e)b.push(-3),e=void 0;else switch(e&&(b.push(-5),e=void 0),_<g&&(b.push(s.slice(_,g)),r+=g-_),A){case 0:b.push(65533),r++;break;case 9:for(f=4*Math.ceil(r/4),b.push(-2);r++<f;)b.push(-1);break;case 10:b.push(-4),r=1;break;default:e=!0,r=1}_=g+1}return h&&(e&&b.push(-5),i&&b.push(i),b.push(null)),b}}function decodeNumericCharacterReference(e,r){let i=Number.parseInt(e,r);return i<9||11===i||i>13&&i<32||i>126&&i<160||i>55295&&i<57344||i>64975&&i<65008||(65535&i)==65535||(65535&i)==65534||i>1114111?"�":String.fromCodePoint(i)}let ty=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function decodeString(e){return e.replace(ty,decode)}function decode(e,r,i){if(r)return r;let o=i.charCodeAt(0);if(35===o){let e=i.charCodeAt(1),r=120===e||88===e;return decodeNumericCharacterReference(i.slice(r?2:1),r?16:10)}return decodeNamedCharacterReference(i)||e}let tE={}.hasOwnProperty;function fromMarkdown(e,r,i){return"string"!=typeof r&&(i=r,r=void 0),compiler(i)(postprocess(parse_parse(i).document().write(preprocess()(e,r,!0))))}function compiler(e){let r={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:opener(link),autolinkProtocol:onenterdata,autolinkEmail:onenterdata,atxHeading:opener(heading),blockQuote:opener(blockQuote),characterEscape:onenterdata,characterReference:onenterdata,codeFenced:opener(codeFlow),codeFencedFenceInfo:buffer,codeFencedFenceMeta:buffer,codeIndented:opener(codeFlow,buffer),codeText:opener(codeText,buffer),codeTextData:onenterdata,data:onenterdata,codeFlowValue:onenterdata,definition:opener(definition),definitionDestinationString:buffer,definitionLabelString:buffer,definitionTitleString:buffer,emphasis:opener(emphasis),hardBreakEscape:opener(hardBreak),hardBreakTrailing:opener(hardBreak),htmlFlow:opener(html,buffer),htmlFlowData:onenterdata,htmlText:opener(html,buffer),htmlTextData:onenterdata,image:opener(image),label:buffer,link:opener(link),listItem:opener(listItem),listItemValue:onenterlistitemvalue,listOrdered:opener(list,onenterlistordered),listUnordered:opener(list),paragraph:opener(paragraph),reference:onenterreference,referenceString:buffer,resourceDestinationString:buffer,resourceTitleString:buffer,setextHeading:opener(heading),strong:opener(strong),thematicBreak:opener(thematicBreak)},exit:{atxHeading:closer(),atxHeadingSequence:onexitatxheadingsequence,autolink:closer(),autolinkEmail:onexitautolinkemail,autolinkProtocol:onexitautolinkprotocol,blockQuote:closer(),characterEscapeValue:onexitdata,characterReferenceMarkerHexadecimal:onexitcharacterreferencemarker,characterReferenceMarkerNumeric:onexitcharacterreferencemarker,characterReferenceValue:onexitcharacterreferencevalue,characterReference:onexitcharacterreference,codeFenced:closer(onexitcodefenced),codeFencedFence:onexitcodefencedfence,codeFencedFenceInfo:onexitcodefencedfenceinfo,codeFencedFenceMeta:onexitcodefencedfencemeta,codeFlowValue:onexitdata,codeIndented:closer(onexitcodeindented),codeText:closer(onexitcodetext),codeTextData:onexitdata,data:onexitdata,definition:closer(),definitionDestinationString:onexitdefinitiondestinationstring,definitionLabelString:onexitdefinitionlabelstring,definitionTitleString:onexitdefinitiontitlestring,emphasis:closer(),hardBreakEscape:closer(onexithardbreak),hardBreakTrailing:closer(onexithardbreak),htmlFlow:closer(onexithtmlflow),htmlFlowData:onexitdata,htmlText:closer(onexithtmltext),htmlTextData:onexitdata,image:closer(onexitimage),label:onexitlabel,labelText:onexitlabeltext,lineEnding:onexitlineending,link:closer(onexitlink),listItem:closer(),listOrdered:closer(),listUnordered:closer(),paragraph:closer(),referenceString:onexitreferencestring,resourceDestinationString:onexitresourcedestinationstring,resourceTitleString:onexitresourcetitlestring,resource:onexitresource,setextHeading:closer(onexitsetextheading),setextHeadingLineSequence:onexitsetextheadinglinesequence,setextHeadingText:onexitsetextheadingtext,strong:closer(),thematicBreak:closer()}};configure(r,(e||{}).mdastExtensions||[]);let i={};return compile;function compile(e){let o={type:"root",children:[]},s={stack:[o],tokenStack:[],config:r,enter,exit,buffer,resume,data:i},l=[],h=-1;for(;++h<e.length;)if("listOrdered"===e[h][1].type||"listUnordered"===e[h][1].type){if("enter"===e[h][0])l.push(h);else{let r=l.pop();h=prepareList(e,r,h)}}for(h=-1;++h<e.length;){let i=r[e[h][0]];tE.call(i,e[h][1].type)&&i[e[h][1].type].call(Object.assign({sliceSerialize:e[h][2].sliceSerialize},s),e[h][1])}if(s.tokenStack.length>0){let e=s.tokenStack[s.tokenStack.length-1],r=e[1]||defaultOnError;r.call(s,void 0,e[0])}for(o.position={start:mdast_util_from_markdown_lib_point(e.length>0?e[0][1].start:{line:1,column:1,offset:0}),end:mdast_util_from_markdown_lib_point(e.length>0?e[e.length-2][1].end:{line:1,column:1,offset:0})},h=-1;++h<r.transforms.length;)o=r.transforms[h](o)||o;return o}function prepareList(e,r,i){let o,s,l,h,d=r-1,f=-1,_=!1;for(;++d<=i;){let r=e[d];switch(r[1].type){case"listUnordered":case"listOrdered":case"blockQuote":"enter"===r[0]?f++:f--,h=void 0;break;case"lineEndingBlank":"enter"===r[0]&&(!o||h||f||l||(l=d),h=void 0);break;case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:h=void 0}if(!f&&"enter"===r[0]&&"listItemPrefix"===r[1].type||-1===f&&"exit"===r[0]&&("listUnordered"===r[1].type||"listOrdered"===r[1].type)){if(o){let h=d;for(s=void 0;h--;){let r=e[h];if("lineEnding"===r[1].type||"lineEndingBlank"===r[1].type){if("exit"===r[0])continue;s&&(e[s][1].type="lineEndingBlank",_=!0),r[1].type="lineEnding",s=h}else if("linePrefix"===r[1].type||"blockQuotePrefix"===r[1].type||"blockQuotePrefixWhitespace"===r[1].type||"blockQuoteMarker"===r[1].type||"listItemIndent"===r[1].type);else break}l&&(!s||l<s)&&(o._spread=!0),o.end=Object.assign({},s?e[s][1].start:r[1].end),e.splice(s||d,0,["exit",o,r[2]]),d++,i++}if("listItemPrefix"===r[1].type){let s={type:"listItem",_spread:!1,start:Object.assign({},r[1].start),end:void 0};o=s,e.splice(d,0,["enter",s,r[2]]),d++,i++,l=void 0,h=!0}}}return e[r][1]._spread=_,i}function opener(e,r){return open;function open(i){enter.call(this,e(i),i),r&&r.call(this,i)}}function buffer(){this.stack.push({type:"fragment",children:[]})}function enter(e,r,i){let o=this.stack[this.stack.length-1],s=o.children;s.push(e),this.stack.push(e),this.tokenStack.push([r,i||void 0]),e.position={start:mdast_util_from_markdown_lib_point(r.start),end:void 0}}function closer(e){return close;function close(r){e&&e.call(this,r),exit.call(this,r)}}function exit(e,r){let i=this.stack.pop(),o=this.tokenStack.pop();if(o){if(o[0].type!==e.type){if(r)r.call(this,e,o[0]);else{let r=o[1]||defaultOnError;r.call(this,e,o[0])}}}else throw Error("Cannot close `"+e.type+"` ("+stringifyPosition({start:e.start,end:e.end})+"): it’s not open");i.position.end=mdast_util_from_markdown_lib_point(e.end)}function resume(){return lib_toString(this.stack.pop())}function onenterlistordered(){this.data.expectingFirstListItemValue=!0}function onenterlistitemvalue(e){if(this.data.expectingFirstListItemValue){let r=this.stack[this.stack.length-2];r.start=Number.parseInt(this.sliceSerialize(e),10),this.data.expectingFirstListItemValue=void 0}}function onexitcodefencedfenceinfo(){let e=this.resume(),r=this.stack[this.stack.length-1];r.lang=e}function onexitcodefencedfencemeta(){let e=this.resume(),r=this.stack[this.stack.length-1];r.meta=e}function onexitcodefencedfence(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function onexitcodefenced(){let e=this.resume(),r=this.stack[this.stack.length-1];r.value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function onexitcodeindented(){let e=this.resume(),r=this.stack[this.stack.length-1];r.value=e.replace(/(\r?\n|\r)$/g,"")}function onexitdefinitionlabelstring(e){let r=this.resume(),i=this.stack[this.stack.length-1];i.label=r,i.identifier=normalizeIdentifier(this.sliceSerialize(e)).toLowerCase()}function onexitdefinitiontitlestring(){let e=this.resume(),r=this.stack[this.stack.length-1];r.title=e}function onexitdefinitiondestinationstring(){let e=this.resume(),r=this.stack[this.stack.length-1];r.url=e}function onexitatxheadingsequence(e){let r=this.stack[this.stack.length-1];if(!r.depth){let i=this.sliceSerialize(e).length;r.depth=i}}function onexitsetextheadingtext(){this.data.setextHeadingSlurpLineEnding=!0}function onexitsetextheadinglinesequence(e){let r=this.stack[this.stack.length-1];r.depth=61===this.sliceSerialize(e).codePointAt(0)?1:2}function onexitsetextheading(){this.data.setextHeadingSlurpLineEnding=void 0}function onenterdata(e){let r=this.stack[this.stack.length-1],i=r.children,o=i[i.length-1];o&&"text"===o.type||((o=text()).position={start:mdast_util_from_markdown_lib_point(e.start),end:void 0},i.push(o)),this.stack.push(o)}function onexitdata(e){let r=this.stack.pop();r.value+=this.sliceSerialize(e),r.position.end=mdast_util_from_markdown_lib_point(e.end)}function onexitlineending(e){let i=this.stack[this.stack.length-1];if(this.data.atHardBreak){let r=i.children[i.children.length-1];r.position.end=mdast_util_from_markdown_lib_point(e.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&r.canContainEols.includes(i.type)&&(onenterdata.call(this,e),onexitdata.call(this,e))}function onexithardbreak(){this.data.atHardBreak=!0}function onexithtmlflow(){let e=this.resume(),r=this.stack[this.stack.length-1];r.value=e}function onexithtmltext(){let e=this.resume(),r=this.stack[this.stack.length-1];r.value=e}function onexitcodetext(){let e=this.resume(),r=this.stack[this.stack.length-1];r.value=e}function onexitlink(){let e=this.stack[this.stack.length-1];if(this.data.inReference){let r=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=r,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}function onexitimage(){let e=this.stack[this.stack.length-1];if(this.data.inReference){let r=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=r,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}function onexitlabeltext(e){let r=this.sliceSerialize(e),i=this.stack[this.stack.length-2];i.label=decodeString(r),i.identifier=normalizeIdentifier(r).toLowerCase()}function onexitlabel(){let e=this.stack[this.stack.length-1],r=this.resume(),i=this.stack[this.stack.length-1];if(this.data.inReference=!0,"link"===i.type){let r=e.children;i.children=r}else i.alt=r}function onexitresourcedestinationstring(){let e=this.resume(),r=this.stack[this.stack.length-1];r.url=e}function onexitresourcetitlestring(){let e=this.resume(),r=this.stack[this.stack.length-1];r.title=e}function onexitresource(){this.data.inReference=void 0}function onenterreference(){this.data.referenceType="collapsed"}function onexitreferencestring(e){let r=this.resume(),i=this.stack[this.stack.length-1];i.label=r,i.identifier=normalizeIdentifier(this.sliceSerialize(e)).toLowerCase(),this.data.referenceType="full"}function onexitcharacterreferencemarker(e){this.data.characterReferenceType=e.type}function onexitcharacterreferencevalue(e){let r;let i=this.sliceSerialize(e),o=this.data.characterReferenceType;if(o)r=decodeNumericCharacterReference(i,"characterReferenceMarkerNumeric"===o?10:16),this.data.characterReferenceType=void 0;else{let e=decodeNamedCharacterReference(i);r=e}let s=this.stack[this.stack.length-1];s.value+=r}function onexitcharacterreference(e){let r=this.stack.pop();r.position.end=mdast_util_from_markdown_lib_point(e.end)}function onexitautolinkprotocol(e){onexitdata.call(this,e);let r=this.stack[this.stack.length-1];r.url=this.sliceSerialize(e)}function onexitautolinkemail(e){onexitdata.call(this,e);let r=this.stack[this.stack.length-1];r.url="mailto:"+this.sliceSerialize(e)}function blockQuote(){return{type:"blockquote",children:[]}}function codeFlow(){return{type:"code",lang:null,meta:null,value:""}}function codeText(){return{type:"inlineCode",value:""}}function definition(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function emphasis(){return{type:"emphasis",children:[]}}function heading(){return{type:"heading",depth:0,children:[]}}function hardBreak(){return{type:"break"}}function html(){return{type:"html",value:""}}function image(){return{type:"image",title:null,url:"",alt:null}}function link(){return{type:"link",title:null,url:"",children:[]}}function list(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}function listItem(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}}function paragraph(){return{type:"paragraph",children:[]}}function strong(){return{type:"strong",children:[]}}function text(){return{type:"text",value:""}}function thematicBreak(){return{type:"thematicBreak"}}}function mdast_util_from_markdown_lib_point(e){return{line:e.line,column:e.column,offset:e.offset}}function configure(e,r){let i=-1;for(;++i<r.length;){let o=r[i];Array.isArray(o)?configure(e,o):extension(e,o)}}function extension(e,r){let i;for(i in r)if(tE.call(r,i))switch(i){case"canContainEols":{let o=r[i];o&&e[i].push(...o);break}case"transforms":{let o=r[i];o&&e[i].push(...o);break}case"enter":case"exit":{let o=r[i];o&&Object.assign(e[i],o)}}}function defaultOnError(e,r){if(e)throw Error("Cannot close `"+e.type+"` ("+stringifyPosition({start:e.start,end:e.end})+"): a different token (`"+r.type+"`, "+stringifyPosition({start:r.start,end:r.end})+") is open");throw Error("Cannot close document, a token (`"+r.type+"`, "+stringifyPosition({start:r.start,end:r.end})+") is still open")}function remarkParse(e){let r=this;function parser(i){return fromMarkdown(i,{...r.data("settings"),...e,extensions:r.data("micromarkExtensions")||[],mdastExtensions:r.data("fromMarkdownExtensions")||[]})}r.parser=parser}let tI="object"==typeof self?self:globalThis,deserializer=(e,r)=>{let as=(r,i)=>(e.set(i,r),r),unpair=i=>{if(e.has(i))return e.get(i);let[o,s]=r[i];switch(o){case 0:case -1:return as(s,i);case 1:{let e=as([],i);for(let r of s)e.push(unpair(r));return e}case 2:{let e=as({},i);for(let[r,i]of s)e[unpair(r)]=unpair(i);return e}case 3:return as(new Date(s),i);case 4:{let{source:e,flags:r}=s;return as(new RegExp(e,r),i)}case 5:{let e=as(new Map,i);for(let[r,i]of s)e.set(unpair(r),unpair(i));return e}case 6:{let e=as(new Set,i);for(let r of s)e.add(unpair(r));return e}case 7:{let{name:e,message:r}=s;return as(new tI[e](r),i)}case 8:return as(BigInt(s),i);case"BigInt":return as(Object(BigInt(s)),i);case"ArrayBuffer":return as(new Uint8Array(s).buffer,s);case"DataView":{let{buffer:e}=new Uint8Array(s);return as(new DataView(e),s)}}return as(new tI[o](s),i)};return unpair},deserialize=e=>deserializer(new Map,e)(0),{toString:tT}={},{keys:tv}=Object,typeOf=e=>{let r=typeof e;if("object"!==r||!e)return[0,r];let i=tT.call(e).slice(8,-1);switch(i){case"Array":return[1,""];case"Object":return[2,""];case"Date":return[3,""];case"RegExp":return[4,""];case"Map":return[5,""];case"Set":return[6,""];case"DataView":return[1,i]}return i.includes("Array")?[1,i]:i.includes("Error")?[7,i]:[2,i]},shouldSkip=([e,r])=>0===e&&("function"===r||"symbol"===r),serializer=(e,r,i,o)=>{let as=(e,r)=>{let s=o.push(e)-1;return i.set(r,s),s},pair=o=>{if(i.has(o))return i.get(o);let[s,l]=typeOf(o);switch(s){case 0:{let r=o;switch(l){case"bigint":s=8,r=o.toString();break;case"function":case"symbol":if(e)throw TypeError("unable to serialize "+l);r=null;break;case"undefined":return as([-1],o)}return as([s,r],o)}case 1:{if(l){let e=o;return"DataView"===l?e=new Uint8Array(o.buffer):"ArrayBuffer"===l&&(e=new Uint8Array(o)),as([l,[...e]],o)}let e=[],r=as([s,e],o);for(let r of o)e.push(pair(r));return r}case 2:{if(l)switch(l){case"BigInt":return as([l,o.toString()],o);case"Boolean":case"Number":case"String":return as([l,o.valueOf()],o)}if(r&&"toJSON"in o)return pair(o.toJSON());let i=[],h=as([s,i],o);for(let r of tv(o))(e||!shouldSkip(typeOf(o[r])))&&i.push([pair(r),pair(o[r])]);return h}case 3:return as([s,o.toISOString()],o);case 4:{let{source:e,flags:r}=o;return as([s,{source:e,flags:r}],o)}case 5:{let r=[],i=as([s,r],o);for(let[i,s]of o)(e||!(shouldSkip(typeOf(i))||shouldSkip(typeOf(s))))&&r.push([pair(i),pair(s)]);return i}case 6:{let r=[],i=as([s,r],o);for(let i of o)(e||!shouldSkip(typeOf(i)))&&r.push(pair(i));return i}}let{message:h}=o;return as([s,{name:l,message:h}],o)};return pair},serialize=(e,{json:r,lossy:i}={})=>{let o=[];return serializer(!(r||i),!!r,new Map,o)(e),o};var tA="function"==typeof structuredClone?(e,r)=>r&&("json"in r||"lossy"in r)?deserialize(serialize(e,r)):structuredClone(e):(e,r)=>deserialize(serialize(e,r));function normalizeUri(e){let r=[],i=-1,o=0,s=0;for(;++i<e.length;){let l=e.charCodeAt(i),h="";if(37===l&&eS(e.charCodeAt(i+1))&&eS(e.charCodeAt(i+2)))s=2;else if(l<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(l))||(h=String.fromCharCode(l));else if(l>55295&&l<57344){let r=e.charCodeAt(i+1);l<56320&&r>56319&&r<57344?(h=String.fromCharCode(l,r),s=1):h="�"}else h=String.fromCharCode(l);h&&(r.push(e.slice(o,i),encodeURIComponent(h)),o=i+s+1,h=""),s&&(i+=s,s=0)}return r.join("")+e.slice(o)}function defaultFootnoteBackContent(e,r){let i=[{type:"text",value:"↩"}];return r>1&&i.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(r)}]}),i}function defaultFootnoteBackLabel(e,r){return"Back to reference "+(e+1)+(r>1?"-"+r:"")}function footer(e){let r="string"==typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",i=e.options.footnoteBackContent||defaultFootnoteBackContent,o=e.options.footnoteBackLabel||defaultFootnoteBackLabel,s=e.options.footnoteLabel||"Footnotes",l=e.options.footnoteLabelTagName||"h2",h=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[],f=-1;for(;++f<e.footnoteOrder.length;){let s=e.footnoteById.get(e.footnoteOrder[f]);if(!s)continue;let l=e.all(s),h=String(s.identifier).toUpperCase(),_=normalizeUri(h.toLowerCase()),g=0,A=[],b=e.footnoteCounts.get(h);for(;void 0!==b&&++g<=b;){A.length>0&&A.push({type:"text",value:" "});let e="string"==typeof i?i:i(f,g);"string"==typeof e&&(e={type:"text",value:e}),A.push({type:"element",tagName:"a",properties:{href:"#"+r+"fnref-"+_+(g>1?"-"+g:""),dataFootnoteBackref:"",ariaLabel:"string"==typeof o?o:o(f,g),className:["data-footnote-backref"]},children:Array.isArray(e)?e:[e]})}let k=l[l.length-1];if(k&&"element"===k.type&&"p"===k.tagName){let e=k.children[k.children.length-1];e&&"text"===e.type?e.value+=" ":k.children.push({type:"text",value:" "}),k.children.push(...A)}else l.push(...A);let M={type:"element",tagName:"li",properties:{id:r+"fn-"+_},children:e.wrap(l,!0)};e.patch(s,M),d.push(M)}if(0!==d.length)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:l,properties:{...tA(h),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:"\n"}]}}let convert=function(e){if(null==e)return lib_ok;if("function"==typeof e)return castFactory(e);if("object"==typeof e)return Array.isArray(e)?anyFactory(e):propertiesFactory(e);if("string"==typeof e)return typeFactory(e);throw Error("Expected function, string, or object as test")};function anyFactory(e){let r=[],i=-1;for(;++i<e.length;)r[i]=convert(e[i]);return castFactory(any);function any(...e){let i=-1;for(;++i<r.length;)if(r[i].apply(this,e))return!0;return!1}}function propertiesFactory(e){return castFactory(all);function all(r){let i;for(i in e)if(r[i]!==e[i])return!1;return!0}}function typeFactory(e){return castFactory(type);function type(r){return r&&r.type===e}}function castFactory(e){return check;function check(r,i,o){return!!(looksLikeANode(r)&&e.call(this,r,"number"==typeof i?i:void 0,o||void 0))}}function lib_ok(){return!0}function looksLikeANode(e){return null!==e&&"object"==typeof e&&"type"in e}function color(e){return e}let tP=[];function visitParents(e,r,i,o){let s;"function"==typeof r&&"function"!=typeof i?(o=i,i=r):s=r;let l=convert(s),h=o?-1:1;function factory(e,s,d){let f=e&&"object"==typeof e?e:{};if("string"==typeof f.type){let r="string"==typeof f.tagName?f.tagName:"string"==typeof f.name?f.name:void 0;Object.defineProperty(visit,"name",{value:"node ("+color(e.type+(r?"<"+r+">":""))+")"})}return visit;function visit(){let f,_,g,A=tP;if((!r||l(e,s,d[d.length-1]||void 0))&&!1===(A=toResult(i(e,d)))[0])return A;if("children"in e&&e.children&&e.children&&"skip"!==A[0])for(_=(o?e.children.length:-1)+h,g=d.concat(e);_>-1&&_<e.children.length;){let r=e.children[_];if(!1===(f=factory(r,_,g)())[0])return f;_="number"==typeof f[1]?f[1]:_+h}return A}}factory(e,void 0,[])()}function toResult(e){return Array.isArray(e)?e:"number"==typeof e?[!0,e]:null==e?tP:[e]}function visit(e,r,i,o){let s,l,h;function overload(e,r){let i=r[r.length-1],o=i?i.children.indexOf(e):void 0;return h(e,o,i)}"function"==typeof r&&"function"!=typeof i?(l=void 0,h=r,s=i):(l=r,h=i,s=o),visitParents(e,l,overload,s)}function blockquote(e,r){let i={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(r),!0)};return e.patch(r,i),e.applyData(r,i)}function hardBreak(e,r){let i={type:"element",tagName:"br",properties:{},children:[]};return e.patch(r,i),[e.applyData(r,i),{type:"text",value:"\n"}]}function code(e,r){let i=r.value?r.value+"\n":"",o={},s=r.lang?r.lang.split(/\s+/):[];s.length>0&&(o.className=["language-"+s[0]]);let l={type:"element",tagName:"code",properties:o,children:[{type:"text",value:i}]};return r.meta&&(l.data={meta:r.meta}),e.patch(r,l),l={type:"element",tagName:"pre",properties:{},children:[l=e.applyData(r,l)]},e.patch(r,l),l}function strikethrough(e,r){let i={type:"element",tagName:"del",properties:{},children:e.all(r)};return e.patch(r,i),e.applyData(r,i)}function emphasis(e,r){let i={type:"element",tagName:"em",properties:{},children:e.all(r)};return e.patch(r,i),e.applyData(r,i)}function footnoteReference(e,r){let i;let o="string"==typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",s=String(r.identifier).toUpperCase(),l=normalizeUri(s.toLowerCase()),h=e.footnoteOrder.indexOf(s),d=e.footnoteCounts.get(s);void 0===d?(d=0,e.footnoteOrder.push(s),i=e.footnoteOrder.length):i=h+1,d+=1,e.footnoteCounts.set(s,d);let f={type:"element",tagName:"a",properties:{href:"#"+o+"fn-"+l,id:o+"fnref-"+l+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(i)}]};e.patch(r,f);let _={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(r,_),e.applyData(r,_)}function heading(e,r){let i={type:"element",tagName:"h"+r.depth,properties:{},children:e.all(r)};return e.patch(r,i),e.applyData(r,i)}function html_html(e,r){if(e.options.allowDangerousHtml){let i={type:"raw",value:r.value};return e.patch(r,i),e.applyData(r,i)}}function revert(e,r){let i=r.referenceType,o="]";if("collapsed"===i?o+="[]":"full"===i&&(o+="["+(r.label||r.identifier)+"]"),"imageReference"===r.type)return[{type:"text",value:"!["+r.alt+o}];let s=e.all(r),l=s[0];l&&"text"===l.type?l.value="["+l.value:s.unshift({type:"text",value:"["});let h=s[s.length-1];return h&&"text"===h.type?h.value+=o:s.push({type:"text",value:o}),s}function imageReference(e,r){let i=String(r.identifier).toUpperCase(),o=e.definitionById.get(i);if(!o)return revert(e,r);let s={src:normalizeUri(o.url||""),alt:r.alt};null!==o.title&&void 0!==o.title&&(s.title=o.title);let l={type:"element",tagName:"img",properties:s,children:[]};return e.patch(r,l),e.applyData(r,l)}function image_image(e,r){let i={src:normalizeUri(r.url)};null!==r.alt&&void 0!==r.alt&&(i.alt=r.alt),null!==r.title&&void 0!==r.title&&(i.title=r.title);let o={type:"element",tagName:"img",properties:i,children:[]};return e.patch(r,o),e.applyData(r,o)}function inlineCode(e,r){let i={type:"text",value:r.value.replace(/\r?\n|\r/g," ")};e.patch(r,i);let o={type:"element",tagName:"code",properties:{},children:[i]};return e.patch(r,o),e.applyData(r,o)}function linkReference(e,r){let i=String(r.identifier).toUpperCase(),o=e.definitionById.get(i);if(!o)return revert(e,r);let s={href:normalizeUri(o.url||"")};null!==o.title&&void 0!==o.title&&(s.title=o.title);let l={type:"element",tagName:"a",properties:s,children:e.all(r)};return e.patch(r,l),e.applyData(r,l)}function link_link(e,r){let i={href:normalizeUri(r.url)};null!==r.title&&void 0!==r.title&&(i.title=r.title);let o={type:"element",tagName:"a",properties:i,children:e.all(r)};return e.patch(r,o),e.applyData(r,o)}function listItem(e,r,i){let o=e.all(r),s=i?listLoose(i):listItemLoose(r),l={},h=[];if("boolean"==typeof r.checked){let e;let i=o[0];i&&"element"===i.type&&"p"===i.tagName?e=i:(e={type:"element",tagName:"p",properties:{},children:[]},o.unshift(e)),e.children.length>0&&e.children.unshift({type:"text",value:" "}),e.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:r.checked,disabled:!0},children:[]}),l.className=["task-list-item"]}let d=-1;for(;++d<o.length;){let e=o[d];(s||0!==d||"element"!==e.type||"p"!==e.tagName)&&h.push({type:"text",value:"\n"}),"element"!==e.type||"p"!==e.tagName||s?h.push(e):h.push(...e.children)}let f=o[o.length-1];f&&(s||"element"!==f.type||"p"!==f.tagName)&&h.push({type:"text",value:"\n"});let _={type:"element",tagName:"li",properties:l,children:h};return e.patch(r,_),e.applyData(r,_)}function listLoose(e){let r=!1;if("list"===e.type){r=e.spread||!1;let i=e.children,o=-1;for(;!r&&++o<i.length;)r=listItemLoose(i[o])}return r}function listItemLoose(e){let r=e.spread;return null==r?e.children.length>1:r}function list_list(e,r){let i={},o=e.all(r),s=-1;for("number"==typeof r.start&&1!==r.start&&(i.start=r.start);++s<o.length;){let e=o[s];if("element"===e.type&&"li"===e.tagName&&e.properties&&Array.isArray(e.properties.className)&&e.properties.className.includes("task-list-item")){i.className=["contains-task-list"];break}}let l={type:"element",tagName:r.ordered?"ol":"ul",properties:i,children:e.wrap(o,!0)};return e.patch(r,l),e.applyData(r,l)}function paragraph(e,r){let i={type:"element",tagName:"p",properties:{},children:e.all(r)};return e.patch(r,i),e.applyData(r,i)}function root_root(e,r){let i={type:"root",children:e.wrap(e.all(r))};return e.patch(r,i),e.applyData(r,i)}function strong(e,r){let i={type:"element",tagName:"strong",properties:{},children:e.all(r)};return e.patch(r,i),e.applyData(r,i)}function table(e,r){let i=e.all(r),o=i.shift(),s=[];if(o){let i={type:"element",tagName:"thead",properties:{},children:e.wrap([o],!0)};e.patch(r.children[0],i),s.push(i)}if(i.length>0){let o={type:"element",tagName:"tbody",properties:{},children:e.wrap(i,!0)},l=em(r.children[1]),h=ep(r.children[r.children.length-1]);l&&h&&(o.position={start:l,end:h}),s.push(o)}let l={type:"element",tagName:"table",properties:{},children:e.wrap(s,!0)};return e.patch(r,l),e.applyData(r,l)}function tableRow(e,r,i){let o=i?i.children:void 0,s=o?o.indexOf(r):1,l=0===s?"th":"td",h=i&&"table"===i.type?i.align:void 0,d=h?h.length:r.children.length,f=-1,_=[];for(;++f<d;){let i=r.children[f],o={},s=h?h[f]:void 0;s&&(o.align=s);let d={type:"element",tagName:l,properties:o,children:[]};i&&(d.children=e.all(i),e.patch(i,d),d=e.applyData(i,d)),_.push(d)}let g={type:"element",tagName:"tr",properties:{},children:e.wrap(_,!0)};return e.patch(r,g),e.applyData(r,g)}function tableCell(e,r){let i={type:"element",tagName:"td",properties:{},children:e.all(r)};return e.patch(r,i),e.applyData(r,i)}function trimLines(e){let r=String(e),i=/\r?\n|\r/g,o=i.exec(r),s=0,l=[];for(;o;)l.push(trimLine(r.slice(s,o.index),s>0,!0),o[0]),s=o.index+o[0].length,o=i.exec(r);return l.push(trimLine(r.slice(s),s>0,!1)),l.join("")}function trimLine(e,r,i){let o=0,s=e.length;if(r){let r=e.codePointAt(o);for(;9===r||32===r;)o++,r=e.codePointAt(o)}if(i){let r=e.codePointAt(s-1);for(;9===r||32===r;)s--,r=e.codePointAt(s-1)}return s>o?e.slice(o,s):""}function handlers_text_text(e,r){let i={type:"text",value:trimLines(String(r.value))};return e.patch(r,i),e.applyData(r,i)}function thematic_break_thematicBreak(e,r){let i={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(r,i),e.applyData(r,i)}let tR={blockquote:blockquote,break:hardBreak,code:code,delete:strikethrough,emphasis:emphasis,footnoteReference:footnoteReference,heading:heading,html:html_html,imageReference:imageReference,image:image_image,inlineCode:inlineCode,linkReference:linkReference,link:link_link,listItem:listItem,list:list_list,paragraph:paragraph,root:root_root,strong:strong,table:table,tableCell:tableCell,tableRow:tableRow,text:handlers_text_text,thematicBreak:thematic_break_thematicBreak,toml:ignore,yaml:ignore,definition:ignore,footnoteDefinition:ignore};function ignore(){}let tw={}.hasOwnProperty,tS={};function createState(e,r){let i=r||tS,o=new Map,s=new Map,l=new Map,h={...tR,...i.handlers},d={all,applyData,definitionById:o,footnoteById:s,footnoteCounts:l,footnoteOrder:[],handlers:h,one,options:i,patch,wrap};return visit(e,function(e){if("definition"===e.type||"footnoteDefinition"===e.type){let r="definition"===e.type?o:s,i=String(e.identifier).toUpperCase();r.has(i)||r.set(i,e)}}),d;function one(e,r){let i=e.type,o=d.handlers[i];if(tw.call(d.handlers,i)&&o)return o(d,e,r);if(d.options.passThrough&&d.options.passThrough.includes(i)){if("children"in e){let{children:r,...i}=e,o=tA(i);return o.children=d.all(e),o}return tA(e)}let s=d.options.unknownHandler||defaultUnknownHandler;return s(d,e,r)}function all(e){let r=[];if("children"in e){let i=e.children,o=-1;for(;++o<i.length;){let s=d.one(i[o],e);if(s){if(o&&"break"===i[o-1].type&&(Array.isArray(s)||"text"!==s.type||(s.value=trimMarkdownSpaceStart(s.value)),!Array.isArray(s)&&"element"===s.type)){let e=s.children[0];e&&"text"===e.type&&(e.value=trimMarkdownSpaceStart(e.value))}Array.isArray(s)?r.push(...s):r.push(s)}}}return r}}function patch(e,r){e.position&&(r.position=position(e))}function applyData(e,r){let i=r;if(e&&e.data){let r=e.data.hName,o=e.data.hChildren,s=e.data.hProperties;if("string"==typeof r){if("element"===i.type)i.tagName=r;else{let e="children"in i?i.children:[i];i={type:"element",tagName:r,properties:{},children:e}}}"element"===i.type&&s&&Object.assign(i.properties,tA(s)),"children"in i&&i.children&&null!=o&&(i.children=o)}return i}function defaultUnknownHandler(e,r){let i=r.data||{},o="value"in r&&!(tw.call(i,"hProperties")||tw.call(i,"hChildren"))?{type:"text",value:r.value}:{type:"element",tagName:"div",properties:{},children:e.all(r)};return e.patch(r,o),e.applyData(r,o)}function wrap(e,r){let i=[],o=-1;for(r&&i.push({type:"text",value:"\n"});++o<e.length;)o&&i.push({type:"text",value:"\n"}),i.push(e[o]);return r&&e.length>0&&i.push({type:"text",value:"\n"}),i}function trimMarkdownSpaceStart(e){let r=0,i=e.charCodeAt(r);for(;9===i||32===i;)r++,i=e.charCodeAt(r);return e.slice(r)}function toHast(e,r){let i=createState(e,r),o=i.one(e,void 0),s=footer(i),l=Array.isArray(o)?{type:"root",children:o}:o||{type:"root",children:[]};return s&&l.children.push({type:"text",value:"\n"},s),l}function remarkRehype(e,r){return e&&"run"in e?async function(i,o){let s=toHast(i,{file:o,...r});await e.run(s,o)}:function(i,o){return toHast(i,{file:o,...e||r})}}function bail(e){if(e)throw e}var tk=i(4470);function isPlainObject(e){if("object"!=typeof e||null===e)return!1;let r=Object.getPrototypeOf(e);return(null===r||r===Object.prototype||null===Object.getPrototypeOf(r))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function trough(){let e=[],r={run,use};return r;function run(...r){let i=-1,o=r.pop();if("function"!=typeof o)throw TypeError("Expected function as last argument, not "+o);function next(s,...l){let h=e[++i],d=-1;if(s){o(s);return}for(;++d<r.length;)(null===l[d]||void 0===l[d])&&(l[d]=r[d]);r=l,h?lib_wrap(h,next)(...l):o(null,...l)}next(null,...r)}function use(i){if("function"!=typeof i)throw TypeError("Expected `middelware` to be a function, not "+i);return e.push(i),r}}function lib_wrap(e,r){let i;return wrapped;function wrapped(...r){let o;let s=e.length>r.length;s&&r.push(done);try{o=e.apply(this,r)}catch(e){if(s&&i)throw e;return done(e)}s||(o&&o.then&&"function"==typeof o.then?o.then(then,done):o instanceof Error?done(o):then(o))}function done(e,...o){i||(i=!0,r(e,...o))}function then(e){done(null,e)}}let tV={basename,dirname,extname,join,sep:"/"};function basename(e,r){let i;if(void 0!==r&&"string"!=typeof r)throw TypeError('"ext" argument must be a string');assertPath(e);let o=0,s=-1,l=e.length;if(void 0===r||0===r.length||r.length>e.length){for(;l--;)if(47===e.codePointAt(l)){if(i){o=l+1;break}}else s<0&&(i=!0,s=l+1);return s<0?"":e.slice(o,s)}if(r===e)return"";let h=-1,d=r.length-1;for(;l--;)if(47===e.codePointAt(l)){if(i){o=l+1;break}}else h<0&&(i=!0,h=l+1),d>-1&&(e.codePointAt(l)===r.codePointAt(d--)?d<0&&(s=l):(d=-1,s=h));return o===s?s=h:s<0&&(s=e.length),e.slice(o,s)}function dirname(e){let r;if(assertPath(e),0===e.length)return".";let i=-1,o=e.length;for(;--o;)if(47===e.codePointAt(o)){if(r){i=o;break}}else r||(r=!0);return i<0?47===e.codePointAt(0)?"/":".":1===i&&47===e.codePointAt(0)?"//":e.slice(0,i)}function extname(e){let r;assertPath(e);let i=e.length,o=-1,s=0,l=-1,h=0;for(;i--;){let d=e.codePointAt(i);if(47===d){if(r){s=i+1;break}continue}o<0&&(r=!0,o=i+1),46===d?l<0?l=i:1!==h&&(h=1):l>-1&&(h=-1)}return l<0||o<0||0===h||1===h&&l===o-1&&l===s+1?"":e.slice(l,o)}function join(...e){let r,i=-1;for(;++i<e.length;)assertPath(e[i]),e[i]&&(r=void 0===r?e[i]:r+"/"+e[i]);return void 0===r?".":minpath_browser_normalize(r)}function minpath_browser_normalize(e){assertPath(e);let r=47===e.codePointAt(0),i=normalizeString(e,!r);return 0!==i.length||r||(i="."),i.length>0&&47===e.codePointAt(e.length-1)&&(i+="/"),r?"/"+i:i}function normalizeString(e,r){let i,o,s="",l=0,h=-1,d=0,f=-1;for(;++f<=e.length;){if(f<e.length)i=e.codePointAt(f);else if(47===i)break;else i=47;if(47===i){if(h===f-1||1===d);else if(h!==f-1&&2===d){if(s.length<2||2!==l||46!==s.codePointAt(s.length-1)||46!==s.codePointAt(s.length-2)){if(s.length>2){if((o=s.lastIndexOf("/"))!==s.length-1){o<0?(s="",l=0):l=(s=s.slice(0,o)).length-1-s.lastIndexOf("/"),h=f,d=0;continue}}else if(s.length>0){s="",l=0,h=f,d=0;continue}}r&&(s=s.length>0?s+"/..":"..",l=2)}else s.length>0?s+="/"+e.slice(h+1,f):s=e.slice(h+1,f),l=f-h-1;h=f,d=0}else 46===i&&d>-1?d++:d=-1}return s}function assertPath(e){if("string"!=typeof e)throw TypeError("Path must be a string. Received "+JSON.stringify(e))}let tC={cwd};function cwd(){return"/"}function isUrl(e){return!!(null!==e&&"object"==typeof e&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&void 0===e.auth)}function urlToPath(e){if("string"==typeof e)e=new URL(e);else if(!isUrl(e)){let r=TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw r.code="ERR_INVALID_ARG_TYPE",r}if("file:"!==e.protocol){let e=TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return getPathFromURLPosix(e)}function getPathFromURLPosix(e){if(""!==e.hostname){let e=TypeError('File URL host must be "localhost" or empty on darwin');throw e.code="ERR_INVALID_FILE_URL_HOST",e}let r=e.pathname,i=-1;for(;++i<r.length;)if(37===r.codePointAt(i)&&50===r.codePointAt(i+1)){let e=r.codePointAt(i+2);if(70===e||102===e){let e=TypeError("File URL path must not include encoded / characters");throw e.code="ERR_INVALID_FILE_URL_PATH",e}}return decodeURIComponent(r)}let tx=["history","path","basename","stem","extname","dirname"];let VFile=class VFile{constructor(e){let r,i;r=e?isUrl(e)?{path:e}:"string"==typeof e||isUint8Array(e)?{value:e}:e:{},this.cwd="cwd"in r?"":tC.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let o=-1;for(;++o<tx.length;){let e=tx[o];e in r&&void 0!==r[e]&&null!==r[e]&&(this[e]="history"===e?[...r[e]]:r[e])}for(i in r)tx.includes(i)||(this[i]=r[i])}get basename(){return"string"==typeof this.path?tV.basename(this.path):void 0}set basename(e){assertNonEmpty(e,"basename"),assertPart(e,"basename"),this.path=tV.join(this.dirname||"",e)}get dirname(){return"string"==typeof this.path?tV.dirname(this.path):void 0}set dirname(e){lib_assertPath(this.basename,"dirname"),this.path=tV.join(e||"",this.basename)}get extname(){return"string"==typeof this.path?tV.extname(this.path):void 0}set extname(e){if(assertPart(e,"extname"),lib_assertPath(this.dirname,"extname"),e){if(46!==e.codePointAt(0))throw Error("`extname` must start with `.`");if(e.includes(".",1))throw Error("`extname` cannot contain multiple dots")}this.path=tV.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){isUrl(e)&&(e=urlToPath(e)),assertNonEmpty(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return"string"==typeof this.path?tV.basename(this.path,this.extname):void 0}set stem(e){assertNonEmpty(e,"stem"),assertPart(e,"stem"),this.path=tV.join(this.dirname||"",e+(this.extname||""))}fail(e,r,i){let o=this.message(e,r,i);throw o.fatal=!0,o}info(e,r,i){let o=this.message(e,r,i);return o.fatal=void 0,o}message(e,r,i){let o=new VFileMessage(e,r,i);return this.path&&(o.name=this.path+":"+o.name,o.file=this.path),o.fatal=!1,this.messages.push(o),o}toString(e){if(void 0===this.value)return"";if("string"==typeof this.value)return this.value;let r=new TextDecoder(e||void 0);return r.decode(this.value)}};function assertPart(e,r){if(e&&e.includes(tV.sep))throw Error("`"+r+"` cannot be a path: did not expect `"+tV.sep+"`")}function assertNonEmpty(e,r){if(!e)throw Error("`"+r+"` cannot be empty")}function lib_assertPath(e,r){if(!e)throw Error("Setting `"+r+"` requires `path` to be set too")}function isUint8Array(e){return!!(e&&"object"==typeof e&&"byteLength"in e&&"byteOffset"in e)}let CallableInstance=function(e){let r=this.constructor,i=r.prototype,o=i[e],apply=function(){return o.apply(apply,arguments)};return Object.setPrototypeOf(apply,i),apply},tD={}.hasOwnProperty;let Processor=class Processor extends CallableInstance{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=trough()}copy(){let e=new Processor,r=-1;for(;++r<this.attachers.length;){let i=this.attachers[r];e.use(...i)}return e.data(tk(!0,{},this.namespace)),e}data(e,r){return"string"==typeof e?2==arguments.length?(assertUnfrozen("data",this.frozen),this.namespace[e]=r,this):tD.call(this.namespace,e)&&this.namespace[e]||void 0:e?(assertUnfrozen("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;for(;++this.freezeIndex<this.attachers.length;){let[e,...r]=this.attachers[this.freezeIndex];if(!1===r[0])continue;!0===r[0]&&(r[0]=void 0);let i=e.call(this,...r);"function"==typeof i&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();let r=vfile(e),i=this.parser||this.Parser;return assertParser("parse",i),i(String(r),r)}process(e,r){let i=this;return this.freeze(),assertParser("process",this.parser||this.Parser),assertCompiler("process",this.compiler||this.Compiler),r?executor(void 0,r):new Promise(executor);function executor(o,s){let l=vfile(e),h=i.parse(l);function realDone(e,i){e||!i?s(e):o?o(i):r(void 0,i)}i.run(h,l,function(e,r,o){if(e||!r||!o)return realDone(e);let s=i.stringify(r,o);looksLikeAValue(s)?o.value=s:o.result=s,realDone(e,o)})}}processSync(e){let r,i=!1;return this.freeze(),assertParser("processSync",this.parser||this.Parser),assertCompiler("processSync",this.compiler||this.Compiler),this.process(e,realDone),assertDone("processSync","process",i),r;function realDone(e,o){i=!0,bail(e),r=o}}run(e,r,i){assertNode(e),this.freeze();let o=this.transformers;return i||"function"!=typeof r||(i=r,r=void 0),i?executor(void 0,i):new Promise(executor);function executor(s,l){let h=vfile(r);function realDone(r,o,h){let d=o||e;r?l(r):s?s(d):i(void 0,d,h)}o.run(e,h,realDone)}}runSync(e,r){let i,o=!1;return this.run(e,r,realDone),assertDone("runSync","run",o),i;function realDone(e,r){bail(e),i=r,o=!0}}stringify(e,r){this.freeze();let i=vfile(r),o=this.compiler||this.Compiler;return assertCompiler("stringify",o),assertNode(e),o(e,i)}use(e,...r){let i=this.attachers,o=this.namespace;if(assertUnfrozen("use",this.frozen),null==e);else if("function"==typeof e)addPlugin(e,r);else if("object"==typeof e)Array.isArray(e)?addList(e):addPreset(e);else throw TypeError("Expected usable value, not `"+e+"`");return this;function add(e){if("function"==typeof e)addPlugin(e,[]);else if("object"==typeof e){if(Array.isArray(e)){let[r,...i]=e;addPlugin(r,i)}else addPreset(e)}else throw TypeError("Expected usable value, not `"+e+"`")}function addPreset(e){if(!("plugins"in e)&&!("settings"in e))throw Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");addList(e.plugins),e.settings&&(o.settings=tk(!0,o.settings,e.settings))}function addList(e){let r=-1;if(null==e);else if(Array.isArray(e))for(;++r<e.length;){let i=e[r];add(i)}else throw TypeError("Expected a list of plugins, not `"+e+"`")}function addPlugin(e,r){let o=-1,s=-1;for(;++o<i.length;)if(i[o][0]===e){s=o;break}if(-1===s)i.push([e,...r]);else if(r.length>0){let[o,...l]=r,h=i[s][1];isPlainObject(h)&&isPlainObject(o)&&(o=tk(!0,h,o)),i[s]=[e,o,...l]}}}};let tO=new Processor().freeze();function assertParser(e,r){if("function"!=typeof r)throw TypeError("Cannot `"+e+"` without `parser`")}function assertCompiler(e,r){if("function"!=typeof r)throw TypeError("Cannot `"+e+"` without `compiler`")}function assertUnfrozen(e,r){if(r)throw Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function assertNode(e){if(!isPlainObject(e)||"string"!=typeof e.type)throw TypeError("Expected node, got `"+e+"`")}function assertDone(e,r,i){if(!i)throw Error("`"+e+"` finished async. Use `"+r+"` instead")}function vfile(e){return looksLikeAVFile(e)?e:new VFile(e)}function looksLikeAVFile(e){return!!(e&&"object"==typeof e&&"message"in e&&"messages"in e)}function looksLikeAValue(e){return"string"==typeof e||lib_isUint8Array(e)}function lib_isUint8Array(e){return!!(e&&"object"==typeof e&&"byteLength"in e&&"byteOffset"in e)}let tN=[],tL={allowDangerousHtml:!0},tM=/^(https?|ircs?|mailto|xmpp)$/i,tF=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Markdown(e){let r=createProcessor(e),i=createFile(e);return post(r.runSync(r.parse(i),i),e)}function createProcessor(e){let r=e.rehypePlugins||tN,i=e.remarkPlugins||tN,o=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...tL}:tL,s=tO().use(remarkParse).use(i).use(remarkRehype,o).use(r);return s}function createFile(e){let r=e.children||"",i=new VFile;return"string"==typeof r&&(i.value=r),i}function post(e,r){let i=r.allowedElements,o=r.allowElement,s=r.components,l=r.disallowedElements,h=r.skipHtml,d=r.unwrapDisallowed,f=r.urlTransform||defaultUrlTransform;for(let e of tF)Object.hasOwn(r,e.from)&&(e.from,e.to&&e.to,e.id);return visit(e,transform),toJsxRuntime(e,{Fragment:eA.Fragment,components:s,ignoreInvalidStyle:!0,jsx:eA.jsx,jsxs:eA.jsxs,passKeys:!0,passNode:!0});function transform(e,r,s){if("raw"===e.type&&s&&"number"==typeof r)return h?s.children.splice(r,1):s.children[r]={type:"text",value:e.value},r;if("element"===e.type){let r;for(r in ev)if(Object.hasOwn(ev,r)&&Object.hasOwn(e.properties,r)){let i=e.properties[r],o=ev[r];(null===o||o.includes(e.tagName))&&(e.properties[r]=f(String(i||""),r,e))}}if("element"===e.type){let h=i?!i.includes(e.tagName):!!l&&l.includes(e.tagName);if(!h&&o&&"number"==typeof r&&(h=!o(e,r,s)),h&&s&&"number"==typeof r)return d&&e.children?s.children.splice(r,1,...e.children):s.children.splice(r,1),r}}}function defaultUrlTransform(e){let r=e.indexOf(":"),i=e.indexOf("?"),o=e.indexOf("#"),s=e.indexOf("/");return -1===r||-1!==s&&r>s||-1!==i&&r>i||-1!==o&&r>o||tM.test(e.slice(0,r))?e:""}}},function(e){var __webpack_exec__=function(r){return e(e.s=r)};e.O(0,[774,179],function(){return __webpack_exec__(6840),__webpack_exec__(9974)}),_N_E=e.O()}]);